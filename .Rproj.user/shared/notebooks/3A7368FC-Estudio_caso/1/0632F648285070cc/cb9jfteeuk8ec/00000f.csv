"0","#Simulación Modelo Clásico de Cramér-Lundberg "
"0","#para tres meses: Antes de la pandemia"
"0","#Con los datos reales de la empresa"
"0",""
"0","library(dplyr) # librería para poder renombrar las cabeceras "
"0","# de los dataframes"
"0",""
"0","#Parámetros"
"0","set.seed(13) #semilla fija"
"0","u = 1759629 #surplus(capital inicial de salvamento)"
"0","#Es un estimado a partir de la media de las ganancias por semana, "
"0","#multiplicado por 10/3, "
"0","#siendo una proporción para evitar la ruina"
"0","# u (sum(medias))*(10/3)"
"0","c =0.29*u #prima de pago cada timepo t. c=0.5*u"
"0","t_final = 90"
"0","# S(t) = \sum_{i=1}^{N(t)}X_i"
"0","#donde N(t)~ Poisson (lambda*t)"
"0","# X_i ~ exponencial (lambda_Xi)"
"0","#CL = REPRESENTA EL MODELO DE CRAMER LUNDBERG"
"0","#Simulación de trayectoria de CL_t, cuando t < t_final."
"0","trayectoria_CLt <- function(u, c, t_final)"
"0","{"
"0","  tiempo <- c(0)"
"0","  Cramer_trayectoria <- c(u)"
"0","  while(tiempo[length(tiempo)] < t_final)"
"0","  {"
"0","    tiempo_llegada <- (1)"
"0","  Y_i <-  (rnorm(1, mean = 139929.468, sd = 24521.524 ) + "
"0","    rnorm(1, mean = 48125.734 , sd=17150.338 ) +  "
"0","   rnorm(1, mean =  44509.755, sd = 14312.338 ) + "
"0","    rnorm(1, mean =   46904.516, sd = 16238.151 ) + "
"0","    rnorm(1, mean = 52786.734  , sd = 18403.17 ) + "
"0","    rnorm(1, mean = 118645.9  , sd = 36530.24) + "
"0","    rweibull(1,  shape = 4.784508e+00, scale = 1.295070e+05 ) ) "
"0","    tiempo <- c(tiempo, tiempo[length(tiempo)] + "
"0","                tiempo_llegada,tiempo[length(tiempo)] + tiempo_llegada ) "
"0","    Cramer_trayectoria <- c(Cramer_trayectoria,"
"0","    Cramer_trayectoria[length(Cramer_trayectoria)]- c*tiempo_llegada,"
"0","    Cramer_trayectoria[length(Cramer_trayectoria)]- c*tiempo_llegada +  Y_i )"
"0","    if(Cramer_trayectoria[length(Cramer_trayectoria)] < 0){"
"0","      ruina = 1"
"0","    }"
"0","    else{"
"0","      ruina = 0"
"0","    }"
"0","  }"
"0","  df <- data.frame(tiempo, Cramer_trayectoria)"
"0","  df_trayectoria <- data.frame(df%>% rename(Tiempo = tiempo, Ct = Cramer_trayectoria))"
"0","  return(df_trayectoria)"
"0","  "
"0","}"
"0","trayectoria <- trayectoria_CLt(u,c, t_final )"
"0",""
"0","#Intalación de plotly usando github"
"0","#devtools::install_github(""ropensci/plotly"")"
"0",""
"0","fig_tr<- plot_ly(trayectoria, x = ~Tiempo, y = ~Ct, "
"0","name = ""Ganancias: G(t)"", type = ""scatter"", mode = ""lines"")"
"0","fig_tr <- fig_tr %>% add_trace(x = ~Tiempo, y = u,  "
"0","name = ""Capital inicial: u"", type = ""scatter"", mode = ""lines"")"
"0","fig_tr"
