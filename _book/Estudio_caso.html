<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.43">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Estudio del impacto de la pandemia en un establecimiento de comida rápida: Análisis y estimación de parámetros para el modelo modificado de Cramer-Lundberg – 6&nbsp; Estudio de caso: Análisis de ventas de una empresa de comida rápida</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./references.html" rel="next">
<link href="./Modelo_de_Cramer_Lundberg.html" rel="prev">
<link href="./logofcfm.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="site_libs/datatables-binding-0.33/datatables.js"></script>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>

<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Estudio del impacto de la pandemia en un establecimiento de comida rápida: Análisis y estimación de parámetros para el modelo modificado de Cramer-Lundberg - 6&nbsp; Estudio de caso: Análisis de ventas de una empresa de comida rápida">
<meta property="og:image" content="FCFMLOGO.png">
<meta property="og:site_name" content="Estudio del impacto de la pandemia en un establecimiento de comida rápida: Análisis y estimación de parámetros para el modelo modificado de Cramer-Lundberg">
<meta name="twitter:title" content="Estudio del impacto de la pandemia en un establecimiento de comida rápida: Análisis y estimación de parámetros para el modelo modificado de Cramer-Lundberg - 6&nbsp; Estudio de caso: Análisis de ventas de una empresa de comida rápida">
<meta name="twitter:image" content="FCFMLOGO.png">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Estudio_caso.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Estudio de caso: Análisis de ventas de una empresa de comida rápida</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./FCFM-UNACH.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Estudio del impacto de la pandemia en un establecimiento de comida rápida: Análisis y estimación de parámetros para el modelo modificado de Cramer-Lundberg</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/Mara-DL/Tesis.git" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Tesis_MDL.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Tesis_MDL.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Alternar modo oscuro"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Alternar modo lector">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introducción</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Preliminares</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Alternar sección">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./probabilidad.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Probabilidad</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estadistica.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Estadística</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ciencia_de_datos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Ciencia de Datos</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Modelo_de_Cramer_Lundberg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelo Clásico de Cramér-Lundberg</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Estudio_caso.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Estudio de caso: Análisis de ventas de una empresa de comida rápida</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Referencias</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Tabla de contenidos</h2>
   
  <ul>
  <li><a href="#descripción-del-problema" id="toc-descripción-del-problema" class="nav-link active" data-scroll-target="#descripción-del-problema"><span class="header-section-number">6.1</span> Descripción del problema</a></li>
  <li><a href="#elementos-de-ciencia-de-datos" id="toc-elementos-de-ciencia-de-datos" class="nav-link" data-scroll-target="#elementos-de-ciencia-de-datos"><span class="header-section-number">6.2</span> Elementos de Ciencia de Datos</a>
  <ul class="collapse">
  <li><a href="#importación-de-los-datos-originales-a-r" id="toc-importación-de-los-datos-originales-a-r" class="nav-link" data-scroll-target="#importación-de-los-datos-originales-a-r"><span class="header-section-number">6.2.1</span> Importación de los datos originales a R</a></li>
  <li><a href="#homogenización-del-total-de-ventas-por-día" id="toc-homogenización-del-total-de-ventas-por-día" class="nav-link" data-scroll-target="#homogenización-del-total-de-ventas-por-día"><span class="header-section-number">6.2.2</span> Homogenización del total de ventas por día</a></li>
  <li><a href="#dataframe-resultante-antes-de-la-pandemia" id="toc-dataframe-resultante-antes-de-la-pandemia" class="nav-link" data-scroll-target="#dataframe-resultante-antes-de-la-pandemia"><span class="header-section-number">6.2.3</span> DataFrame Resultante: Antes de la pandemia</a></li>
  <li><a href="#dataframe-resultante-después-de-la-pandemia" id="toc-dataframe-resultante-después-de-la-pandemia" class="nav-link" data-scroll-target="#dataframe-resultante-después-de-la-pandemia"><span class="header-section-number">6.2.4</span> DataFrame Resultante: Después de la pandemia</a></li>
  <li><a href="#análisis-gráfico-de-las-ventas-por-día" id="toc-análisis-gráfico-de-las-ventas-por-día" class="nav-link" data-scroll-target="#análisis-gráfico-de-las-ventas-por-día"><span class="header-section-number">6.2.5</span> Análisis gráfico de las ventas por día:</a></li>
  </ul></li>
  <li><a href="#identificación-de-distribuciones-de-probabilidad-de-las-ventas-por-día" id="toc-identificación-de-distribuciones-de-probabilidad-de-las-ventas-por-día" class="nav-link" data-scroll-target="#identificación-de-distribuciones-de-probabilidad-de-las-ventas-por-día"><span class="header-section-number">6.3</span> Identificación de distribuciones de probabilidad de las ventas por día</a>
  <ul class="collapse">
  <li><a href="#prueba-de-la-distribución-weibull" id="toc-prueba-de-la-distribución-weibull" class="nav-link" data-scroll-target="#prueba-de-la-distribución-weibull"><span class="header-section-number">6.3.1</span> Prueba de la distribución Weibull:</a></li>
  </ul></li>
  <li><a href="#modelo-modificado-de-cramér-lundberg-para-identificar-la-probabilidad-de-las-ganancias-insuficientes-en-una-empresa-de-comida-rápida" id="toc-modelo-modificado-de-cramér-lundberg-para-identificar-la-probabilidad-de-las-ganancias-insuficientes-en-una-empresa-de-comida-rápida" class="nav-link" data-scroll-target="#modelo-modificado-de-cramér-lundberg-para-identificar-la-probabilidad-de-las-ganancias-insuficientes-en-una-empresa-de-comida-rápida"><span class="header-section-number">6.4</span> Modelo Modificado de Cramér-Lundberg para identificar la probabilidad de las ganancias insuficientes en una empresa de comida rápida</a>
  <ul class="collapse">
  <li><a href="#caso-pre-pandemia" id="toc-caso-pre-pandemia" class="nav-link" data-scroll-target="#caso-pre-pandemia"><span class="header-section-number">6.4.1</span> Caso pre-pandemia</a></li>
  <li><a href="#caso-pos-pandemia" id="toc-caso-pos-pandemia" class="nav-link" data-scroll-target="#caso-pos-pandemia"><span class="header-section-number">6.4.2</span> Caso pos-pandemia</a></li>
  </ul></li>
  <li><a href="#análisis-de-resultados-y-recomendaciones." id="toc-análisis-de-resultados-y-recomendaciones." class="nav-link" data-scroll-target="#análisis-de-resultados-y-recomendaciones."><span class="header-section-number">6.5</span> Análisis de resultados y recomendaciones.</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/Mara-DL/Tesis.git/edit/main/Estudio_caso.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/Mara-DL/Tesis.git/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li><li><a href="https://github.com/Mara-DL/Tesis.git/blob/main/Estudio_caso.qmd" class="toc-action"><i class="bi empty"></i>Ver el código</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Estudio de caso: Análisis de ventas de una empresa de comida rápida</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="descripción-del-problema" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="descripción-del-problema"><span class="header-section-number">6.1</span> Descripción del problema</h2>
<div style="text-align:justify">
<p>Se presentan datos que son parte de las ventas de una empresa de comida rápida. Para brindar una mejor idea del estudio caso se presentará una extensión de lo que es una empresa de comida rápida y una franquicia .</p>
<p>Una empresa de comida rápida es un tipo de negocio dentro del sector alimenticio que se especializa en la preparación y venta de alimentos y bebidas que pueden ser servidos y consumidos rápidamente. Estas empresas suelen ofrecer menús estandarizados y utilizan métodos de producción en masa para asegurar la rapidez y la eficiencia en el servicio. Algunas características típicas de una empresa de comida rápida incluyen:</p>
<p>1-Rapidez en el Servicio: La principal característica es la rapidez con la que los clientes pueden recibir sus pedidos, generalmente en pocos minutos.</p>
<p>2-Menú Limitado y Estandarizado: Los menús suelen ser simples y consistentes en todas las ubicaciones de la cadena, permitiendo una preparación rápida y eficiente.</p>
<p>3-Precios Asequibles: Los precios suelen ser más bajos en comparación con los restaurantes tradicionales, lo que los hace accesibles a una amplia gama de clientes.</p>
<p>4-Métodos de Preparación Eficientes: Utilizan técnicas de cocción rápida, como freidoras y parrillas de alta eficiencia, así como la pre-preparación de ingredientes.</p>
<p>5-Autoservicio y Comida para Llevar: Muchas de estas empresas ofrecen opciones de autoservicio y comida para llevar, facilitando el consumo rápido y conveniente.</p>
<p>6-Ambiente Informal: El ambiente es generalmente informal y está diseñado para facilitar el flujo rápido de clientes, con áreas de autoservicio y estaciones de recolección de pedidos.</p>
<p>Ejemplos de empresas de comida rápida incluyen grandes cadenas internacionales como McDonald’s, Burger King, KFC, Subway, Carl’s Jr y Taco Bell. Estas empresas han expandido su presencia globalmente, adaptándose a diferentes mercados y culturas mientras mantienen su enfoque en la rapidez y eficiencia del servicio.</p>
<p>Muchas de estas empresas otorga parte del derecho a operar en diferentes franquicias.</p>
<p>Una franquicia es un modelo de negocio en el cual una empresa (el franquiciador) otorga a otra parte (el franquiciado) el derecho a operar un negocio utilizando su marca, productos, servicios y modelo operativo a cambio de una tarifa o regalías. Este modelo permite a los franquiciadores expandir su marca y presencia en el mercado sin tener que invertir en nuevas ubicaciones directamente. Al mismo tiempo, ofrece a los franquiciados la oportunidad de operar un negocio con una marca establecida y un sistema probado. Algunas características clave de una franquicia incluyen:</p>
<p>1-Marca y Sistema Operativo: El franquiciado utiliza la marca comercial, logotipos, productos y servicios del franquiciador, así como su sistema operativo, que puede incluir recetas, métodos de producción, estrategias de marketing, entre otros.</p>
<p>2-Pago de Tarifas: El franquiciado paga al franquiciador una tarifa inicial y, en muchos casos, regalías continuas basadas en un porcentaje de las ventas. Estas tarifas cubren el uso de la marca y el soporte continuo del franquiciador.</p>
<p>3-Capacitación y Soporte: El franquiciador proporciona capacitación inicial y soporte continuo al franquiciado, lo cual puede incluir formación en gestión empresarial, operaciones, marketing y servicio al cliente.</p>
<p>4-Estándares y Control de Calidad: Para mantener la consistencia y calidad de la marca, el franquiciador establece estándares y procedimientos que los franquiciados deben seguir. Esto puede incluir auditorias y evaluaciones periódicas.</p>
<p>5-Contrato de Franquicia: La relación entre el franquiciador y el franquiciado está regulada por un contrato de franquicia que detalla los derechos y obligaciones de ambas partes, incluyendo la duración del acuerdo y las condiciones de renovación.</p>
<p>6-Territorio Exclusivo: A menudo, el contrato otorga al franquiciado un territorio exclusivo en el cual puede operar, evitando la competencia directa con otras franquicias de la misma marca en esa área.</p>
<p>Ejemplos de negocios que utilizan el modelo de franquicia incluyen cadenas de comida rápida (como McDonald’s, Subway y KFC), Carl’s Jr, hoteles (como Marriott y Hilton), servicios de limpieza, tiendas de conveniencia y muchos otros sectores. Este modelo permite una expansión rápida y eficiente del negocio mientras ofrece a los emprendedores la oportunidad de operar con el respaldo de una marca establecida.</p>
<p>Esta empresa ofrece en sus productos dos tipos de hamburguesas, bebidas como sodas, cervezas y cafés. En la información de las ventas incluye registros obtenidos por una Terminal Punto de Venta (TPV), el sistema de pago usado en establecimientos comerciales para procesar transacciones de venta. Permite a los comerciantes aceptar el uso de tarjetas de crédito y débito. Se tiene registro de las ventas por cada día desde el año 2018 al noviembre del 2020, haciendo un cierre pandémico, se registran en dos etapas, antes de pandemia los datos a partir del 25 de julio del 2018 al 10 de abril del 2020. Los datos después de pandemia se registraron a partir del 3 de agosto del 2020 y cerrando finalmente el 10 de noviembre del 2020, los cuales se les aplicó una homogenización para un buen manejo de los datos y así poder presentar un mejor análisis.</p>
</div>
</section>
<section id="elementos-de-ciencia-de-datos" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="elementos-de-ciencia-de-datos"><span class="header-section-number">6.2</span> Elementos de Ciencia de Datos</h2>
<section id="importación-de-los-datos-originales-a-r" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="importación-de-los-datos-originales-a-r"><span class="header-section-number">6.2.1</span> Importación de los datos originales a R</h3>
<div style="text-align:justify">
<p>Se cargan los datos del archivo excel para ser leído y almacenarlo en un dataframe (<a href="ciencia_de_datos.html#sec-dataframe" class="quarto-xref"><span>Sección 4.1</span></a>) para poder manipular cada uno de los elementos de la base de datos.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Datos <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"~/TM/Datos.xlsx"</span>, <span class="at">col_types =</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">c</span>(<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>, </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>, </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>, </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>, </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>, </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>, </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>, </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>, </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>, </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                    <span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span>,<span class="st">"numeric"</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>                        ))</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>Datos</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2,416 × 75
    ...1  ...2  ...3  ...4  ...5  ...6 `240519` `82253.5` `247172.9` ...10 `973`
   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1    NA    NA    NA    NA    NA    NA      NA        NA         NA     NA   NA 
 2    NA    NA    NA    NA    NA    NA    9382.     9441.        NA     NA 9382.
 3  2018     7    30     4 43306    NA  188038.       NA     188038.    NA  682 
 4  2018     7    30     5 43307    NA  220827        NA     220827     NA  694 
 5  2018     7    30     6 43308    NA  240519        NA     240519     NA  762 
 6  2018     7    30     7 43309    NA  229542        NA     229542     NA  704 
 7  2018     7    30     1 43310    NA  239776.       NA     239776.    NA  706 
 8  2018     7    31     2 43311    NA  172946        NA     172946     NA  602 
 9  2018     7    31     3 43312    NA  210671        NA     210671     NA  709 
10  2018     8    31     4 43313    NA  195662        NA     195662     NA  649 
# ℹ 2,406 more rows
# ℹ 64 more variables: `384` &lt;dbl&gt;, `1136` &lt;dbl&gt;, ...14 &lt;dbl&gt;,
#   `371.753114754098` &lt;dbl&gt;, `2428.16666666666` &lt;dbl&gt;, ...17 &lt;dbl&gt;,
#   ...18 &lt;dbl&gt;, `2099` &lt;dbl&gt;, `222` &lt;dbl&gt;, `2162` &lt;dbl&gt;, ...22 &lt;dbl&gt;,
#   `1384...23` &lt;dbl&gt;, `559` &lt;dbl&gt;, `1384...25` &lt;dbl&gt;, ...26 &lt;dbl&gt;,
#   `2402` &lt;dbl&gt;, `658` &lt;dbl&gt;, `2525` &lt;dbl&gt;, ...30 &lt;dbl&gt;, `1556...31` &lt;dbl&gt;,
#   `462` &lt;dbl&gt;, `1556...33` &lt;dbl&gt;, ...34 &lt;dbl&gt;, `61` &lt;dbl&gt;, `57` &lt;dbl&gt;, …</code></pre>
</div>
</div>
<p>Como se puede apreciar, es necesario eliminar columnas, reducido a las columnas de las ventas de los diferentes productos que oferta la empresa para así obtener las ventas totales.</p>
</div>
</section>
<section id="homogenización-del-total-de-ventas-por-día" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="homogenización-del-total-de-ventas-por-día"><span class="header-section-number">6.2.2</span> Homogenización del total de ventas por día</h3>
<div style="text-align:justify">
<p>Mediante este proceso se eliminan y se corrigen valores atípicos, valores faltantes o alguna inconsistencia que se presentan en los datos. Esto implica la eliminación de datos incompletos, conocidos como datos faltantes o NA. También se renombran cabeceras de cada columna del dataframe para facilitar la lectura del archivo.</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Eliminamos las columnas con datos faltantes</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> Datos[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">12</span>,<span class="dv">14</span>,<span class="dv">16</span>,<span class="dv">18</span>,<span class="dv">20</span>,<span class="dv">22</span>,<span class="dv">24</span>, <span class="dv">26</span>,<span class="dv">28</span>, <span class="dv">30</span>,<span class="dv">32</span>, <span class="dv">34</span>, <span class="dv">36</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">38</span>,<span class="dv">39</span>, <span class="dv">40</span>,  <span class="dv">42</span>, <span class="dv">44</span>, <span class="dv">46</span>, <span class="dv">48</span>, <span class="dv">50</span>,<span class="dv">51</span>,<span class="dv">52</span>, <span class="dv">53</span>, <span class="dv">54</span>,<span class="dv">55</span>, <span class="dv">56</span>, </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="dv">57</span>,<span class="dv">58</span>,<span class="dv">59</span>,<span class="dv">60</span>,<span class="dv">61</span>, <span class="dv">62</span>, <span class="dv">63</span>, <span class="dv">64</span>, <span class="dv">65</span>, <span class="dv">66</span>, <span class="dv">67</span>, <span class="dv">68</span>, <span class="dv">69</span>, <span class="dv">70</span>, <span class="dv">71</span>, <span class="dv">73</span>,<span class="dv">74</span>,<span class="dv">72</span>, <span class="dv">75</span>)]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Cambiar las cabeceras del dataframe  </span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(datos<span class="sc">%&gt;%</span> <span class="fu">rename</span>(Año <span class="ot">=</span> ...<span class="dv">1</span> ))</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(datos<span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Mes =</span> ...<span class="dv">2</span>, <span class="at">Semana =</span> ...<span class="dv">3</span>, <span class="at">Dia=</span> ...<span class="dv">4</span>, </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Fecha =</span> ...<span class="dv">5</span>, <span class="at">Ventas=</span> X240519, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>                  <span class="at">TotalVentas =</span> X247172<span class="fl">.9</span>,<span class="at">Customers =</span> X973,</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Totalcustomers =</span> X1136, </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">CH_Promedio =</span> X371<span class="fl">.753114754098</span>, </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">TotalCH_Promedio =</span> ...<span class="dv">17</span>, <span class="at">Burgers =</span> X2099,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">TotalBurgers =</span> X2162, </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Thickurgers =</span> X1384...<span class="dv">23</span>, </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>                  <span class="at">TotalThickburgers =</span> X1384...<span class="dv">25</span>,</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Total_Burgers =</span> X2402, </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>                  <span class="at">T_Total_Burgers=</span> X2525,<span class="at">Bebidas =</span> X1556...<span class="dv">31</span>,</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Totalbebidas =</span> X1556...<span class="dv">33</span>, <span class="at">Cervezas =</span> X61,</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Totalcervezas =</span> X83, <span class="at">Cafes =</span> X83,</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Totalcafes =</span> X54, <span class="at">Ventas_TPV =</span> X158904,</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Total_Ventas_TPV =</span> X173412<span class="fl">.5</span>,</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>                  <span class="at">HR_Laborales =</span> ...<span class="dv">47</span>,</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Total_HR_Laborales =</span> ...<span class="dv">49</span> ))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Por último, se realizó la separación de la base de datos antes de la pandemia y después de la pandemia, presentando así los dataframes resultantes en el siguiente código y como se ilustra posteriormente:</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Analisis de los datos:</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtros por días:</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#___________________________Antes de la pandemia___________________________</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>fil_before1<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(datos, Año <span class="sc">&lt;=</span> <span class="dv">2019</span>))</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>fil_before2<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(datos, Año <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Mes <span class="sc">&lt;=</span> <span class="dv">4</span>))</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>fil_before <span class="ot">&lt;-</span> <span class="fu">rbind</span>(fil_before1, fil_before2)</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#________________________Después de la pandemia____________________________</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>fil_dat_after <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(datos, Año <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Mes<span class="sc">&gt;=</span><span class="dv">8</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</section>
<section id="dataframe-resultante-antes-de-la-pandemia" class="level3" data-number="6.2.3">
<h3 data-number="6.2.3" class="anchored" data-anchor-id="dataframe-resultante-antes-de-la-pandemia"><span class="header-section-number">6.2.3</span> DataFrame Resultante: Antes de la pandemia</h3>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-7bc9166dbd0f2b7962d5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7bc9166dbd0f2b7962d5">{"x":{"filter":"none","vertical":false,"data":[["3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428","429","430","431","432","433","434","435","436","437","438","439","440","441","442","443","444","445","446","447","448","449","450","451","452","453","454","455","456","457","458","459","460","461","462","463","464","465","466","467","468","469","470","471","472","473","474","475","476","477","478","479","480","481","482","483","484","485","486","487","488","489","490","491","492","493","494","495","496","497","498","499","500","501","502","503","504","505","506","507","508","509","510","511","512","513","514","515","516","517","518","519","520","521","522","523","524","525","526","527","528","529","530","531","532","533","534","535","536","537","538","539","540","541","542","543","544","545","546","547","548","549","550","551","552","553","554","555","556","557","558","559","560","561","562","563","564","565","566","567","568","569","570","571","572","573","574","575","576","577","578","579","580","581","582","583","584","585","586","587","588","589","590","591","592","593","594","595","596","597","598","599","600","601","602","603","604","605","606","607","608","609","610","611","612","613","614","615","616","617","618","619","620","621","622","623","624","625","626","627","628"],[2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2019,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020],[7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4],[30,30,30,30,30,31,31,31,31,31,31,31,32,32,32,32,32,32,32,33,33,33,33,33,33,33,34,34,34,34,34,34,34,35,35,35,35,35,35,35,36,36,36,36,36,36,36,37,37,37,37,37,37,37,38,38,38,38,38,38,38,39,39,39,39,39,39,39,40,40,40,40,40,40,40,41,41,41,41,41,41,41,42,42,42,42,42,42,42,43,43,43,43,43,43,43,44,44,44,44,44,44,44,45,45,45,45,45,45,45,46,46,46,46,46,46,46,47,47,47,47,47,47,47,48,48,48,48,48,48,48,49,49,49,49,49,49,49,50,50,50,50,50,50,50,51,51,51,51,51,51,51,52,52,52,52,52,52,52,1,1,1,1,1,1,1,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,4,5,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,7,8,8,8,8,8,8,8,9,9,9,9,9,9,9,10,10,10,10,10,10,10,11,11,11,11,11,11,11,12,12,12,12,12,12,12,13,13,13,13,13,13,13,14,14,14,14,14,14,14,15,15,15,15,15,15,15,16,16,16,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,19,19,19,19,19,19,19,20,20,20,20,20,20,20,21,21,21,21,21,21,21,22,22,22,22,22,22,22,23,23,23,23,23,23,23,24,24,24,24,24,24,24,25,25,25,25,25,25,25,26,26,26,26,26,26,26,27,27,27,27,27,27,27,28,28,28,28,28,28,28,29,29,29,29,29,29,29,30,30,30,30,30,30,30,31,31,31,31,31,31,31,32,32,32,32,32,32,32,33,33,33,33,33,33,33,34,34,34,34,34,34,34,35,35,35,35,35,35,35,36,36,36,36,36,36,36,37,37,37,37,37,37,37,38,38,38,38,38,38,38,39,39,39,39,39,39,39,40,40,40,40,40,40,40,41,41,41,41,41,41,41,42,42,42,42,42,42,42,43,43,43,43,43,43,43,44,44,44,44,44,44,44,45,45,45,45,45,45,45,46,46,46,46,46,46,46,47,47,47,47,47,47,47,48,48,48,48,48,48,48,49,49,49,49,49,49,49,50,50,50,50,50,50,50,51,51,51,51,51,51,51,52,52,52,52,52,52,52,1,1,1,1,1,1,1,2,2,2,2,2,2,2,3,3,3,3,3,3,3,4,4,4,4,4,4,4,5,5,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,7,8,8,8,8,8,8,8,9,9,9,9,9,9,9,10,10,10,10,10,10,10,11,11,11,11,11,11,11,12,12,12,12,12,12,12,13,13,13,13,13,13,13,14,14,14,14,14,14,14,15,15,15,15,15],[4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6],[43306,43307,43308,43309,43310,43311,43312,43313,43314,43315,43316,43317,43318,43319,43320,43321,43322,43323,43324,43325,43326,43327,43328,43329,43330,43331,43332,43333,43334,43335,43336,43337,43338,43339,43340,43341,43342,43343,43344,43345,43346,43347,43348,43349,43350,43351,43352,43353,43354,43355,43356,43357,43358,43359,43360,43361,43362,43363,43364,43365,43366,43367,43368,43369,43370,43371,43372,43373,43374,43375,43376,43377,43378,43379,43380,43381,43382,43383,43384,43385,43386,43387,43388,43389,43390,43391,43392,43393,43394,43395,43396,43397,43398,43399,43400,43401,43402,43403,43404,43405,43406,43407,43408,43409,43410,43411,43412,43413,43414,43415,43416,43417,43418,43419,43420,43421,43422,43423,43424,43425,43426,43427,43428,43429,43430,43431,43432,43433,43434,43435,43436,43437,43438,43439,43440,43441,43442,43443,43444,43445,43446,43447,43448,43449,43450,43451,43452,43453,43454,43455,43456,43457,43458,43459,43460,43461,43462,43463,43464,43465,43466,43467,43468,43469,43470,43471,43472,43473,43474,43475,43476,43477,43478,43479,43480,43481,43482,43483,43484,43485,43486,43487,43488,43489,43490,43491,43492,43493,43494,43495,43496,43497,43498,43499,43500,43501,43502,43503,43504,43505,43506,43507,43508,43509,43510,43511,43512,43513,43514,43515,43516,43517,43518,43519,43520,43521,43522,43523,43524,43525,43526,43527,43528,43529,43530,43531,43532,43533,43534,43535,43536,43537,43538,43539,43540,43541,43542,43543,43544,43545,43546,43547,43548,43549,43550,43551,43552,43553,43554,43555,43556,43557,43558,43559,43560,43561,43562,43563,43564,43565,43566,43567,43568,43569,43570,43571,43572,43573,43574,43575,43576,43577,43578,43579,43580,43581,43582,43583,43584,43585,43586,43587,43588,43589,43590,43591,43592,43593,43594,43595,43596,43597,43598,43599,43600,43601,43602,43603,43604,43605,43606,43607,43608,43609,43610,43611,43612,43613,43614,43615,43616,43617,43618,43619,43620,43621,43622,43623,43624,43625,43626,43627,43628,43629,43630,43631,43632,43633,43634,43635,43636,43637,43638,43639,43640,43641,43642,43643,43644,43645,43646,43647,43648,43649,43650,43651,43652,43653,43654,43655,43656,43657,43658,43659,43660,43661,43662,43663,43664,43665,43666,43667,43668,43669,43670,43671,43672,43673,43674,43675,43676,43677,43678,43679,43680,43681,43682,43683,43684,43685,43686,43687,43688,43689,43690,43691,43692,43693,43694,43695,43696,43697,43698,43699,43700,43701,43702,43703,43704,43705,43706,43707,43708,43709,43710,43711,43712,43713,43714,43715,43716,43717,43718,43719,43720,43721,43722,43723,43724,43725,43726,43727,43728,43729,43730,43731,43732,43733,43734,43735,43736,43737,43738,43739,43740,43741,43742,43743,43744,43745,43746,43747,43748,43749,43750,43751,43752,43753,43754,43755,43756,43757,43758,43759,43760,43761,43762,43763,43764,43765,43766,43767,43768,43769,43770,43771,43772,43773,43774,43775,43776,43777,43778,43779,43780,43781,43782,43783,43784,43785,43786,43787,43788,43789,43790,43791,43792,43793,43794,43795,43796,43797,43798,43799,43800,43801,43802,43803,43804,43805,43806,43807,43808,43809,43810,43811,43812,43813,43814,43815,43816,43817,43818,43819,43820,43821,43822,43823,43824,43825,43826,43827,43828,43829,43830,43831,43832,43833,43834,43835,43836,43837,43838,43839,43840,43841,43842,43843,43844,43845,43846,43847,43848,43849,43850,43851,43852,43853,43854,43855,43856,43857,43858,43859,43860,43861,43862,43863,43864,43865,43866,43867,43868,43869,43870,43871,43872,43873,43874,43875,43876,43877,43878,43879,43880,43881,43882,43883,43884,43885,43886,43887,43888,43889,43890,43891,43892,43893,43894,43895,43896,43897,43898,43899,43900,43901,43902,43903,43904,43905,43906,43907,43908,43909,43910,43911,43912,43913,43914,43915,43916,43917,43918,43919,43920,43921,43922,43923,43924,43925,43926,43927,43928,43929,43930,43931],[188037.5,220827,240519,229542,239775.6,172946,210671,195662,193051,206803,219399,224106.5,152557,148675.5,142344,152189.5,171891,194642.5,210023.5,129751.5,125867.5,133380,135070.5,158927,175382,187502,78116,71871,82471.5,98739.5,131185.5,157909.5,186582,68030,71887,74843.5,77880.5,128575,182618,180678.5,68986,66672.5,67484,70495.5,104876,148493.5,176622.5,53070,51200.5,64516,81610.5,128973.5,110157,173544,60897,49682,62988,63809.5,90914,146641,166807.5,53360.5,51226,54245,63729.5,119543.5,156898,167262.5,59210.5,54915.5,43862.5,61547,102853,151446,176270,52488,52787,59824,53762,108648,163899,155241,58398.5,60411.5,54656,62828.5,93418,148863.5,162756.5,52754.5,49708.5,47951,60041,94496,123020.5,146158,46895.5,48514.5,66312,74036.5,143238,146623,148116,40663,43886,40777,36947,83095,132589,163728.5,50000,46455,52257.5,63789.5,135567,170760.5,184964.5,157693.5,41443.5,37508,42708.5,84153.5,119149.5,162555.5,48169,50815.5,47122.5,54615.5,96865.5,146393.5,158346.5,54569,52232,61419,59961,93407.5,178110,152569.5,62100.5,67357.5,99654.5,68722,96990.5,158461,169846,90382,100400.5,117733,134577,140285.5,166324.1,183004.5,72029.5,116951.5,123364.5,114424.5,126574,142232.5,160648,57422.5,97377.5,103063,85146,95491,112363,125781,50277.5,43394,54722.5,49011.5,71245.5,122408,121161.5,45882.5,50094.5,55367.5,45247,85562.5,108540,140700,41421.5,41220,41260.5,51897,76126.5,102003,125911,38891.5,46811,43024,48762,70145.5,98070,128288.5,108457,38856.5,43969,35632,60523,102680.5,113462.5,31938,28783.5,30878,93718.5,76009,113771.5,122248.5,33099,34744,31850.5,42205,61182,84909.60000000001,123953.5,32647.6,36693.5,40681.8,47988.3,85013.89999999999,104665,138972.5,29517,31409.8,33445,37889.9,63389.5,95743.8,125291.6,32098.8,36144.9,27448.2,41570.2,54188.9,111798.3,133300.1,88069.60000000001,30171.1,30028.6,44178.6,65326.9,103919.2,112134.3,35059.1,31540.8,37879,35421.7,66465.3,107929.7,119650.3,34734.9,35210.2,40804,38167.9,72095.7,107583.4,120672.5,35525.9,36569.5,38193.7,43124.9,76725.39999999999,109769.9,112773.9,71510,83190.7,80338.2,82291.5,82288.8,89490.8,124030.2,65272,59436,62587,72835.60000000001,92283.7,105947,144755.4,44336.2,124725,120109.7,42653,61259.9,100750.5,141233.1,34313.2,38248,44664.4,53980.6,70472.39999999999,95621,106459.4,42488.8,43041,73208.39999999999,69158.7,76438.60000000001,109718.4,138812.4,37621.8,44397.9,38978.1,42826.2,75851,94809,138767.8,43764.3,219702.4,45424.1,49782.8,92777.39999999999,129534.2,149580.9,40865.7,43917.2,32101,41350.2,86281.89999999999,121839,150234.3,54742,34676,59734.5,53859.1,98422.7,135175.9,136017.3,50357.7,49843.8,54739.5,54669.2,79115.5,112822.3,142955.5,45061.4,48529.7,48680,65561,88580.89999999999,124285.1,160233.6,52800.5,48347,63784.4,60659.5,83608,122408.1,133375.6,74001,56623.7,56825.5,70342.5,74996.7,125705.5,139726.8,86144.8,75305.60000000001,72501.5,74497.60000000001,83469.2,103878.7,139232.9,73659.60000000001,62824.9,62440.8,99066.89999999999,103450.2,110602.5,121838.7,77883.5,75060.39999999999,83394.2,74445,88386.60000000001,93775.8,125860.1,55206.1,50219.2,62894.5,57406.9,81352.10000000001,100306.21,133451,51490,64642.3,60408.5,63977.3,90349.7,115034.1,135498.3,53703.1,56014.1,64331.6,64716.9,69159.8,96125.89999999999,124466.4,31481,29046.1,30377.2,43554.7,67773.8,97784.39999999999,137573.5,34780.4,33469.7,34701.4,36442.5,58353.6,99172.60000000001,122963.1,32523.8,35937.7,33526.6,43618,76195.89999999999,113059.1,93791.3,108229.1,19511.8,38385.4,34420,49073.8,94255.60000000001,128758.5,27108.4,45274.8,41309,43037.4,59405.1,89917.7,150201.4,34657.5,35215.6,24786.7,38303,68845,113235.1,133014.2,36081.1,25993.9,33058.7,29511.9,58331.9,103401.6,100913.6,33773.7,35983.5,35293,43823,64207.2,98092.89999999999,125368.3,39866.5,31816.9,30487.8,33440.9,61250.1,104472.7,113488.3,24169.6,30997,40272.5,45739.5,61845.9,101679.2,112874.4,28846.4,36779.7,34571.6,38535,62966.3,96357,126737.9,40888.4,38199.3,44456.4,44895.4,134674.5,182942.7,180481.5,157157.9,39840.3,41695.3,45357.4,65484.8,92088.89999999999,112854.2,36105.5,32416.7,39943.5,49176.1,79811.5,112985.9,125293.4,46501.3,45191.5,30819,42552.5,84548.10000000001,110060.1,157887.1,55111.7,59804.5,61495.55,94370.05,76511,149063.8,171760.4,72208.89999999999,80245.25,83281.39999999999,106056.9,118447.7,151523.2,186942.2,157096.1,57511.6,97132,111373.2,100888.2,114169.8,148542.6,113564.7,51311.5,81934,91922.8,85206.7,91722.60000000001,128326.2,59858.4,55717.6,42647.1,43258.5,65188.6,106090.1,124114.2,29445.5,35763.7,43603.3,49053.9,51376.9,107340.5,116095,48675.5,39722.2,40150.3,48714.55,56964.1,98833,125006,36441,39574.9,38979.8,51356.9,76006.7,108465.9,99824.39999999999,80578.2,33915.9,29176.3,31223.6,59553.3,78264.60000000001,106775,35918.95,33387.2,34846.1,42306.6,118358,116458.1,136038.8,34451.8,36017.4,40308.5,39269.1,74538.3,107478.6,124785.1,38096.8,31464.2,33259.6,42300,77477.3,132427.1,123623.1,38122.3,28307.7,40315.5,29549,72588.10000000001,103935.8,119983.7,46895.3,28600.9,33268.7,45909.3,74351.3,111136.4,95999.5,73364.60000000001,35020,35140.5,33109.05,34818.8,34645.7,45407.2,18278.3,22846.8,19397.7,13547,24600.8,31719.7,32004.1,16471.6,20427.6,15214.7,16709.6,10331.4,24218.7,30977,7429.7,12950.4,10832.1,14240.4,16457.6],[188037.5,220827,240519,229542,239775.6,172946,210671,195662,193051,206803,219399,224106.5,152557,148675.5,142344,152189.5,171891,194642.5,210023.5,129751.5,125867.5,133380,135070.5,158927,175382,187502,78116,71871,82471.5,98739.5,131185.5,157909.5,186582,68030,71887,74843.5,77880.5,128575,182618,180678.5,68986,66672.5,67484,70495.5,104876,148493.5,176622.5,53070,51200.5,64516,81610.5,128973.5,110157,173544,60897,49682,62988,63809.5,90914,146641,166807.5,53360.5,51226,54245,63729.5,119543.5,156898,167262.5,59210.5,54915.5,43862.5,61547,102853,151446,176270,52488,52787,59824,53762,108648,163899,155241,58398.5,60411.5,54656,62828.5,93418,148863.5,162756.5,52754.5,49708.5,47951,60041,94496,123020.5,146158,46895.5,48514.5,66312,74036.5,143238,146623,148116,40663,43886,40777,36947,83095,132589,163728.5,50000,46455,52257.5,63789.5,135567,170760.5,184964.5,157693.5,41443.5,37508,42708.5,84153.5,119149.5,162555.5,48169,50815.5,47122.5,54615.5,96865.5,146393.5,158346.5,54569,52232,61419,59961,93407.5,178110,152569.5,62100.5,67357.5,99654.5,68722,108825.5,198717.5,203892,133170.5,131368.5,157982.5,174956.5,182925.5,214416.1,221224,93531,148131.5,163155,160690,168537,186854,207821.5,92618.5,149774.5,175569,135084,137464,155449.5,172990.5,95524.5,79288,96780.5,93004,116551.5,156691,156450,79097,78893,94907.5,91545.5,126530,136571,183788,81231,65382.5,73676,98178.5,123685.5,124983.5,162502.5,76797.5,78491.5,89428.5,87655.5,107576.5,137145.5,160050,142699,66562,74580.5,76215,90607.5,129288.5,138573,61222.5,49178,59214,126668,111614,133007,154243.5,74740,56621,69559.5,82806.5,108931.5,109936.1,161513.5,67552.60000000001,56213.5,81333.3,84722.3,118820.9,131372.5,172434,56975,64796.3,69135.5,69112.39999999999,94833,123792.3,160202.1,62963.8,55450.9,69999.7,83916.7,94910.89999999999,146415.8,183601.1,124087.1,52781.6,67758.60000000001,78423.60000000001,100189.9,131395.7,147241.3,73134.10000000001,52418.8,72417,66341.2,107000.8,140862.7,153971.3,68317.89999999999,63163.2,79539.5,78590.89999999999,105877.2,130967.4,155517.5,67765.39999999999,62939.5,72531.7,77583.89999999999,124130.9,155260.9,155852.4,110992,119923.7,116266.7,131520.5,128507.8,138573.3,175588.2,108676,107076.5,103193,122602.6,140253.2,154599,192582.4,78747.7,162452.5,160621.2,92012,92679.39999999999,150143,192603.6,74470.2,77970,81125.39999999999,89708.60000000001,104697.4,132223,152275.4,81095.3,73760.5,109709.9,113463.2,132711.6,151509.4,188203.9,84058.3,81582.39999999999,73531.60000000001,94805.7,112821,127346,165435.8,80417.8,247172.9,80066.10000000001,92334.8,133699.9,156135.7,200580.9,78548.7,72087.7,65987,79153.2,120919.9,152801,189704.8,88964.5,67753.5,97536,93623.10000000001,136003.7,166188.4,177576.8,90690.2,82968.3,92925.5,103459.2,113823,150958.8,178062.5,94957.39999999999,84354.7,92856.5,109770.5,136199.9,165872.6,208660.1,91748.5,82392.5,106257.9,104790.5,120448.5,170816.6,191235.6,115879,95536.2,119891.5,117286.5,126499.7,164083.5,192459.8,128593.8,115802.6,122537,125135.6,118916.2,139717.7,191296.9,121121.1,104021.9,115108.3,161240.4,139887.7,151594,180809.7,121882.5,119722.9,131437.2,123937.5,138333.1,138347.3,187844.6,93665.60000000001,93121.7,102989.5,101282.4,129066.1,135518.71,194725,86453.5,98262.3,99652,109446.8,132847.2,157863.1,178458.8,86841.10000000001,101218.6,116123.6,102766.9,112742.3,143993.9,171264.9,72354,59940.6,65848.2,82800.2,112464.8,137209.4,177875,66181.39999999999,57974.2,58087.4,76530,94428.60000000001,133447.6,162184.1,62445.3,64797.7,57627.1,83461,118551.9,146684.1,128060.3,146466.6,58615.8,68887.89999999999,78168,84855.8,128949.1,161108,52333.9,73294.3,72356,80017.39999999999,92286.60000000001,129698.7,187664.9,70383.5,63438.1,55276.7,75581.5,104935,152284.6,163085.2,61526.1,56427.9,67779.2,58753.9,90867.39999999999,135578.1,138232.1,63725.2,69915,63204,78784.5,96545.2,136024.4,172571.3,71301,62595.9,64411.3,73901.89999999999,100537.1,136749.2,162707.8,68244.60000000001,70752.5,91351,98716.5,101113.9,137507.2,162904.9,59831.9,78480.2,79525.60000000001,79537.5,106249.8,134874,188545.4,75209.89999999999,78316.8,92603.39999999999,90872.89999999999,186611,222306.7,226203.5,208118.4,96776.8,89979.8,84422.89999999999,106839.3,136554.9,169396.7,63155,72166.7,74378,90598.60000000001,126002.5,153510.9,173066.4,74495.8,83854,62706.5,86249,118356.1,148946.6,204983.6,87185.2,96074.8,105889.05,135113.55,115351.5,187852.8,210939.4,117045.9,124669.25,130939.9,152525.4,163280.7,221330.2,228680.2,194894.1,81300.60000000001,140558.5,164215.2,144179.7,177196.3,196216.1,161307.7,87196.5,143940.6,160748.3,133293.2,149433.6,210579.7,105000.4,105595.6,89528.60000000001,84172,108892.6,148821.1,171660.2,69271,71639.2,88990.8,88883.39999999999,94033.89999999999,145295,171727,76936.5,77821.45,78025.3,91337.05,91340.10000000001,144971.5,166180.5,69268,80752.39999999999,78887.3,90082.5,118020.7,147776.9,136004.6,132662.2,85681.39999999999,66923.8,72600.10000000001,99708.8,108005.1,146170.5,63890.95,72502.7,75255.3,84140.60000000001,148821,147205.1,183651.3,61167.3,69270.39999999999,76718.5,82732.10000000001,115094.8,143836.1,169106.6,72136.8,66922.2,72268.60000000001,92080,115259.3,169638.6,161216.6,67756.3,62561.7,76853.5,64490.7,113706.1,131993.9,161841.2,84442.3,61229.9,75251.7,88190,113226.4,134003.4,134131.5,108365.1,63091,63637.4,68381.25,53547.8,53341.7,70389.2,29697.8,42027.3,33534.7,30247,33669.3,43393.2,35628.1,24755.6,27187.6,27075.7,24598.6,15153.4,27800.7,39449,7429.7,12950.4,10832.1,14240.4,16457.6],[682,694,762,704,706,602,709,649,687,708,716,716,551,522,540,557,626,648,711,506,449,472,518,590,593,640,353,318,348,415,554,553,632,285,319,309,371,544,640,586,294,278,280,299,422,580,587,210,245,265,354,478,454,569,249,227,281,291,400,535,559,247,211,230,287,487,565,590,238,247,191,290,429,541,608,226,215,250,242,454,580,540,244,244,221,261,388,536,546,227,218,222,252,384,430,503,217,194,276,302,492,490,542,181,193,186,191,325,526,549,216,206,245,286,513,588,595,517,205,176,195,359,459,586,231,237,238,252,424,535,572,238,252,274,280,388,646,565,276,296,418,310,374,562,606,384,400,438,524,535,588,651,273,468,458,466,498,506,595,237,353,388,361,396,434,472,226,210,248,215,310,432,473,211,226,249,204,361,440,506,185,181,185,217,310,414,451,165,216,199,216,307,405,470,400,171,187,173,253,390,434,159,132,144,369,340,431,451,155,163,144,186,248,332,463,135,157,173,218,322,385,484,134,119,156,183,254,369,445,135,137,124,179,213,460,497,341,136,136,188,259,396,395,139,137,168,162,276,411,443,149,165,171,169,281,407,443,173,146,188,190,332,401,419,274,302,335,301,320,323,408,257,245,256,310,413,413,492,208,483,459,216,273,379,490,166,176,198,258,284,367,397,166,182,280,276,323,415,490,165,180,173,202,313,382,474,208,973,208,224,397,454,505,176,204,160,192,338,448,495,208,169,249,222,369,482,471,196,228,215,230,326,415,537,208,198,209,265,330,460,525,229,185,259,257,329,437,456,292,213,239,277,301,463,519,326,303,275,283,325,348,508,272,228,240,537,423,479,532,312,367,342,376,363,407,473,232,261,289,290,353,387,524,241,281,295,301,394,505,534,258,266,281,360,319,395,461,188,150,141,184,262,362,449,178,151,177,179,284,383,399,141,136,160,220,319,409,335,409,99,183,160,233,332,442,126,190,189,196,249,350,504,150,149,128,184,298,414,459,155,117,143,125,239,378,356,154,161,134,174,276,338,424,155,134,136,153,250,376,378,123,139,179,204,243,343,359,132,150,138,152,271,344,406,180,154,186,187,459,610,551,480,146,167,185,238,310,357,150,122,161,188,282,348,420,173,176,141,164,317,399,478,212,201,223,326,296,466,553,285,284,320,360,409,506,630,483,201,317,390,356,399,465,370,174,288,297,333,320,425,236,202,160,179,254,373,401,128,148,192,204,215,386,411,192,158,165,181,236,337,406,154,161,149,187,302,364,368,295,134,121,144,241,267,350,132,150,142,174,445,434,440,145,148,164,167,279,391,409,141,136,130,176,272,451,427,153,128,153,131,274,389,412,160,124,150,191,288,358,337,252,136,147,130,147,130,174,82,84,68,58,100,118,103,64,79,58,53,36,85,87,29,51,39,44,48],[682,694,762,704,706,602,709,649,687,708,716,716,551,522,540,557,626,648,711,506,449,472,518,590,593,640,353,318,348,415,554,553,632,285,319,309,371,544,640,586,294,278,280,299,422,580,587,210,245,265,354,478,454,569,249,227,281,291,400,535,559,247,211,230,287,487,565,590,238,247,191,290,429,541,608,226,215,250,242,454,580,540,244,244,221,261,388,536,546,227,218,222,252,384,430,503,217,194,276,302,492,490,542,181,193,186,191,325,526,549,216,206,245,286,513,588,595,517,205,176,195,359,459,586,231,237,238,252,424,535,572,238,252,274,280,388,646,565,276,296,418,310,445,811,826,637,593,689,756,773,840,863,406,642,665,680,691,747,818,393,571,714,617,600,649,691,452,402,479,441,549,604,661,395,380,463,454,577,600,734,398,343,362,465,541,563,655,368,399,422,440,506,624,649,593,328,372,385,415,548,571,325,252,312,555,562,560,627,367,285,350,410,513,500,638,337,288,394,425,505,568,662,292,303,367,364,443,525,621,300,252,357,396,443,647,744,520,263,344,379,451,543,559,311,268,354,331,476,563,612,312,325,372,360,459,549,618,337,295,364,377,567,618,623,464,465,522,515,541,549,625,463,471,449,556,656,638,704,410,690,655,448,428,608,707,372,370,400,456,468,540,610,362,344,469,510,586,636,730,368,384,362,465,507,547,619,388,1136,382,436,628,604,727,361,363,338,396,519,602,696,389,330,442,405,570,640,668,413,403,412,461,499,608,732,468,379,408,479,555,676,739,403,354,463,472,515,679,721,491,404,536,501,551,630,748,524,489,511,511,503,523,768,508,436,467,839,593,654,777,503,595,597,608,582,617,749,403,459,477,509,568,544,808,407,433,500,537,594,703,734,416,484,512,545,561,609,674,395,314,324,376,491,565,645,338,305,288,363,467,569,582,304,296,289,417,534,593,497,592,305,341,378,406,510,593,256,353,379,393,425,560,688,329,311,291,376,476,609,605,293,275,304,293,424,541,529,296,341,285,344,449,516,638,306,288,305,355,472,523,610,320,339,410,443,437,521,578,290,362,358,354,475,517,668,352,354,408,403,706,818,764,691,389,383,387,425,518,604,284,300,334,396,502,530,649,312,361,315,374,489,606,708,378,387,437,534,510,663,737,480,475,548,592,617,779,841,666,309,512,603,551,629,659,586,339,537,570,543,543,809,412,431,359,368,471,575,613,306,324,386,414,407,576,637,331,329,372,374,413,552,595,321,356,324,382,518,545,537,515,349,294,338,444,403,513,263,333,332,384,612,588,641,283,322,347,390,476,579,634,327,307,314,421,449,650,595,312,302,327,298,486,532,606,338,291,371,412,484,478,548,435,275,298,310,247,238,307,142,173,139,128,168,181,125,104,113,101,102,61,110,130,29,51,39,44,48],[275.714809384164,318.194524495677,315.641732283464,326.053977272727,339.625495750708,287.285714285714,297.138222849083,301.482280431432,281.005822416302,292.094632768361,306.423184357541,312.997905027933,276.872958257713,284.818965517241,263.6,273.230700179533,274.58626198083,300.374228395061,295.39170182841,256.425889328063,280.3285077951,282.584745762711,260.753861003861,269.367796610169,295.753794266441,292.971875,221.291784702549,226.009433962264,236.987068965517,237.926506024096,236.796931407942,285.550632911392,295.224683544303,238.701754385964,225.351097178683,242.211974110032,209.920485175202,236.351102941176,285.340625,308.325085324232,234.646258503401,239.829136690647,241.014285714285,235.770903010033,248.521327014218,256.023275862068,300.890119250425,252.714285714285,208.981632653061,243.456603773584,230.53813559322,269.819037656903,242.636563876652,304.998242530755,244.56626506024,218.863436123348,224.156583629893,219.276632302405,227.285,274.095327102803,298.403398926654,216.034412955465,242.777251184834,235.847826086956,222.054006968641,245.469199178644,277.695575221238,283.495762711864,248.783613445378,222.32995951417,229.646596858638,212.231034482758,239.750582750582,279.937153419593,289.917763157894,232.247787610619,245.520930232558,239.296,222.157024793388,239.312775330396,282.58448275862,287.483333333333,239.338114754098,247.588114754098,247.31221719457,240.722222222222,240.768041237113,277.730410447761,298.088827838827,232.398678414096,228.020642201834,215.995495495495,238.257936507936,246.083333333333,286.094186046511,290.572564612326,216.108294930875,250.074742268041,240.260869565217,245.153973509933,291.134146341463,299.230612244897,273.276752767527,224.657458563535,227.388601036269,219.231182795698,193.439790575916,255.676923076923,252.070342205323,298.230418943533,231.481481481481,225.509708737864,213.295918367346,223.040209790209,264.263157894736,290.409013605442,310.864705882352,305.016441005802,202.163414634146,213.113636363636,219.017948717948,234.410863509749,259.584967320261,277.398464163822,208.523809523809,214.411392405063,197.993697478991,216.728174603174,228.456367924528,273.632710280373,276.829545454545,229.281512605042,207.269841269841,224.156934306569,214.146428571428,240.740979381443,275.712074303405,270.034513274336,225.001811594202,227.559121621621,238.407894736842,221.683870967741,259.332887700534,281.959074733096,280.273927392739,235.369791666666,251.00125,268.796803652968,256.826335877862,262.215887850467,282.864115646258,281.112903225806,263.844322344322,249.896367521367,269.354803493449,245.546137339055,254.164658634538,281.091897233201,269.996638655462,242.289029535864,275.856940509915,265.626288659793,235.861495844875,241.138888888888,258.900921658986,266.485169491525,222.466814159292,206.638095238095,220.655241935483,227.960465116279,229.824193548387,283.351851851851,256.155391120507,217.452606635071,221.657079646017,222.359437751004,221.799019607843,237.015235457063,246.681818181818,278.063241106719,223.9,227.734806629834,223.029729729729,239.156682027649,245.569354838709,246.384057971014,279.181818181818,235.70606060606,216.717592592592,216.201005025125,225.75,228.486970684039,242.148148148148,272.954255319148,271.1425,227.230994152046,235.128342245989,205.965317919075,239.221343873517,263.283333333333,261.434331797235,200.867924528301,218.056818181818,214.430555555555,253.979674796747,223.555882352941,263.970997679814,271.060975609756,213.54193548387,213.153374233128,221.184027777777,226.908602150537,246.701612903225,255.751807228915,267.718142548596,241.834074074074,233.716560509554,235.154913294797,220.129816513761,264.018322981366,271.857142857142,287.133264462809,220.276119402985,263.947899159663,214.391025641025,207.048633879781,249.564960629921,259.468292682926,281.55415730337,237.768888888888,263.831386861313,221.356451612903,232.235754189944,254.407981220657,243.039782608695,268.209456740442,258.268621700879,221.846323529411,220.798529411764,234.992553191489,252.227413127413,262.422222222222,283.884303797468,252.223741007194,230.224817518248,225.470238095238,218.652469135802,240.816304347826,262.602676399026,270.090970654627,233.120134228187,213.395151515151,238.619883040935,225.845562130177,256.568327402135,264.332678132678,272.398419864559,205.352023121387,250.47602739726,203.157978723404,226.973157894736,231.100602409638,273.740399002493,269.150119331742,260.985401459854,275.465894039735,239.815522388059,273.393687707641,257.1525,277.061300309597,303.995588235294,253.976653696498,242.595918367346,244.48046875,234.953548387096,223.447215496368,256.530266343825,294.218292682926,213.154807692307,258.229813664596,261.676906318082,197.467592592592,224.395238095238,265.832453825857,288.23081632653,206.706024096385,217.318181818181,225.577777777777,209.227131782945,248.142253521126,260.547683923705,268.159697732997,255.956626506024,236.48901098901,261.458571428571,250.575,236.6520123839,264.381686746987,283.290612244897,228.010909090909,246.655,225.306936416184,212.010891089108,242.335463258785,248.191099476439,292.759071729957,210.405288461538,225.79897225077,218.385096153846,222.244642857142,233.696221662468,285.317621145374,296.199801980198,232.191477272727,215.280392156862,200.63125,215.365625,255.271893491124,271.962053571428,303.503636363636,263.182692307692,205.183431952662,239.897590361445,242.608558558558,266.728184281842,280.447925311203,288.784076433121,256.927040816326,218.613157894736,254.602325581395,237.692173913043,242.685582822085,271.860963855421,266.211359404096,216.641346153846,245.099494949494,232.918660287081,247.4,268.426969696969,270.185,305.206857142857,230.569868995633,261.335135135135,246.271814671814,236.029182879377,254.127659574468,280.110068649885,292.490350877193,253.42808219178,265.83896713615,237.763598326359,253.944043321299,249.158471760797,271.502159827213,269.223121387283,264.247852760736,248.533333333333,263.641818181818,263.242402826855,256.828307692307,298.502011494252,274.080511811023,270.807352941176,275.547807017543,260.17,184.482122905027,244.563120567375,230.902922755741,229.020112781954,249.626602564102,204.524250681198,243.842690058479,197.992021276595,243.489256198347,230.407371007371,266.089006342494,237.957327586206,192.410727969348,217.62802768166,197.954827586206,230.459206798866,259.189173126615,254.67748091603,213.651452282157,230.043772241992,204.774576271186,212.549169435215,229.313959390862,227.790297029702,253.74213483146,208.151550387596,210.57932330827,228.938078291814,179.769166666666,216.801880877742,243.356708860759,269.99219088937,167.452127659574,193.640666666666,215.441134751773,236.710326086956,258.678625954198,270.122651933701,306.39977728285,195.395505617977,221.653642384105,196.053107344632,203.58938547486,205.470422535211,258.936292428198,308.178195488721,230.66524822695,264.247794117647,209.54125,198.263636363636,238.858620689655,276.428117359413,279.974029850746,264.618826405868,197.088888888888,209.756284153005,215.125,210.617167381974,283.902409638554,291.308823529411,215.146031746031,238.288421052631,218.566137566137,219.578571428571,238.57469879518,256.907714285714,298.01865079365,231.05,236.346308724832,193.64609375,208.168478260869,231.023489932885,273.514734299516,289.79128540305,232.78129032258,222.170085470085,231.17972027972,236.0952,244.066527196652,273.549206349206,283.465168539325,219.30974025974,223.5,263.380597014925,251.85632183908,232.634782608695,290.215680473372,295.679952830188,257.203225806451,237.439552238806,224.174999999999,218.567973856209,245.000399999999,277.852925531914,300.233597883597,196.50081300813,223,224.986033519553,224.213235294117,254.509876543209,296.44081632653,314.413370473537,218.533333333333,245.197999999999,250.51884057971,253.519736842105,232.347970479704,280.107558139534,312.162315270935,227.157777777777,248.047402597402,239.012903225806,240.082352941176,293.408496732026,299.90606557377,327.552631578947,327.412291666666,272.878767123287,249.67245508982,245.175135135135,275.146218487394,297.060967741935,316.118207282913,240.703333333333,265.710655737704,248.096273291925,261.575,283.019503546099,324.672126436781,298.317619047619,268.793641618497,256.769886363636,218.574468085106,259.466463414634,266.713249211356,275.83984962406,330.307740585774,259.960849056603,297.534825870646,275.764798206278,289.478680981595,258.483108108108,319.87939914163,310.59746835443,253.364561403508,282.553697183098,260.254375,294.602499999999,289.603178484107,299.452964426877,296.73365079365,325.250724637681,286.127363184079,306.410094637223,285.572307692307,283.393820224719,286.13984962406,319.446451612903,306.931621621621,294.893678160919,284.493055555555,309.504377104377,255.875975975975,286.633125,301.944,253.637288135593,275.829702970297,266.544375,241.667597765363,256.648031496062,284.423860589812,309.511720698254,230.04296875,241.646621621621,227.100520833333,240.460294117647,238.962325581395,278.084196891191,282.469586374695,253.518229166666,251.406329113924,243.335151515151,269.141160220994,241.373305084745,293.27299703264,307.896551724137,236.62987012987,245.806832298136,261.609395973154,274.635828877005,251.677814569536,297.983241758241,271.261956521739,273.146440677966,253.103731343283,241.126446280991,216.830555555555,247.109128630705,293.125842696629,305.071428571428,272.113257575757,222.581333333333,245.395070422535,243.141379310344,265.973033707865,268.3366359447,309.17909090909,237.598620689655,243.36081081081,245.783536585365,235.144311377245,267.162365591397,274.881329923273,305.09804400978,270.190070921985,231.354411764705,255.843076923076,240.340909090909,284.843014705882,293.629933481153,289.515456674473,249.165359477124,221.15390625,263.5,225.564885496183,264.9200729927,267.187146529563,291.222572815533,293.095625,230.652419354838,221.791333333333,240.36282722513,258.164236111111,310.436871508379,284.864985163204,291.129365079365,257.5,239.051020408163,254.685,236.862585034013,266.505384615384,260.960919540229,222.906097560975,271.985714285714,285.260294117647,233.568965517241,246.007999999999,268.811016949152,310.719417475728,257.36875,258.577215189873,262.322413793103,315.275471698113,286.983333333333,284.925882352941,356.057471264367,256.196551724137,253.929411764705,277.746153846153,323.645454545454,342.866666666666],[275.714809384164,318.194524495677,315.641732283464,326.053977272727,339.625495750708,287.285714285714,297.138222849083,301.482280431432,281.005822416302,292.094632768361,306.423184357541,312.997905027933,276.872958257713,284.818965517241,263.6,273.230700179533,274.58626198083,300.374228395061,295.39170182841,256.425889328063,280.3285077951,282.584745762711,260.753861003861,269.367796610169,295.753794266441,292.971875,221.291784702549,226.009433962264,236.987068965517,237.926506024096,236.796931407942,285.550632911392,295.224683544303,238.701754385964,225.351097178683,242.211974110032,209.920485175202,236.351102941176,285.340625,308.325085324232,234.646258503401,239.829136690647,241.014285714285,235.770903010033,248.521327014218,256.023275862068,300.890119250425,252.714285714285,208.981632653061,243.456603773584,230.53813559322,269.819037656903,242.636563876652,304.998242530755,244.56626506024,218.863436123348,224.156583629893,219.276632302405,227.285,274.095327102803,298.403398926654,216.034412955465,242.777251184834,235.847826086956,222.054006968641,245.469199178644,277.695575221238,283.495762711864,248.783613445378,222.32995951417,229.646596858638,212.231034482758,239.750582750582,279.937153419593,289.917763157894,232.247787610619,245.520930232558,239.296,222.157024793388,239.312775330396,282.58448275862,287.483333333333,239.338114754098,247.588114754098,247.31221719457,240.722222222222,240.768041237113,277.730410447761,298.088827838827,232.398678414096,228.020642201834,215.995495495495,238.257936507936,246.083333333333,286.094186046511,290.572564612326,216.108294930875,250.074742268041,240.260869565217,245.153973509933,291.134146341463,299.230612244897,273.276752767527,224.657458563535,227.388601036269,219.231182795698,193.439790575916,255.676923076923,252.070342205323,298.230418943533,231.481481481481,225.509708737864,213.295918367346,223.040209790209,264.263157894736,290.409013605442,310.864705882352,305.016441005802,202.163414634146,213.113636363636,219.017948717948,234.410863509749,259.584967320261,277.398464163822,208.523809523809,214.411392405063,197.993697478991,216.728174603174,228.456367924528,273.632710280373,276.829545454545,229.281512605042,207.269841269841,224.156934306569,214.146428571428,240.740979381443,275.712074303405,270.034513274336,225.001811594202,227.559121621621,238.407894736842,221.683870967741,213.011514272802,221.815882748074,217.514236423642,202.24714879776,205.728604274611,214.576688679073,215.43795242169,220.687775858007,236.852692743764,230.696781801582,212.754867939078,214.545884910109,230.789720587304,230.87003128635,235.79476455043,233.121674757679,240.768498699928,233.952207075624,258.105075759545,244.018665802289,215.465904172438,223.444444444444,229.651623620191,241.026831321105,211.337389380531,196.793005952381,201.362253002374,211.308772381148,209.694523552436,241.335809646856,221.930089177274,198.983096795796,204.330163199632,203.562896445595,203.496509803922,213.339793654457,210.937784090909,233.522848623535,205.399530516432,188.443020598868,203.084073904413,212.887816820276,225.726235860912,200.307800797588,229.275958110517,211.217562322734,194.917539465695,212.146466638123,199.690848214286,208.291224035487,210.287544393709,225.19640140259,224.281094559585,201.849573509144,200.297954906778,198.697281601046,212.464066998487,215.844198312236,222.361326482559,188.640287565355,194.005492424242,191.548611111111,215.563762129556,191.969382617912,206.541700390295,226.425374168514,204.980873402312,196.236523182138,202.118712918015,204.082649289554,213.444202678028,202.359534566838,241.173356988584,207.315551888522,191.36209704867,209.549176104412,198.794376855914,224.378013949699,208.89988290398,237.559609759494,197.030464764784,222.69813436244,191.770157370276,189.774316939891,207.966342748823,219.633184803001,239.954635469867,212.414747474747,215.854823865439,201.990457566108,213.690457740133,215.73007756685,214.080051732155,235.928615009897,229.741852749881,199.940878300138,201.096380090497,207.142873454383,216.902769063707,224.668594104308,248.9756884841,236.79501003848,194.799431659887,205.579205069124,200.804045218789,221.746902173913,239.633575041618,236.586905445657,219.575404537406,194.050700757576,215.666906694597,218.742152792837,223.176017633652,214.504367235353,235.756352789422,200.967170097278,213.727946584536,199.130125725338,205.622942583732,216.413067162266,241.688171851477,240.1596184894,234.392700729927,250.410861130297,215.97326921542,251.717871891204,233.144123303167,247.12025192471,270.795029140688,232.337841411356,226.697295466859,227.437125566709,218.629213217938,210.426282645303,236.380688727468,259.90867464335,191.754384044173,220.244133885438,234.184116424347,205.11095146871,213.550844854071,240.76011337581,262.480615536537,200.821458650134,211.035379568884,203.038888888889,194.835788113695,217.073844151867,236.059969129483,241.629144641146,226.464282640767,213.057777099443,227.2941005291,219.955235042735,225.30889592579,226.740617129149,244.544264455782,228.381070309001,214.465980392157,204.064843869468,204.825787749877,216.451236784032,222.692519435189,238.338156554633,207.017922008547,197.164823548697,208.738525088417,211.480811994609,205.424950658074,231.330477239354,262.964765854964,217.941684582309,196.226674065852,195.501018258426,200.337224264706,223.32102961849,236.507000811688,249.937141564903,226.128638971526,205.316871255834,217.880142330982,229.949088022448,226.849166767787,238.364785440411,249.873002683566,221.395548057933,203.948007518797,224.219944516585,224.452147562582,221.653485052661,234.729704725638,223.123628419997,204.274519230769,221.513835872537,227.455561299319,226.993224299065,240.033484848485,231.359861111111,265.749456608812,227.204474727702,231.393898928514,227.237623022182,220.644823997828,226.097431937772,240.072596308414,255.414986759351,231.935146623528,234.784666814148,225.053516334897,231.757735946363,227.585235880399,250.655271530373,249.749115278794,239.318370824812,233.129569892473,237.828324345146,242.669447027463,227.984378565255,251.648148604269,237.163332828588,235.957701894317,236.805153508772,246.092709251101,195.177319730659,229.450677930746,232.570032806442,234.859035982814,239.993929554302,200.206204287967,216.123305813553,205.660881327953,235.777733122005,221.326304551305,245.335264040812,231.433342155676,204.54501044932,215.449652138702,199.149788222327,226.192394097107,241.73630630853,235.215501021395,212.13747312903,225.613991384154,198.10314179413,202.608271158285,220.900729695431,222.049188918891,234.27231741573,208.942863801393,208.969707525695,226.572935249803,192.72242117117,198.447428042177,233.519475925707,244.851729247502,182.453116969884,191.010882113821,204.635867922335,220.556985960145,226.917915597186,232.1672372969,256.009837621016,195.825877808988,190.386886127117,203.368896014658,210.728116650473,201.300785038097,221.605242988293,261.250299930153,207.116366444763,222.311397058824,198.183415697674,200.256183664052,217.931635926223,229.586341288402,245.755533443892,236.783456918781,193.457065803667,201.40504081068,207.901949541284,208.724768662085,239.40485650467,252.77196143358,204.594169719169,205.093597029383,190.985700362016,203.64715373459,212.700701670317,223.170523809524,250.81231452726,215.318296089385,205.279635843897,190.350654236963,201.163666213768,216.888149460825,236.884290226681,247.878519413854,208.582674146797,207.395169317321,223.417499891413,205.077361904762,209.96704738211,235.475523420001,249.589520685847,215.117898298884,206.004166666667,224.110828308787,228.756102096011,209.779819050012,251.656997540057,258.127359592664,232.689361247596,218.651594301221,212.452884615384,209.434977027114,210.984434234234,248.710476371399,256.193307562488,210.115888737568,210.88875,223.0525405693,222.937161580113,228.461123838615,248.860857601467,271.431571081517,207.322046413501,220.949235849056,227.427602108037,228.251205054716,222.260995043774,251.374588318321,274.034401910277,213.35069121447,224.317451298701,227.945640802092,226.470574618736,251.838863750628,244.578032786885,271.104954287126,284.465624506319,253.592675742713,236.605903470836,219.284349745785,248.146638655462,255.41990694789,272.517605665748,221.28263681592,244.512631239639,223.56981294654,230.360817307692,246.489297227594,273.668480800808,253.466669785818,235.096461097018,232.878186425061,200.91798116899,233.772517421603,231.63569437312,231.848668773382,267.537565945061,226.587352239145,246.268219386936,241.60552994426,242.680446260028,219.990385829755,258.388938149495,261.763408090258,241.648947368421,257.570042308826,234.641441885965,247.448879310344,252.573223857438,277.578130565087,247.272038666967,265.898586362556,253.197940851298,264.555047318612,266.82840736728,252.700756266205,280.084055246812,282.593071167276,263.982014514514,256.189263322884,266.757772757697,280.806217856218,242.429654654654,272.713423486547,258.072911458333,255.062962249615,246.818781616152,251.064901067839,229.070571369454,229.024476577524,247.981732275104,266.892652801957,226.890866397471,222.74234490172,230.528353200172,215.062289915966,230.567100290698,238.92236160349,264.314439205047,228.417387964628,237.104480346435,213.153083003952,244.991564566456,217.793997175141,253.935335725622,262.875524539317,216.59936620266,228.486749482401,244.826126558006,236.614324694913,223.093536914398,257.585543531054,242.672990095189,254.94594761171,246.936749392572,229.660043949744,215.055741695303,222.459736729146,255.902994877726,273.380806310254,242.819987566504,218.163617486339,229.037535211267,221.175451559934,224.19310368028,233.996240050272,273.028600180913,215.5946001999,217.235003106554,222.372642609622,215.022828334362,236.516461983516,234.13614368504,251.041244227112,226.600411805079,219.355568455451,233.924255852842,221.762291280148,249.150320912263,240.311197896355,256.643145003903,217.771358983845,209.007987607759,236.744252873563,217.398311011565,229.43645159069,231.698818020026,253.491441046942,252.016913623595,213.017826443886,205.879829562594,215.839105920257,228.253291524943,250.497602420856,232.792682155061,241.194463960448,229.724820143885,213.886106230572,225.320833333333,212.076292517007,219.808247863248,224.397753003197,206.615548780488,243.748475120385,242.186485086993,236.070197044335,189.684147058823,227.052333871401,237.7233451015,232.234375,228.700372300819,269.079811547714,238.137735849057,239.931666666667,214.102941176471,276.54036353916,128.098275862069,126.964705882353,138.873076923077,161.822727272727,171.433333333333],[795,841,975,1124,793,707,879,829,791,803,792,849,570,547,597,605,656,705,755,505,507,440,513,680,658,695,301,287,352,421,572,664,755,266,268,290,337,508,712,705,320,271,275,294,438,635,684,184,202,288,332,551,484,692,225,211,257,269,366,607,672,215,207,213,285,497,662,699,244,213,185,238,394,578,706,203,157,251,177,457,727,646,156,207,204,225,376,607,621,219,204,190,233,372,477,568,169,176,269,315,542,560,602,174,176,150,156,306,519,594,184,190,230,258,547,700,743,666,167,139,152,328,473,654,206,169,163,224,409,563,633,204,191,218,227,398,726,676,239,271,429,295,401,643,692,380,430,509,587,590,671,839,320,483,534,506,458,530,729,207,410,455,357,399,507,541,212,180,231,180,268,527,525,173,196,249,171,329,450,565,178,144,136,216,308,454,471,151,191,185,190,300,461,575,483,169,168,140,257,428,446,131,123,110,410,310,484,506,136,126,114,169,216,394,525,141,133,149,184,332,420,556,125,125,151,155,254,402,455,123,125,90,162,230,438,513,369,138,128,192,254,409,470,125,127,144,151,262,459,489,123,121,160,147,257,421,456,132,128,164,196,315,420,413,299,321,364,332,316,305,504,254,241,215,308,412,450,556,213,519,544,176,242,344,503,156,167,176,236,286,375,393,148,144,275,300,315,421,519,158,163,150,175,297,380,526,182,2099,187,187,368,522,596,168,157,121,174,316,463,587,196,129,224,223,406,479,546,184,206,196,198,257,406,613,157,191,183,268,327,482,627,214,175,267,246,330,455,514,290,226,238,255,288,506,578,315,325,296,313,321,448,571,300,254,263,767,441,496,547,322,358,396,414,401,470,556,260,272,318,286,415,458,566,274,318,306,284,408,605,613,262,253,296,314,324,434,502,151,140,151,192,301,390,576,179,131,139,185,296,389,505,152,141,133,188,350,429,385,446,84,161,134,192,397,556,115,199,160,177,248,382,595,144,152,106,158,302,447,554,140,116,154,125,288,436,439,152,152,126,186,235,386,444,174,132,127,141,216,393,473,102,125,172,215,264,422,450,115,163,148,131,263,342,437,162,145,189,185,538,737,699,628,126,137,159,251,339,399,107,126,172,198,319,425,444,182,173,129,176,279,420,560,217,203,217,337,294,510,666,269,261,286,397,417,582,642,576,187,364,460,450,439,591,400,220,290,339,322,342,498,224,209,136,179,255,424,435,115,103,155,194,196,379,459,195,145,177,212,194,326,429,119,153,123,172,308,316,322,293,89,95,109,209,234,369,133,127,120,165,443,402,453,118,117,111,128,267,396,447,121,99,125,166,242,489,377,136,105,154,118,246,368,401,129,108,103,140,270,346,355,249,127,137,130,104,107,189,63,78,74,57,96,107,86,66,68,66,71,31,110,120,24,52,35,35,69],[795,841,975,1124,793,707,879,829,791,803,792,849,570,547,597,605,656,705,755,505,507,440,513,680,658,695,301,287,352,421,572,664,755,266,268,290,337,508,712,705,320,271,275,294,438,635,684,184,202,288,332,551,484,692,225,211,257,269,366,607,672,215,207,213,285,497,662,699,244,213,185,238,394,578,706,203,157,251,177,457,727,646,156,207,204,225,376,607,621,219,204,190,233,372,477,568,169,176,269,315,542,560,602,174,176,150,156,306,519,594,184,190,230,258,547,700,743,666,167,139,152,328,473,654,206,169,163,224,409,563,633,204,191,218,227,398,726,676,239,271,429,295,457,786,811,540,541,641,698,720,808,954,366,573,648,653,563,659,828,296,551,677,480,515,641,681,338,275,352,303,402,626,624,264,285,344,324,422,525,693,306,209,206,344,424,508,555,276,288,303,298,385,543,645,585,229,245,247,336,488,499,197,168,190,506,404,530,607,219,156,200,279,317,450,622,243,173,244,262,402,475,644,172,208,235,237,343,461,551,190,174,215,278,325,511,655,449,206,221,291,349,482,549,228,179,243,218,353,535,592,215,207,226,240,356,481,553,210,185,244,269,431,521,491,385,368,440,448,458,424,629,354,356,311,441,530,583,675,309,620,652,300,326,511,629,254,270,275,332,384,453,519,252,208,369,425,453,512,638,264,271,249,327,413,470,587,283,2162,279,276,493,595,741,286,223,199,270,391,531,682,297,222,346,332,497,543,639,297,305,290,293,338,478,691,272,296,283,371,449,570,761,271,218,361,337,415,591,663,380,320,430,383,422,580,704,396,440,373,440,409,538,718,414,385,400,921,516,595,694,422,477,538,526,531,581,750,386,409,455,426,515,545,739,359,402,407,389,522,718,733,368,393,461,412,481,558,642,276,230,252,286,422,500,684,254,200,194,286,433,485,635,241,212,192,303,462,522,465,554,163,249,250,292,483,636,184,261,258,274,336,488,699,246,230,182,243,389,578,624,198,200,252,221,372,485,550,226,243,191,277,314,490,578,248,233,219,249,355,477,612,218,210,298,350,367,528,590,186,286,277,229,364,448,590,260,251,326,308,710,844,807,755,278,269,258,355,456,540,194,235,265,291,432,520,562,242,283,226,311,382,523,662,305,286,336,462,399,637,766,388,400,415,515,517,749,753,677,258,481,597,573,591,734,513,314,444,523,448,509,712,319,332,256,248,364,550,542,215,198,286,286,287,477,566,261,240,270,319,285,435,531,205,285,246,260,407,418,414,421,211,201,211,344,308,432,214,211,221,262,523,485,586,194,209,199,237,358,483,524,203,189,220,273,327,594,473,209,191,254,230,359,451,520,226,199,203,250,389,406,430,339,214,202,238,155,149,241,82,119,90,80,136,132,89,70,83,90,100,38,116,132,24,52,35,35,69],[499,609,1384,701,536,457,538,488,459,519,591,596,414,419,346,390,470,518,586,358,328,413,352,362,468,503,219,188,189,228,300,391,480,160,191,200,183,319,414,459,172,160,159,170,242,366,436,140,134,146,223,315,258,447,160,126,151,148,226,358,415,130,108,131,145,273,355,405,136,147,116,140,281,346,424,126,181,141,161,278,357,371,209,173,150,174,232,337,419,124,108,113,160,219,294,374,132,121,152,171,349,372,346,93,118,111,81,232,332,439,135,106,127,152,328,403,465,349,105,100,115,189,295,416,114,157,147,141,226,378,383,133,148,161,158,238,426,353,157,174,226,155,233,361,397,202,224,244,301,306,381,357,144,264,259,224,347,353,342,154,217,218,191,216,234,276,128,95,113,120,200,262,263,121,125,107,110,215,234,316,96,104,109,121,157,200,278,89,104,103,131,146,179,231,198,72,92,140,137,222,260,72,67,93,159,170,225,238,77,75,68,94,150,139,253,68,103,104,133,190,216,295,64,66,58,92,141,193,285,72,87,45,62,121,246,297,173,52,61,88,143,203,204,80,70,90,77,155,196,268,84,92,101,83,167,211,259,86,92,73,82,181,249,267,135,169,144,454,187,214,273,155,126,170,131,185,210,311,90,223,197,97,124,243,307,21,75,109,109,134,175,220,118,99,152,131,134,213,293,80,93,86,90,135,174,237,71,303,81,107,177,235,254,77,89,61,61,151,247,266,110,72,115,95,169,269,244,101,92,97,104,161,222,246,111,91,97,118,183,229,291,96,106,121,337,142,233,255,132,89,113,128,141,221,249,165,131,120,122,138,169,259,129,129,105,160,201,187,200,143,120,125,102,135,124,190,90,67,95,85,92,172,235,73,100,91,107,156,147,212,85,97,99,98,110,132,221,47,51,48,62,98,180,204,47,64,78,43,75,163,199,44,67,58,78,125,199,142,195,33,65,61,84,158,200,47,74,56,80,75,143,252,60,60,39,63,102,188,217,70,43,47,50,67,159,145,56,56,68,80,116,166,238,63,48,60,60,115,163,192,43,57,75,73,105,172,180,55,61,62,83,95,154,253,82,73,75,79,197,266,265,254,81,91,113,115,159,215,84,63,67,90,125,197,242,76,86,52,77,183,189,290,98,109,118,158,129,272,291,127,165,174,186,226,263,361,277,97,148,136,138,179,245,192,70,139,151,143,155,180,97,110,102,61,99,158,225,45,79,88,92,81,180,181,76,77,60,64,109,196,221,76,66,92,100,113,246,205,159,84,63,68,120,184,208,67,61,63,84,241,208,274,78,77,94,96,151,223,273,90,68,62,78,167,201,274,81,48,80,56,144,186,228,105,62,76,112,145,222,157,129,62,58,58,80,81,89,40,42,39,19,51,65,75,36,45,28,27,25,54,64,20,24,30,39,34],[499,609,1384,701,536,457,538,488,459,519,591,596,414,419,346,390,470,518,586,358,328,413,352,362,468,503,219,188,189,228,300,391,480,160,191,200,183,319,414,459,172,160,159,170,242,366,436,140,134,146,223,315,258,447,160,126,151,148,226,358,415,130,108,131,145,273,355,405,136,147,116,140,281,346,424,126,181,141,161,278,357,371,209,173,150,174,232,337,419,124,108,113,160,219,294,374,132,121,152,171,349,372,346,93,118,111,81,232,332,439,135,106,127,152,328,403,465,349,105,100,115,189,295,416,114,157,147,141,226,378,383,133,148,161,158,238,426,353,157,174,226,155,266,438,444,286,280,317,408,403,465,426,183,321,333,290,436,421,444,218,313,336,293,299,307,371,201,153,180,192,297,317,324,178,181,195,168,310,280,402,164,150,179,210,250,239,364,166,153,209,201,224,262,296,260,123,144,223,186,273,316,127,99,145,207,231,261,301,165,130,145,164,256,185,329,128,135,174,204,262,269,365,115,128,121,157,182,243,347,123,119,115,132,199,308,374,241,93,128,148,199,256,273,158,103,649,135,233,258,316,130,136,198,157,226,252,318,154,140,146,153,278,350,362,217,273,228,556,260,292,377,241,219,251,227,278,296,395,137,284,253,205,183,315,405,92,156,179,177,185,253,299,176,164,212,206,233,279,389,184,143,153,179,200,220,289,145,363,141,190,244,278,349,138,150,124,126,237,310,344,169,125,163,166,248,329,336,176,142,171,194,228,300,302,207,144,184,201,268,302,365,185,211,210,416,204,290,370,213,164,197,214,236,305,352,251,188,223,232,200,244,350,214,190,211,266,285,258,316,218,188,213,212,210,202,294,150,142,146,139,197,229,332,133,160,146,188,229,207,289,124,143,178,177,153,217,292,114,98,110,139,178,239,273,97,105,120,114,115,208,255,98,216,104,142,195,260,214,255,107,111,137,141,217,264,82,123,100,152,130,209,314,107,98,88,142,172,249,271,119,103,103,89,136,246,214,117,111,127,144,187,231,324,134,97,115,121,164,214,266,123,151,165,180,171,228,271,115,132,148,140,183,234,355,140,147,157,154,271,325,351,335,179,178,187,197,233,319,120,128,126,172,203,290,334,130,153,96,129,242,258,411,153,173,191,231,195,328,357,211,232,262,277,320,426,431,340,135,221,232,204,304,319,281,132,250,259,221,255,313,182,215,184,153,183,221,322,120,146,170,167,164,249,308,136,153,120,149,182,284,297,131,143,160,178,184,314,272,251,204,139,153,203,243,311,124,147,154,161,302,249,360,118,136,162,183,239,297,371,157,145,155,202,267,263,353,142,126,152,115,218,226,300,176,123,161,184,220,261,221,177,111,116,116,109,106,131,63,79,65,61,67,92,85,62,61,58,40,37,62,86,20,24,30,39,34],[1294,1450,2359,1825,1329,1164,1417,1317,1250,1322,1383,1445,984,966,943,995,1126,1223,1341,863,835,853,865,1042,1126,1198,520,475,541,649,872,1055,1235,426,459,490,520,827,1126,1164,492,431,434,464,680,1001,1120,324,336,434,555,866,742,1139,385,337,408,417,592,965,1087,345,315,344,430,770,1017,1104,380,360,301,378,675,924,1130,329,338,392,338,735,1084,1017,365,380,354,399,608,944,1040,343,312,303,393,591,771,942,301,297,421,486,891,932,948,267,294,261,237,538,851,1033,319,296,357,410,875,1103,1208,1015,272,239,267,517,768,1070,320,326,310,365,635,941,1016,337,339,379,385,636,1152,1029,396,445,655,450,634,1004,1089,582,654,753,888,896,1052,1196,464,747,793,730,805,883,1071,361,627,673,548,615,741,817,340,275,344,300,468,789,788,294,321,356,281,544,684,881,274,248,245,337,465,654,749,240,295,288,321,446,640,806,681,241,260,280,394,650,706,203,190,203,569,480,709,744,213,201,182,263,366,533,778,209,236,253,317,522,636,851,189,191,209,247,395,595,740,195,212,135,224,351,684,810,542,190,189,280,397,612,674,205,197,234,228,417,655,757,207,213,261,230,424,632,715,218,220,237,278,496,669,680,434,490,508,786,503,519,777,409,367,385,439,597,660,867,303,742,741,273,366,587,810,177,242,285,345,420,550,613,266,243,427,431,449,634,812,238,256,236,265,432,554,763,253,2402,268,294,545,757,850,245,246,182,235,467,710,853,306,201,339,318,575,748,790,285,298,293,302,418,628,859,268,282,280,386,510,711,918,310,281,388,583,472,688,769,422,315,351,383,429,727,827,480,456,416,435,459,617,830,429,383,368,927,642,683,747,465,478,521,516,536,594,746,350,339,413,371,507,630,801,347,418,397,391,564,752,825,347,350,395,412,434,566,723,198,191,199,254,399,570,780,226,195,217,228,371,552,704,196,208,191,266,475,628,527,641,117,226,195,276,555,756,162,273,216,257,323,525,847,204,212,145,221,404,635,771,210,159,201,175,355,595,584,208,208,194,266,351,552,682,237,180,187,201,331,556,665,145,182,247,288,369,594,630,170,224,210,214,358,496,690,244,218,264,264,735,1003,964,882,207,228,272,366,498,614,191,189,239,288,444,622,686,258,259,181,253,462,609,850,315,312,335,495,423,782,957,396,426,460,583,643,845,1003,853,284,512,596,588,618,836,592,290,429,490,465,497,678,321,319,238,240,354,582,660,160,182,243,286,277,559,640,271,222,237,276,303,522,650,195,219,215,272,421,562,527,452,173,158,177,329,418,577,200,188,183,249,684,610,727,196,194,205,224,418,619,720,211,167,187,244,409,690,651,217,153,234,174,390,554,629,234,170,179,252,415,568,512,378,189,195,188,184,188,278,103,120,113,76,147,172,161,102,113,94,98,56,164,184,44,76,65,74,103],[1294,1450,2359,1825,1329,1164,1417,1317,1250,1322,1383,1445,984,966,943,995,1126,1223,1341,863,835,853,865,1042,1126,1198,520,475,541,649,872,1055,1235,426,459,490,520,827,1126,1164,492,431,434,464,680,1001,1120,324,336,434,555,866,742,1139,385,337,408,417,592,965,1087,345,315,344,430,770,1017,1104,380,360,301,378,675,924,1130,329,338,392,338,735,1084,1017,365,380,354,399,608,944,1040,343,312,303,393,591,771,942,301,297,421,486,891,932,948,267,294,261,237,538,851,1033,319,296,357,410,875,1103,1208,1015,272,239,267,517,768,1070,320,326,310,365,635,941,1016,337,339,379,385,636,1152,1029,396,445,655,450,723,1224,1255,826,821,958,1106,1123,1273,1380,549,894,981,943,999,1080,1272,514,864,1013,773,814,948,1052,539,428,532,495,699,943,948,442,466,539,492,732,805,1095,470,359,385,554,674,747,919,442,441,512,499,609,805,941,845,352,389,470,522,761,815,324,267,335,713,635,791,908,384,286,345,443,573,635,951,371,308,418,466,664,744,1009,287,336,356,394,525,704,898,313,293,330,410,524,819,1029,690,299,349,439,548,738,822,386,282,892,353,586,793,908,345,343,424,397,582,733,871,364,325,390,422,709,871,853,602,641,668,1004,718,716,1006,595,575,562,668,808,879,1070,446,904,905,505,509,826,1034,346,426,454,509,569,706,818,428,372,581,631,686,791,1027,448,414,402,506,613,690,876,428,2525,420,466,737,873,1090,424,373,323,396,628,841,1026,466,347,509,498,745,872,975,473,447,461,487,566,778,993,479,440,467,572,717,872,1126,456,429,571,753,619,881,1033,593,484,627,597,658,885,1056,647,628,596,672,609,782,1068,628,575,611,1187,801,853,1010,640,665,751,738,741,783,1044,536,551,601,565,712,774,1071,492,562,553,577,751,925,1022,492,536,639,589,634,775,934,390,328,362,425,600,739,957,351,305,314,400,548,693,890,339,428,296,445,657,782,679,809,270,360,387,433,700,900,266,384,358,426,466,697,1013,353,328,270,385,561,827,895,317,303,355,310,508,731,764,343,354,318,421,501,721,902,382,330,334,370,519,691,878,341,361,463,530,538,756,861,301,418,425,369,547,682,945,400,398,483,462,981,1169,1158,1090,457,447,445,552,689,859,314,363,391,463,635,810,896,372,436,322,440,624,781,1073,458,459,527,693,594,965,1123,599,632,677,792,837,1175,1184,1017,393,702,829,777,895,1053,794,446,694,782,669,764,1025,501,547,440,401,547,771,864,335,344,456,453,451,726,874,397,393,390,468,467,719,828,336,428,406,438,591,732,686,672,415,340,364,547,551,743,338,358,375,423,825,734,946,312,345,361,420,597,780,895,360,334,375,475,594,857,826,351,317,406,345,577,677,820,402,322,364,434,609,667,651,516,325,318,354,264,255,372,145,198,155,141,203,224,174,132,144,148,140,75,178,218,44,76,65,74,103],[1187,1271,1411,1556,1107,1016,1200,1139,1180,1190,1281,1284,913,864,849,956,1025,1164,1222,756,765,779,851,973,1041,1127,464,443,493,609,807,994,1068,422,434,448,456,767,1081,1058,395,400,413,409,603,864,1042,315,293,380,507,771,617,998,351,285,370,379,539,904,950,299,297,307,378,714,935,972,345,309,247,340,590,915,1007,304,310,329,298,649,1010,922,330,346,323,375,555,892,971,321,292,264,360,557,713,830,272,298,372,442,849,813,884,249,99,239,210,502,739,944,31,260,296,380,804,1016,1099,971,251,225,260,527,737,963,287,313,286,323,601,905,969,347,328,379,374,565,1079,894,379,409,610,444,594,964,1021,573,616,744,859,892,1084,1150,443,724,765,744,792,876,1000,359,594,639,515,580,707,753,301,259,327,304,416,764,710,274,288,333,271,521,685,840,237,251,248,301,465,632,765,233,282,250,273,420,593,751,654,234,253,203,365,634,649,185,162,160,541,447,692,696,194,204,188,242,362,506,734,186,214,236,270,508,616,809,178,195,202,213,369,556,737,192,208,153,238,304,672,722,521,171,172,257,381,602,675,193,184,218,199,362,612,641,184,203,221,205,416,628,710,202,211,234,251,470,609,616,394,459,482,464,479,472,677,371,354,382,417,532,582,790,264,759,694,253,427,785,1054,259,288,336,402,557,751,751,275,352,413,539,604,675,708,211,244,208,227,400,499,690,244,1272,230,277,474,676,731,210,217,152,211,445,604,758,281,180,299,270,526,711,672,256,269,276,285,396,592,719,210,245,260,338,447,637,848,281,250,331,325,445,652,694,405,325,308,377,392,674,713,470,422,389,418,456,518,710,384,312,319,530,560,660,669,436,408,449,419,494,535,695,301,310,337,320,451,504,695,280,368,335,357,479,627,713,293,320,367,367,371,523,648,178,158,158,232,367,511,728,197,177,194,191,314,534,610,164,187,165,227,387,592,507,589,104,219,171,265,501,666,150,231,221,229,313,502,781,182,184,131,205,356,577,674,186,145,177,164,314,568,554,178,194,172,235,352,496,646,205,162,167,176,317,554,589,127,151,208,237,328,527,588,151,186,172,202,333,490,621,213,195,229,239,679,901,902,747,178,216,219,33,471,536,186,153,201,242,385,553,635,243,222,152,206,407,579,770,274,314,293,459,389,731,870,364,403,439,536,611,790,966,779,276,457,593,531,586,745,585,255,411,473,422,491,651,302,276,211,224,341,541,599,157,185,202,249,269,546,596,244,195,177,252,300,482,621,186,201,185,268,392,563,486,378,161,141,169,302,392,537,191,173,170,206,634,611,663,187,177,187,210,379,584,628,193,173,173,210,392,716,604,181,129,194,124,363,527,608,241,130,158,239,386,552,481,369,173,170,136,178,153,242,77,110,86,85,110,158,159,85,92,75,81,52,121,153,32,57,49,61,76],[1187,1271,1411,1556,1107,1016,1200,1139,1180,1190,1281,1284,913,864,849,956,1025,1164,1222,756,765,779,851,973,1041,1127,464,443,493,609,807,994,1068,422,434,448,456,767,1081,1058,395,400,413,409,603,864,1042,315,293,380,507,771,617,998,351,285,370,379,539,904,950,299,297,307,378,714,935,972,345,309,247,340,590,915,1007,304,310,329,298,649,1010,922,330,346,323,375,555,892,971,321,292,264,360,557,713,830,272,298,372,442,849,813,884,249,99,239,210,502,739,944,31,260,296,380,804,1016,1099,971,251,225,260,527,737,963,287,313,286,323,601,905,969,347,328,379,374,565,1079,894,379,409,610,444,685,1220,1267,843,808,1035,1115,1142,1384,1412,575,939,1017,1028,1031,1137,1284,563,892,1067,816,844,964,1026,584,510,589,564,686,973,922,482,457,564,558,773,850,1103,521,390,436,576,736,775,994,457,487,512,510,648,839,953,841,405,444,481,553,822,792,361,296,324,744,685,811,890,445,343,419,491,649,698,937,412,358,486,497,719,807,1017,339,395,419,410,587,753,941,383,323,415,485,555,884,1002,713,308,391,461,587,770,872,390,312,411,368,604,793,841,389,371,454,437,621,780,903,391,391,436,459,730,878,873,632,673,709,731,747,752,952,630,626,596,695,801,860,1053,474,988,956,520,638,1086,1339,489,529,565,618,785,961,1035,520,548,635,817,925,924,996,488,463,410,516,618,693,854,459,1440,435,523,714,852,1018,436,376,345,423,666,784,984,475,385,538,496,728,888,912,500,473,506,515,588,804,927,491,440,509,581,715,882,982,501,445,561,580,660,961,1004,640,540,659,634,676,900,1005,711,663,699,696,663,721,999,648,544,615,883,753,904,996,697,646,729,686,772,776,1043,519,550,582,569,720,712,1048,507,557,571,633,726,882,958,489,583,654,575,648,811,908,424,354,366,468,621,749,991,388,326,325,426,523,745,835,344,375,301,454,642,806,697,823,331,404,415,464,713,857,304,404,410,453,504,741,978,386,370,311,425,551,798,862,340,321,374,328,505,758,747,334,390,332,427,528,708,913,390,334,362,414,541,739,870,376,369,493,514,548,713,859,321,406,432,444,573,702,973,404,409,485,480,962,1121,1169,1008,476,462,444,260,713,836,338,352,377,470,604,768,908,404,438,337,465,574,810,1024,449,523,542,681,602,967,1086,611,637,704,779,845,1158,1193,970,403,690,903,773,918,1018,842,444,775,832,689,788,1113,552,534,468,431,601,790,847,373,392,457,507,489,762,841,402,392,395,487,494,730,843,388,418,401,475,658,767,686,656,455,348,391,531,545,748,349,383,401,455,822,795,929,344,377,381,464,599,786,882,385,369,405,463,601,921,804,364,320,397,325,592,694,822,440,325,405,475,611,683,723,579,333,332,335,296,267,385,142,205,157,162,174,236,179,133,129,127,117,76,148,198,32,57,49,61,76],[24,19,53,25,26,31,15,22,16,29,44,37,12,32,23,32,20,40,38,12,23,18,19,27,21,28,10,19,21,20,24,25,39,20,11,6,14,30,46,45,30,13,5,36,23,42,46,12,9,13,16,33,23,33,13,20,13,14,19,29,40,5,12,18,12,36,45,42,16,18,7,14,31,61,43,15,13,7,14,9,26,26,16,6,14,20,24,24,26,3,15,20,12,29,25,30,7,16,25,20,29,26,29,8,7,8,5,16,45,47,12,3,5,17,19,33,52,44,5,6,14,23,14,44,4,4,7,16,16,15,42,19,13,22,23,12,2,11,4,9,10,25,16,30,28,17,15,31,30,21,19,33,11,26,23,16,14,25,28,11,7,5,18,18,19,18,7,3,7,5,13,15,16,4,4,7,9,18,22,22,1,7,10,9,6,20,18,5,11,8,12,11,11,24,11,9,15,7,11,18,13,6,10,1,17,14,28,16,2,3,11,5,6,13,11,1,5,6,9,19,21,11,2,6,3,3,6,18,17,1,4,1,4,13,9,20,20,1,4,5,12,26,31,7,9,4,2,13,18,16,3,4,2,7,12,23,24,4,3,4,2,12,14,19,7,13,13,16,11,22,10,9,2,13,11,9,10,19,3,9,8,4,12,28,4,1,7,6,6,8,17,12,10,5,3,5,25,29,24,2,2,4,4,8,10,13,4,9,6,6,14,11,11,1,4,3,4,19,16,16,10,1,9,4,23,23,15,5,5,10,9,11,23,25,7,4,2,8,11,7,28,2,5,8,9,16,19,28,9,3,11,8,10,16,27,11,13,12,4,11,15,17,15,7,14,15,18,33,34,12,14,18,13,24,24,33,11,21,10,9,19,13,27,5,14,11,15,9,33,26,4,8,8,20,8,15,16,2,1,2,7,21,16,19,12,4,3,4,10,13,16,5,5,4,3,9,20,7,14,3,17,5,8,17,16,1,9,7,5,10,18,21,2,10,3,16,10,8,18,7,2,5,8,11,13,18,11,7,1,4,11,11,17,9,5,5,6,15,29,31,5,2,7,8,6,12,15,5,8,9,5,7,23,14,16,4,3,10,24,32,32,15,7,6,6,8,15,17,8,8,4,4,9,23,20,5,8,5,10,8,14,25,8,17,14,27,9,27,13,16,13,11,21,12,35,41,19,12,14,12,10,14,21,12,11,20,25,16,11,24,3,11,10,2,14,23,30,9,11,3,11,5,27,23,8,6,7,10,9,14,16,6,10,7,14,30,28,13,6,5,6,5,13,16,15,16,6,8,8,9,21,39,4,11,6,9,11,20,12,6,15,4,1,22,39,24,3,null,18,7,4,26,22,14,7,6,6,17,23,15,10,9,1,2,2,6,8,1,16,2,4,8,6,7,9,3,2,null,null,1,null,null,null,1,1,1],[24,19,53,25,26,31,15,22,16,29,44,37,12,32,23,32,20,40,38,12,23,18,19,27,21,28,10,19,21,20,24,25,39,20,11,6,14,30,46,45,30,13,5,36,23,42,46,12,9,13,16,33,23,33,13,20,13,14,19,29,40,5,12,18,12,36,45,42,16,18,7,14,31,61,43,15,13,7,14,9,26,26,16,6,14,20,24,24,26,3,15,20,12,29,25,30,7,16,25,20,29,26,29,8,7,8,5,16,45,47,12,3,5,17,19,33,52,44,5,6,14,23,14,44,4,4,7,16,16,15,42,19,13,22,23,12,2,11,4,9,10,25,17,36,39,18,21,33,36,42,25,44,18,30,24,24,15,29,39,14,10,11,28,28,28,24,12,10,14,10,18,17,25,6,6,18,21,21,23,27,7,10,17,20,16,27,27,10,22,12,21,17,25,36,17,15,23,32,19,31,19,9,12,7,29,16,35,23,15,25,36,21,26,29,16,9,11,17,19,23,35,17,10,17,21,12,11,40,37,9,8,10,9,19,26,36,22,13,19,24,15,49,38,15,16,17,16,40,28,26,7,12,24,20,28,31,33,10,10,12,10,25,19,34,14,30,26,23,20,40,22,14,10,29,29,14,22,28,9,11,14,16,19,35,9,3,15,19,14,25,31,21,15,16,15,15,41,41,40,12,11,23,26,22,23,17,18,17,19,19,22,16,19,14,10,12,27,22,26,18,17,16,19,15,44,29,22,15,21,31,23,14,31,30,24,9,12,21,24,21,37,19,11,17,40,34,48,53,19,13,22,18,33,33,35,21,30,25,19,16,28,35,26,26,36,27,26,45,41,18,15,27,34,35,31,52,19,34,13,19,34,25,49,13,19,37,34,15,42,39,10,22,23,26,35,33,28,6,16,9,33,34,29,32,14,15,8,24,31,27,34,18,28,13,14,31,39,13,28,35,21,18,18,42,25,11,22,34,26,19,26,27,32,35,15,28,15,23,45,18,23,25,17,30,21,24,22,20,6,15,23,22,28,15,20,33,16,28,38,49,25,40,19,23,22,21,23,18,20,35,29,24,34,33,18,7,16,18,43,50,57,32,18,23,11,28,34,33,18,19,18,16,20,31,41,7,19,24,25,14,33,37,16,23,31,42,16,39,34,28,22,21,31,27,50,62,27,18,24,25,22,36,32,27,14,41,40,32,21,73,9,22,27,10,26,33,44,22,22,16,68,12,44,42,17,15,29,19,19,31,33,17,26,28,22,83,39,24,23,27,13,21,33,24,24,16,22,35,23,26,36,62,15,25,8,39,23,35,25,16,28,21,22,50,62,40,9,10,27,18,16,43,34,18,22,24,14,26,30,37,24,18,19,10,8,7,29,4,19,9,7,10,18,9,14,6,4,4,1,10,1,0,0,1,1,1],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,34,28,31,38,24,34,53,49,31,39,39,30,36,36,38,26,35,29,44,21,28,21,22,38,40,32,28,36,11,26,19,31,34,33,31,47,32,20,37,22,28,17,33,20,40,28,33,33,44,30,23,24,30,37,33,36,28,18,18,33,23,37,28,16,38,24,30,37,31,54,24,25,30,37,34,29,45,13,25,27,36,34,38,26,17,28,29,41,25,32,44,27,22,18,21,21,24,25,16,10,29,29,16,14,31,10,26,21,18,10,7,16,10,20,21,25,25,18,31,26,39,21,24,24,16,21,15,40,27,19,16,24,38,22,18,21,35,16,22,2,15,26,18,16,16,15,15,18,47,18,19,22,26,36,33,35,23,12,14,18,12,20,18,20,19,23,35,33,20,18,19,18,10,23,20,23,31,23,16,9,18,24,22,17,25,21,42,21,43,31,20,18,19,21,20,42,23,40,18,19,17,17,41,5,20,16,46,18,17,44,27,25,29,46,8,28,25,25,20,19,35,24,9,20,24,38,23,11,25,22,23,24,12,13,21,17,20,18,19,17,12,30,25,18,16,22,23,22,9,13,36,27,13,19,28,29,35,20,29,20,22,12,16,14,17,33,17,16,15,16,22,13,31,10,29,12,16,21,23,29,29,17,20,14,17,14,47,26,8,25,28,21,15,24,14,11,14,15,6,11,12,14,8,21,9,16,15,20,24,22,16,21,32,14,27,43,17,23,23,18,22,31,24,16,13,23,26,23,18,33,17,18,23,20,16,25,32,25,26,17,26,13,36,12,12,15,20,22,19,11,20,25,15,20,20,12,32,15,17,26,33,30,16,27,20,16,10,44,33,26,28,28,19,13,32,28,26,33,35,37,20,31,20,17,32,33,13,21,13,25,30,25,21,15,15,10,17,12,21,29,21,11,24,22,25,29,27,30,10,20,16,19,27,15,23,10,7,17,13,14,14,6,9,10,20,18,29,16,13,15,20,22,20,31,27,20,14,13,22,12,35,20,9,7,14,6,17,19,14,9,9,26,26,8,22,21,30,9,5,22,10,17,15,4,7,4,6,4,7,1,5,2,5,2,0,0,0,0,0,0,1,0],[37097.11,0,0,0,0,0,30703,46518.5,61989.5,55168.5,62553,63109.5,43303,36327,40363.5,45553.5,48511.5,63726,74548,33005.5,36495.5,37357.5,39977,29963,56988.5,65180.5,20000,24065.5,26339.5,31853,36211,55286,58098,21724.5,23989.5,22006.5,22719.5,34059,55333,57608.5,23574,16717,15769,21018,33969,42226.5,51754,16656.5,12362,17587.5,29381,37697.5,32773,58700.5,19896,18391.5,17913,17607,25541.5,56463.5,47059.5,18617.5,14897,14507,19383,33517.5,46798.5,51499,19546,14629.5,17294.5,15527.5,29337,45543.5,54007.5,18306.5,16739.5,17568.5,19616.5,33345,56159.5,51509,15985.5,19117,15975,21926,21481,49766.5,54457.5,13538,17891.5,14314.5,16306,33131,37137.5,52071,17814.5,15984.5,15020.5,24547.5,43623.5,49458,47094.5,12047,13887,9877,10602.5,25873.5,35783,59334.5,13689,13771.5,13172,22075,44031,50414.5,61702.5,61170.5,10507,0,15037.5,25420.2,34402.5,55468,13572.5,13763.2,14105.5,19880.5,30504,51164.5,53224.5,17021.5,13266,23315.5,21758,25559.5,59353,50225,20732,19138,37435,23029.5,26850.5,46997,54334.5,27678,32016,33823,41600,42059,51965,56941,26719.5,33545.5,39227,32024,38144.5,48302.5,63791,21220.5,28489.5,35172,25893.5,25866,36924.5,38731.5,17349,13771,13215.91,17588,17453.5,42603,37328.5,10395,15045,15728.5,13135,32475.6,32724.5,42126.5,10430,12574,12162.5,14090.5,22184.5,30825,37274,9400.1,11079.5,11665.5,13818.5,19683.5,37371,36552,34673,8850,12270.5,12598.5,19268,33592,31126,7132.5,8524,8798.5,26802.5,25749.5,39732,41021.5,8100,9353,7871,12114.5,16907,26595.5,35346.5,9273,11304,8909.5,15094.01,21861,33235.5,44530.0099999999,10384,5819,9247.559999999999,12400,19253.5,25587,42790.5,10208.5,12601,6417,14247.5,15531,31251,45907,27295,8824,8248,17456,20890,30796,38817,13762,11493,10287.5,9813.5,18625,36851.5,35160,9259,10877.5,11353,13386,19164.5,32452,40472.5,12640,10876,10502,12635,22585,33430,38895.5,24039.5,30365.5,36655,28425,22776.5,30814,46339.5,21154.5,15029.5,16583,20828,21716.5,36811,41373,12530,52846,43131.5,12087.5,15801,39167,45054,11538,9446,13581.5,12567.5,24812,32152,40316.5,20547.5,23932,23044.5,19888.5,38091,29102.5,55005.5,10677.5,13207.5,9879,14004,27635.5,31562.5,48906,20792.5,56569.55,23832,14095.47,25188,46830,47187,14486,52607.5,8175.5,13830,56575,40004.5,51554.5,19776.5,12459,18359.5,11180,31284.5,45016,37288.5,15403.5,12174,13226,17636.5,24112.5,36047.5,50357.5,12872.5,14003,13078.5,22034,27387,40518,54634.5,18763,13300.5,16485,15357,30513.5,47111,38861.5,24868.5,63064,20919.5,19724,26960.5,46228,48816.5,31784,35251,26821.5,22016,25375.5,29763,48540.5,27267,39324,38307,58517,33974,40735.5,45766,37764,52052,24981.5,21738,60212.33,31190,44163,18294,40382,17529,42981.5,23324.5,9246.51,43236,18504.5,36188.5,15414,24666,29962.5,83268,52715.5,18891.5,48041,22528.5,19841,23523,30944.5,36532,9551.5,19429.5,158904,13070,21146.5,32848,45853,11196,25391.5,9391,11054.5,45234.5,32489,37757,30207,22073.5,11076,12316.5,25596.5,36929,36273,32611.5,6399,9828,10962.5,29646.5,68434,41019,21549,36885.5,11890.5,10891.5,20944.5,32252.5,59416,11313,13904.5,23438,33001,48622.5,42535,96674,28276.5,10082.5,9772.200000000001,23149,17695.5,34243,83749,11121.5,27290.5,10063.5,13938,17045.5,29685.5,46075.5,13085.5,12184,10089,13981.5,21777,39239,44433.5,5246,9780.5,16171.5,39288.5,40742.5,36882,47258,25330.5,27955,9996,10604,16973.5,35128,52554,17076.5,12679.3,13672.5,14606.5,44969,59513,67994.5,58894,22579,11551.81,13605,15867,29478.5,42926,13376,8169,12571,13122.5,20078.5,42691.5,42085,13314,16139,8977,12615,34734.5,36263,56228,15551,23181,24444.25,33584.5,24979.5,52336.5,66829,25626,28976.75,27632,35461,41299.5,53573,65839.5,54953,20924,26013,41346.5,38857,35839,55512,38157.5,18167,29222,32239.5,28070.5,35428,39424,23367.5,16956,13563.5,11615,23235,30494.5,37909.5,9251.5,14369,15196,15204,17208.5,31225,38920.5,12785,12655,12622.8,13671.75,15266.5,26957,48419.5,8494.5,10592.5,12929,16621,18618,34891.5,32186,28308.5,7573.5,10140.5,8745,17997.5,23540,33204.5,10849.5,9185,12085.4,13881.5,33016.7,35399.6,46730,15014.53,14698.5,10262,13903.4,23250.5,34342.8,44437.5,13452.6,9874,8323.5,13171.2,30244.9,41948.5,38320.2,12626,7880,12424.5,7722,18837,39206.5,46955.5,16345,7822,9969.5,14308.5,28680.5,31115.5,30145.5,24761,12439,9662.4,12681,9181,8917.6,12431,3146.5,8381,4864,3654,11031.5,10940,11330,6639.4,5773,4759,3773.2,3048,1731,5754,704,2995.5,2517.5,4920,1584.2],[37097.11,0,0,0,0,0,30703,46518.5,61989.5,55168.5,62553,63109.5,43303,36327,40363.5,45553.5,48511.5,63726,74548,33005.5,36495.5,37357.5,39977,29963,56988.5,65180.5,20000,24065.5,26339.5,31853,36211,55286,58098,21724.5,23989.5,22006.5,22719.5,34059,55333,57608.5,23574,16717,15769,21018,33969,42226.5,51754,16656.5,12362,17587.5,29381,37697.5,32773,58700.5,19896,18391.5,17913,17607,25541.5,56463.5,47059.5,18617.5,14897,14507,19383,33517.5,46798.5,51499,19546,14629.5,17294.5,15527.5,29337,45543.5,54007.5,18306.5,16739.5,17568.5,19616.5,33345,56159.5,51509,15985.5,19117,15975,21926,21481,49766.5,54457.5,13538,17891.5,14314.5,16306,33131,37137.5,52071,17814.5,15984.5,15020.5,24547.5,43623.5,49458,47094.5,12047,13887,9877,10602.5,25873.5,35783,59334.5,13689,13771.5,13172,22075,44031,50414.5,61702.5,61170.5,10507,0,15037.5,25420.2,34402.5,55468,13572.5,13763.2,14105.5,19880.5,30504,51164.5,53224.5,17021.5,13266,23315.5,21758,25559.5,59353,50225,20732,19138,37435,23029.5,31153,61031,65410,40088,42192,46415.5,56639,54420,67268.5,67885,31785,43685.5,52064.5,44263,47999,61926,80634.5,38672,50846,65393,43607.5,45170.5,52088,59619,33676,28669,26149.41,33032,33050,53449,51065.5,20172.5,22166.5,27938,28909.5,47362.1,40166,54690,23080,20291.5,20982,30601.5,39964,37730,48814,23925.6,22796.5,27872.5,24782,32401.5,47817,46924.5,47316,19823,21447.5,24826,30606,40713,40928,14021,15668,17406,40510,36951.5,46459.5,52919,23870,17309.5,19877,26045.5,34837.5,33333,48566,20193.5,17221.5,21147.5,25759.01,32302.5,41433,57874.0099999999,18348,16602,20300.56,22018,27511,34420,58648.5,21929.5,19370.5,18109,28486.5,29576.5,39433.5,60493,40740.5,17141.5,18285.5,29224.5,33451.5,41986.5,51932,25969,19180.5,20643.5,24059.5,34143,48021.5,50031,21435,20056.5,24938,30815,35092,38428,52873.5,23004,18640,22893.5,26472.5,40404,44958,53774,40019,42144.5,44037,45763,40736.5,45565.5,70658,37833,35585,32127.5,39367,42729,53928,61570.5,26107,66028,58269.5,25632,28206,60602,66587,28745,23975.5,28191.5,26597,38792,45445.5,61236,34905.5,34548,34315,32539.5,58519,43093.5,74788.5,25766.5,26224,23833,38475.5,40754.5,42575,59011,34800.5,67050.55,35104.5,31628.47,35858.51,51349,64714,28519,62756,20862,28553,70244.5,49975,64789,31061.5,23842,35921.5,26502,48427,54604,54091.5,38855.5,24763,26924.5,35880.5,38554.5,49636,61940,38818.5,25373,31450,44628,42672.5,56043.5,76509.5,33635,24495.5,31437,31242.5,45153.5,65488,61210,39907.5,80668.5,43571,36557.5,44269.5,58257.5,73901.5,49131,51115.5,58938.5,41412,36729.5,43420,65220.5,41143,57285,56031,83711.5,48529,56729.5,71351,54253.5,66810,43361.5,41437.5,75803.33,48189,69307,18987,53813,32713,59269.5,42425,13331.51,65670,30215.5,47438.5,29370.5,43535.5,50943.5,97550,71552.5,32005.5,62632.5,43201,34358.5,42921.5,49641,57521,19745.5,29626,173412.5,25758,38719.5,50221,60868,24893,34850.5,20093,25100.5,61379.5,44833,54910,40463,35189.5,24214,28852.5,42341.5,46870,52199,50434.5,25087,21670.5,27163.5,44409.5,82668,56492,28288,47284.02,21756.5,23574.5,45429.5,46692.5,72770,24597,23652,35161,54511,62422.5,54893,106739,37367.5,22672,23082.2,34125,35106.5,44294,97317,25086,39042.5,20301.5,28528,29298.5,47538.5,65287.5,23613.5,26218,24195.5,28533,44150,56233.5,68465.5,22639,11941.5,58221.5,58058.5,59073,51157,64630,38954.5,45420,27398,25821,36527.5,51360,79966.5,29699,27033.8,30546.5,37622,65266,77005,83428.5,82971,48854,29976.81,28653,31279.5,44326.5,67750.5,28125,24886.5,23204.5,29552.5,41685.5,55784,60289,23528,29875,19616,30226,48009,50259,73710,26936,38189,40506.25,48897.5,40781.5,66813,83753,44647.5,42695.25,49064,50438.5,52545.5,79854,79679,67320.5,29597,41708.5,64199.3799999999,54879,60028,76558,54056,33891,50918.2,59048.5,45812.5,61787,71567,42013.5,37593.5,31784.5,23830.5,36696.5,41556.5,56111,21676.5,28548,38855,31143,29409,45553.5,62818.5,18997,27032,21610.3,28230.25,31669,40745,63303,20790.72,23449.5,28653.5,29077,33872,49070.55,48106.5,46324.5,24136.5,20587.5,20947,33680.5,34834,44032,19952.5,19274,26396.6,29885,44508.7,46641.62,65837,21999.03,27709.5,23719,30219.4,40794,48149.8,58881.5,27551.6,19001,25294.5,33977.7,44366.9,53857.5,54777.7,16657,21005.5,30725.5,17331.2,37063,46959.1,64145.5,32671,22162.99,24629,28050.1,46188,38637.5,44035,38833,25006,18826.4,26141.7,16591.5,16206.1,26372.5,6933.5,15481.5,9340,10818,14598,16919.5,13053,11077.9,9256,8907,6282.2,6026,2053,9240,704,2995.5,2517.5,4920,1584.2],[480,480,480,480,480,480,480,357.02,440.05,464.03,449.95,390.37,348.27,311.28,342,423.88,508.22,482.4,457.42,315.6,337.22,387.32,451.25,518.15,540.72,422.95,335.5,436.65,266.97,326.57,408.98,391.77,410.25,292.68,332.12,241.8,281.15,392.43,378.78,356.68,297.95,269.45,259.73,227.02,343.17,347.15,352.35,230.45,243.08,220.42,225.85,349.44,331.67,305.92,248.44,226.3,200.52,246.97,380.22,357.6,326.99,231.02,235.55,183.02,222.61,342.55,299.49,292.9,180.52,225.92,218.7,183.01,304.21,297.18,287.25,222.63,211.5,236.67,188.47,375.97,327.93,313.7,206.2,197.26,192.48,209.83,338.15,292.94,297.76,181.73,188.53,159.51,179.99,275.86,287.6,270.86,175.16,194.97,175.8,206.71,290.7,323.31,302.84,196.48,211.07,198.16,183.27,272.82,285.4,321.65,233.5,237.42,225.02,240.65,303.96,355.52,462.68,203.73,314.19,326.35,326.38,391.49,419.11,443.2,192.39,339.06,341.5,361.86,489.84,364.96,460.5,292.83,387.26,392.77,400.41,458.64,578.8200000000001,502.85,341.38,298.43,339.81,265.54,261.55,385.23,280.09,247.89,234.6,285.7,318.01,385.08,400.81,472.56,233.67,368.49,243,280.62,383.07,398.65,380.59,231.5,267.42,197.2,229.47,306.49,299.37,314.15,241.54,228.81,218.23,241.41,281.99,289.46,285.92,196.75,215.3,215.28,207.07,273.64,304.15,278.92,195.87,208.34,179.43,207.2,255.35,291.34,273.3,192.65,194.97,258.07,216,272.42,284.19,277.34,201.78,186.12,193.15,221.47,222.25,269.13,253.74,138.7,184.8,207.11,255.97,243.7,248.65,237.62,140.45,115.28,145.22,173.15,195.23,242.92,266.07,154.6,104.18,126.67,136.18,210.81,287.96,240.76,165.79,117.14,141.3,121.67,197.54,240.56,247.3,114.15,120.65,110.43,138.69,237.45,250.88,243.77,148.07,166.27,118.95,162.73,224.12,289.86,212.28,148.3,130.93,132.84,139.49,184.53,212.79,221.55,156.02,129.53,136.92,139.53,176.2,213.05,120,146.18,181.42,135.69,134.8,188.04,220.76,200.78,185.81,158.17,227.96,212,218.94,217.21,204.19,165.3,123.86,160.58,129.23,205.86,206.77,172.92,172.24,263.93,164.65,172.04,234.28,311.72,280.36,240.84,233.47,263.01,279.34,279.7,320.69,303.92,236.74,226.07,224.74,199.15,324.65,339.95,291.88,178.07,246.85,210.46,218.01,325.46,317.38,291.49,172.4,353.25,216.19,243.87,297.57,286.85,290.9,195.8,199.9,227.49,255.12,273.02,295.5,264.28,179.51,187.46,207.54,209.36,256.92,263.47,268.12,207.42,229.05,259.94,259.66,281.91,303.35,303.25,210.3,229.44,216.36,211.13,289.88,311.92,282.38,242.23,218.96,175.13,228.38,265.73,251.86,236.47,138,158.42,163.1,168.2,280.2,219.43,246.42,213.71,221.29,251.29,272.15,330.34,327.82,312.42,234.44,184,238.24,359.27,281.67,295.18,264.94,193.99,176.44,217.7,240.12,254.08,242.74,262.22,174.68,207.39,207.51,291.48,352.12,258.34,218.67,157.29,169.33,193.61,159.49,264.72,245.94,239.62,176.03,159.05,166.14,199.67,201.75,202.22,223.31,156.61,150.03,157.51,144.1,164.19,199.78,212.89,148.85,136.55,131.23,151.52,200.37,219.76,199.84,159.3,139.26,147.12,207.18,272.44,276.88,236.7,237.66,130.56,181.73,180.8,241.8,275.82,267.81,161.44,152.46,162.74,171.98,238.06,271.93,266.93,175.02,165.68,153.8,171.11,233.15,253.39,277.38,166.43,163.92,135.97,179.16,231.71,251.5,251.1,161.75,154.96,133.75,184.43,219.55,219.71,250.08,150.01,143.81,120.04,144.58,211.88,235.18,229.64,156.08,160.15,154.55,155.09,184.71,209.46,228.16,171.02,135.79,134.63,126.53,223.75,232.1,216.04,163.2,151.44,134.72,144.01,237.05,286.24,302.55,259.01,138.89,126.94,102.12,180.08,172.81,151.53,134.77,94.89,154.49,191.18,210.25,228.03,249,179.15,154.36,162.39,152.14,232.36,276.81,264.98,176.47,179.48,212.95,220.47,257.49,280.97,261.9,177.52,202.4,207.49,286.17,305.11,310.07,293.73,230.9,225.3,290.78,437.91,304.57,301.39,316.64,256.5,190.42,260.54,251.58,324.6,303.77,283.79,249.81,99.90000000000001,225.76,239.85,323.35,312.57,289.58,222.65,209.15,198.06,219.61,240.44,236.71,248.09,178.38,164.53,185.49,196.96,245,259.65,242.94,159.47,155.83,153.19,177.74,200.5,236.73,249.55,181,123.16,106.84,158.29,196.82,216.1,214.1,163.3,146.6,150.38,154.88,216.56,220.68,202.93,154.08,164.01,197.92,206.9,244.7,235.7,230.33,168.55,149.59,234.36,153.41,251.2,266.79,242.03,199.22,127.06,172,156.1,238.27,253.55,277.71,148.73,166.6,166.08,184.27,221.83,225.22,243.6,180.57,125.93,129.97,155.2,220,156.85,156.62,90.17,92.11,83.7,87.33,51.15,61.9,61.6,51.2,55.97,49.75,48.7,51.95,69.28,57.11,62,75.92,55.15,61.1,65.63],[480,480,480,480,480,480,480,357.02,440.05,464.03,449.95,390.37,348.27,311.28,342,423.88,508.22,482.4,457.42,315.6,337.22,387.32,451.25,518.15,540.72,422.95,335.5,436.65,266.97,326.57,408.98,391.77,410.25,292.68,332.12,241.8,281.15,392.43,378.78,356.68,297.95,269.45,259.73,227.02,343.17,347.15,352.35,230.45,243.08,220.42,225.85,349.44,331.67,305.92,248.44,226.3,200.52,246.97,380.22,357.6,326.99,231.02,235.55,183.02,222.61,342.55,299.49,292.9,180.52,225.92,218.7,183.01,304.21,297.18,287.25,222.63,211.5,236.67,188.47,375.97,327.93,313.7,206.2,197.26,192.48,209.83,338.15,292.94,297.76,181.73,188.53,159.51,179.99,275.86,287.6,270.86,175.16,194.97,175.8,206.71,290.7,323.31,302.84,196.48,211.07,198.16,183.27,272.82,285.4,321.65,233.5,237.42,225.02,240.65,303.96,355.52,462.68,203.73,314.19,326.35,326.38,391.49,419.11,443.2,192.39,339.06,341.5,361.86,489.84,364.96,460.5,292.83,387.26,392.77,400.41,458.64,578.8200000000001,502.85,341.38,298.43,339.81,265.54,410.1,719.73,585.09,465.89,476.18,504.05,525.0599999999999,680.65,642.35,664.26,375.43,538.05,535.88,548.49,587.96,638.84,600.3,393.84,434.16,420.63,472.93,534.26,509.67,563.05,442.26,415.67,417.4,431.24,561.2,482.68,498.72,397.27,405.3,418.16,399.07,485.04,513.1,477.29,389.6,396.29,381.06,418.53,420.28,478.2,474.71,359.13,354.58,430.15,415.76,458.48,456.93,446.36,390.48,374.94,393.55,399.09,395.06,430.5,407.47,314.64,330.71,399.03,446.31,398.98,412.27,397.37,308,285.92,286.77,360.35,361.28,398.89,378.04,312.57,238.37,279.51,284.06,375.26,426.67,375.32,326.93,263.49,297.74,282.34,361.68,358.18,369.33,254.61,284.22,255.27,272.59,360.25,386.6,368.47,295.82,306.8,267.27,322.97,389.86,437.94,345.99,287.08,252.61,319.5,294.76,347.88,359.79,370.15,308.38,260.15,309.92,288.99,310.9,341.44,262.77,290.53,336.91,283.09,261.84,336.67,351.3,332.28,332.25,283.84,370.73,357.03,357.34,365.8,333.54,300.03,266.13,304.14,282.84,362.55,361.11,318.97,316.37,418.6,317.1,326.37,390.31,438.62,428.86,381.02,376.09,408.93,420.11,433.32,469.05,440.24,382.73,377.41,377.52,367.88,467.2,477.5,441.71,310.68,400.02,356.68,370.11,466.87,443.26,403.17,308.85,498.72,356.59,390.67,460.34,427.5,431.82,339.55,345.2,355.16,399.8,437.34,454.8,411.07,330.71,325.99,351.3,341.51,398.86,384.54,405.19,336.84,374.27,387.69,395.81,439.12,459.11,448.39,361.7,387.16,343.52,379.28,451.3,462,438.22,384.47,378.15,330.23,388.48,410.46,406.66,378.77,294.17,333.79,333.35,331.35,474.1,378.6,396.96,379.5,393.91,407.19,423.48,489.88,469.2,465.69,389.69,336.84,405,519.15,444.46,453.43,442.26,365.36,354.99,392.21,413.54,427.5,406.84,417.13,318.97,377.76,364.26,441.76,499.36,415.29,356.36,301.41,325.32,346.09,314.25,435.31,415.59,404.97,342.76,338.07,327.25,354.21,381.68,373.4,382.47,313.48,309.18,308.97,318.23,340.22,360.44,383.07,323.12,317.62,297.98,314.65,371.81,381.37,357.84,323.15,295.7,301.22,392.75,438.77,444.37,410.28,409.93,304.48,334.18,344.16,397.97,416.71,437.66,317.86,315.46,313.96,329.53,390.29,436.82,423.73,335.77,342.73,316.36,335.5,395.95,420.09,437.74,340.93,301.41,290.66,338.89,403.49,415.24,398.68,296.55,294.53,295.02,337,369.56,378.53,411.34,298.56,300.1,269.77,298.87,369.88,366.86,377.63,308.44,322.37,328.13,313.8,361.5,369.21,390.45,329.38,304.73,302.17,293.67,390.61,395.03,387.41,320.66,305.86,284.11,321.4,432.6,429.74,451.33,438.94,300.59,265.16,243.23,355.46,319.68,316.76,314.92,256.07,318.83,368.95,399.5,380.08,426.8,358.41,328.88,332.06,313.8,416.44,421.37,410.63,328.21,359.7,369.75,384.46,425.22,437.42,419.89,329.2,365.55,372.31,446.65,465.58,491.09,465.85,231.9,303.58,459.68,587.23,497.15,466.79,483.76,447.95,322.87,392.32,407.91,500.53,443.76,438.15,400.58,233.85,350.01,368.72,487.04,468.05,437.24,366.7,357.01,329.74,363.61,390.1,372.05,390.68,342.13,304.32,333.34,342.28,415.38,415.42,397.52,328.01,328.8,310.02,340.85,349.1,381.29,395.21,365.9,278.82,262.22,347.71,364.67,344.03,378.93,311.57,300.75,294.72,304.3,365.58,352.68,338.93,324.87,333.59,354.03,346.77,433.9,421.35,372.32,314.72,314.59,384.16,320.1,390.2,398.79,390.03,360.93,305.06,328,307.85,395.89,395.25,428.11,306.3,315.84,318.08,331.65,398.47,354.01,370.77,326.97,252.71,255.96,273.96,345.54,265.87,268.06,175.94,177.78,159.68,145.45,88.97,89.84999999999999,74.28,74.38,76.51000000000001,70.95,68.38,74.29000000000001,87.56999999999999,73.86,62,75.92,55.15,61.1,65.63]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Año<\/th>\n      <th>Mes<\/th>\n      <th>Semana<\/th>\n      <th>Dia<\/th>\n      <th>Fecha<\/th>\n      <th>Ventas<\/th>\n      <th>TotalVentas<\/th>\n      <th>Customers<\/th>\n      <th>Totalcustomers<\/th>\n      <th>CH_Promedio<\/th>\n      <th>TotalCH_Promedio<\/th>\n      <th>Burgers<\/th>\n      <th>TotalBurgers<\/th>\n      <th>Thickurgers<\/th>\n      <th>TotalThickburgers<\/th>\n      <th>Total_Burgers<\/th>\n      <th>T_Total_Burgers<\/th>\n      <th>Bebidas<\/th>\n      <th>Totalbebidas<\/th>\n      <th>Cervezas<\/th>\n      <th>Cafes<\/th>\n      <th>Totalcafes<\/th>\n      <th>Ventas_TPV<\/th>\n      <th>Total_Ventas_TPV<\/th>\n      <th>HR_Laborales<\/th>\n      <th>Total_HR_Laborales<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Año","targets":1},{"name":"Mes","targets":2},{"name":"Semana","targets":3},{"name":"Dia","targets":4},{"name":"Fecha","targets":5},{"name":"Ventas","targets":6},{"name":"TotalVentas","targets":7},{"name":"Customers","targets":8},{"name":"Totalcustomers","targets":9},{"name":"CH_Promedio","targets":10},{"name":"TotalCH_Promedio","targets":11},{"name":"Burgers","targets":12},{"name":"TotalBurgers","targets":13},{"name":"Thickurgers","targets":14},{"name":"TotalThickburgers","targets":15},{"name":"Total_Burgers","targets":16},{"name":"T_Total_Burgers","targets":17},{"name":"Bebidas","targets":18},{"name":"Totalbebidas","targets":19},{"name":"Cervezas","targets":20},{"name":"Cafes","targets":21},{"name":"Totalcafes","targets":22},{"name":"Ventas_TPV","targets":23},{"name":"Total_Ventas_TPV","targets":24},{"name":"HR_Laborales","targets":25},{"name":"Total_HR_Laborales","targets":26}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="dataframe-resultante-después-de-la-pandemia" class="level3" data-number="6.2.4">
<h3 data-number="6.2.4" class="anchored" data-anchor-id="dataframe-resultante-después-de-la-pandemia"><span class="header-section-number">6.2.4</span> DataFrame Resultante: Después de la pandemia</h3>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-42f28bedd83eba47558c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-42f28bedd83eba47558c">{"x":{"filter":"none","vertical":false,"data":[["743","744","745","746","747","748","749","750","751","752","753","754","755","756","757","758","759","760","761","762","763","764","765","766","767","768","769","770","771","772","773","774","775","776","777","778","779","780","781","782","783","784","785","786","787","788","789","790","791","792","793","794","795","796","797","798","799","800","801","802","803","804","805","806","807","808","809","810","811","812","813","814","815","816","817","818","819","820","821","822","823","824","825","826","827","828","829","830","831","832","833","834","835","836","837","838","839","840","841","842"],[2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020,2020],[8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11],[32,32,32,32,32,32,32,33,33,33,33,33,33,33,34,34,34,34,34,34,34,35,35,35,35,35,35,35,36,36,36,36,36,36,36,37,37,37,37,37,37,37,38,38,38,38,38,38,38,39,39,39,39,39,39,39,40,40,40,40,40,40,40,41,41,41,41,41,41,41,42,42,42,42,42,42,42,43,43,43,43,43,43,43,44,44,44,44,44,44,44,45,45,45,45,45,45,45,46,46],[2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3,4,5,6,7,1,2,3],[44046,44047,44048,44049,44050,44051,44052,44053,44054,44055,44056,44057,44058,44059,44060,44061,44062,44063,44064,44065,44066,44067,44068,44069,44070,44071,44072,44073,44074,44075,44076,44077,44078,44079,44080,44081,44082,44083,44084,44085,44086,44087,44088,44089,44090,44091,44092,44093,44094,44095,44096,44097,44098,44099,44100,44101,44102,44103,44104,44105,44106,44107,44108,44109,44110,44111,44112,44113,44114,44115,44116,44117,44118,44119,44120,44121,44122,44123,44124,44125,44126,44127,44128,44129,44130,44131,44132,44133,44134,44135,44136,44137,44138,44139,44140,44141,44142,44143,44144,44145],[44908.7,51733,57876.95,47554.6,67138.2,89172.7,113384.7,40974.6,48520.1,46649.15,40556.9,70159.10000000001,77736.8,107918.3,48885.8,48311.2,44658,63104.3,67481.3,89795.3,102744.9,34713.5,40403.4,47028.1,31703.55,59907.4,89533.39999999999,103271.2,47309.4,44723.4,44294.9,47556.95,62269.1,83662.7,95213.2,40803.6,38201,41846.7,42694.3,57266.2,94463.10000000001,106802.1,47822.4,39518.9,70982.60000000001,49385.9,55780.7,75692.10000000001,112426.8,30176.7,44740.3,30334.8,45527.3,48707.4,84596.3,80430.89999999999,27106.1,37465.5,45972.8,34305.9,64452.8,101466.5,105734.4,40305.5,43912.6,39382.9,32090.7,45907.9,77369.2,95743.3,37657,30514.4,36641.6,43593.7,65592.10000000001,81561.31,88480.60000000001,33020.2,41105.3,34048.6,40561.8,68919.89999999999,81373.5,104110.5,29893.9,31471.5,32237.6,43825.9,56852.3,73606,88208.60000000001,77298.60000000001,41889.1,33449.3,39682.5,66243.8,99547.89999999999,122397.2,54206.7,43766.5],[53887.7,69538,57876.95,57540.1,70025.2,99932.7,130996.7,47464.6,57037.1,52529.65,51963.4,81004.10000000001,89482.3,120988.3,59032.8,57724.7,46319,69302.8,76436.3,102998.8,118060.9,42455,53956.4,56991.1,45095.55,75201.89999999999,98554.39999999999,115973.2,59826.4,60170.9,52787.4,63568.45,77428.60000000001,92771.2,110376.7,53852.1,53889.5,52920.2,72448.3,76167.7,112820.1,130810.1,65661.89999999999,56866.9,85243.60000000001,64206.9,69450.2,92603.10000000001,137437.3,43009.7,60185.3,43852.3,70007.8,65140.9,99165.3,100332.9,42682.6,59100,54916.3,58083.4,69442.3,108323.5,123336.9,51482.5,55375.1,46257.4,49962.7,58966.4,86196.2,112179.8,49406.5,44438.9,51239.6,69136.2,89785.60000000001,92616.31,105767.6,52760.7,53293.3,47885.6,62221.8,86893.89999999999,89648.5,132293,45203.9,44397,46668.1,70376.89999999999,70894.8,82338.5,108350.1,92643.10000000001,59953.6,50800.3,66181,88910.3,117703.9,144733.7,75899.2,64795],[152,184,182,178,216,261,305,155,170,164,136,225,265,306,161,167,147,214,232,267,293,132,142,158,126,216,304,306,145,144,160,156,215,276,306,136,135,147,138,208,276,336,169,122,230,180,202,255,337,118,132,115,144,178,270,238,107,127,143,128,221,295,342,125,161,135,125,181,236,309,114,113,136,158,241,277,294,125,140,129,159,222,245,303,129,119,111,151,193,245,286,262,140,123,149,247,306,371,210,170],[196,243,182,224,228,307,373,188,210,199,189,268,317,365,217,212,153,251,283,323,356,167,200,192,190,282,339,369,195,223,192,230,283,327,375,196,216,197,252,307,349,437,245,192,289,256,276,325,425,175,202,166,250,258,276,333,185,220,189,237,254,325,411,170,222,174,210,246,283,381,169,173,199,265,341,329,360,219,192,176,255,305,286,429,204,190,156,269,261,288,383,322,227,200,258,345,389,464,304,260],[295.45197368421,281.157608695652,318.005219780219,267.160674157303,310.825,341.65785440613,371.753114754098,264.352258064516,285.412352941176,284.446036585365,298.2125,311.818222222222,293.346415094339,352.674183006535,303.63850931677,289.288622754491,303.795918367346,294.879906542056,290.867672413793,336.311985018726,350.66518771331,262.98106060606,284.530985915493,297.646202531645,251.615476190476,277.349074074074,294.517763157894,337.487581699346,326.271724137931,310.579166666666,276.843125,304.852243589743,289.623720930232,303.125724637681,311.154248366013,300.026470588235,282.97037037037,284.671428571428,309.378985507246,275.318269230769,342.257608695652,317.863392857142,282.972781065088,323.925409836065,308.62,274.366111111111,276.14207920792,296.831764705882,333.610682492581,255.734745762711,338.941666666666,263.780869565217,316.161805555555,273.637078651685,313.319629629629,337.944957983193,253.328037383177,295.003937007874,321.488111888111,268.01484375,291.641628959276,343.954237288135,309.164912280701,322.444,272.749068322981,291.725185185185,256.7256,253.634806629834,327.835593220339,309.848867313915,330.324561403508,270.038938053097,269.423529411764,275.909493670886,272.166390041493,294.445162454873,300.954421768707,264.161599999999,293.609285714285,263.942635658914,255.105660377358,310.45,332.136734693877,343.59900990099,231.735658914728,264.466386554621,290.428828828828,290.23774834437,294.571502590673,300.432653061224,308.421678321678,295.03282442748,299.207857142857,271.945528455284,266.325503355704,268.193522267206,325.319934640522,329.911590296495,258.127142857142,257.45],[249.760077751195,291.4686348563,159.00260989011,242.118380556912,275.704166666667,287.785448942195,315.376557377049,230.509462365591,249.168676470588,226.230161149825,256.714740566038,282.013762273902,259.61070754717,287.099803367674,242.417468944099,249.23875582169,290.31462585034,231.203466784542,233.227953853955,286.044385366506,296.888149412211,242.083387445887,259.101699854298,295.337807148175,230.432738095238,254.541961279461,276.130310150376,269.553314659197,288.305862068966,253.058570675105,271.116875,260.611932605682,256.278772229822,240.861881926684,265.457558965615,258.750735294118,238.327777777778,253.070714285714,285.189492753623,233.121255827505,296.861681060155,277.783181577086,258.851522111491,285.876990632318,275.16593220339,234.689634502924,230.432526090446,269.208739495798,308.910454882654,240.437548319952,279.792261904762,264.41494458653,273.554959381551,239.527914325843,1370.74314814814,273.719847412649,226.513377665947,263.816484632969,257.956012465795,243.078522792431,221.419299328123,286.260451977401,282.136803966437,285.410888888889,230.329452194277,233.997207977208,233.492211764705,227.267403314917,257.822051929318,269.066794768068,271.97591706539,251.056969026549,250.568907563024,257.312223470957,257.050695020747,253.520658150513,281.439332096474,237.083459574468,263.99695054945,279.173445489031,240.365330188679,263.502108433735,266.98300149328,283.634822410812,217.934496124031,223.257841164634,305.553303303303,257.623111460321,250.539427765925,251.757024205031,258.033004109293,275.387245547073,253.42289408867,248.641595396473,254.715503971429,249.742169296868,272.033461296165,285.044504825667,244.449209726443,245.55],[146,229,203,189,275,322,431,174,227,174,165,296,380,385,179,170,172,267,246,300,326,125,143,169,180,285,372,375,139,174,152,186,250,271,350,123,128,159,142,203,330,366,162,139,267,274,351,287,364,113,148,98,125,179,314,279,87,120,160,128,271,369,350,137,148,122,110,165,236,276,136,104,130,156,224,325,299,117,140,130,127,219,261,373,122,105,132,160,178,247,286,296,126,124,145,272,306,401,228,185],[170,250,203,196,281,341,457,185,236,198,192,327,382,404,207,172,172,281,258,304,350,137,155,191,222,308,381,396,170,227,166,205,283,285,399,148,149,168,182,229,359,420,186,177,289,284,374,313,405,145,189,115,162,208,343,319,115,161,173,159,287,383,391,154,175,145,147,191,249,313,163,140,168,210,297,338,355,188,164,145,172,261,274,428,145,129,144,214,209,274,375,326,168,155,211,335,346,441,265,239],[103,79,114,95,137,196,225,84,87,89,68,106,56,242,97,104,92,134,148,192,240,76,94,86,9,72,167,220,117,78,99,86,119,183,194,104,73,82,92,126,190,224,99,80,132,10,0,132,244,66,110,60,115,105,167,164,64,89,90,69,115,216,215,92,97,94,69,92,165,212,70,58,70,85,135,151,177,59,90,66,92,147,181,186,48,68,70,94,120,147,179,155,89,76,83,124,218,257,118,74],[116,119,114,115,138,216,262,99,104,97,83,124,81,260,115,126,96,139,167,228,276,87,127,99,22,97,194,240,133,96,118,118,147,196,213,128,96,111,140,139,217,265,139,103,163,39,19,165,296,94,135,85,157,138,189,198,90,122,113,111,122,237,240,112,109,101,94,110,179,245,94,81,97,142,168,173,204,84,103,107,134,181,198,239,78,88,109,142,149,162,185,185,121,112,124,151,245,337,158,108],[249,308,317,284,412,518,656,258,314,263,233,402,436,627,276,274,264,401,394,492,566,201,237,255,189,357,539,595,256,252,251,272,369,454,544,227,201,241,234,329,520,590,261,219,399,284,351,419,608,179,258,158,240,284,481,443,151,209,250,197,386,585,565,229,245,216,179,257,401,488,206,162,200,241,359,476,476,176,230,196,219,366,442,559,170,173,202,254,298,394,465,451,215,200,228,396,524,658,346,259],[286,369,317,311,419,557,719,284,340,295,275,451,463,664,322,298,268,420,425,532,626,224,282,290,244,405,575,636,303,323,284,323,430,481,612,276,245,279,322,368,576,685,325,280,452,323,393,478,701,239,324,200,319,346,532,517,205,283,286,270,409,620,631,266,284,246,241,301,428,558,257,221,265,352,465,511,559,272,267,252,306,442,472,667,223,217,253,356,358,436,560,511,289,267,335,486,591,778,423,347],[192,245,271,223,300,422,517,203,241,219,189,322,351,481,210,209,203,262,311,387,437,159,184,209,153,304,406,467,225,196,217,216,318,375,460,178,178,18,183,285,457,506,211,178,345,257,271,352,536,152,160,163,198,225,392,391,122,172,220,156,318,438,491,186,193,186,152,230,347,427,181,147,167,207,323,392,417,149,187,158,182,296,362,488,146,155,143,211,257,337,417,371,184,159,193,319,453,605,265,229],[241,325,271,279,318,475,593,236,285,242,244,377,415,562,275,256,210,299,357,450,504,200,239,258,220,382,446,535,281,287,254,298,401,430,536,247,266,73,334,347,555,635,302,251,421,338,355,415,648,220,242,232,332,311,471,509,216,278,263,392,348,470,578,242,256,226,248,304,400,509,242,211,231,330,451,445,498,251,247,219,285,385,408,630,219,223,203,335,325,381,528,442,261,243,321,440,557,706,369,338],[2,3,4,4,4,1,1,3,6,3,4,5,5,6,9,6,null,8,4,7,6,2,2,6,6,9,11,9,2,8,7,12,1,21,16,9,16,3,1,8,13,14,11,11,12,14,11,9,11,6,0,4,11,11,5,16,3,6,9,8,3,13,7,4,9,13,3,7,32,18,8,5,4,4,9,11,18,3,5,null,9,7,8,9,4,1,3,13,7,16,10,8,5,7,3,13,26,17,13,14],[2,3,4,4,4,1,1,3,6,3,4,5,5,6,9,6,0,8,4,7,6,2,2,6,6,9,11,9,2,8,7,12,1,21,16,10,25,3,6,10,14,20,14,18,15,22,18,16,11,15,2,5,27,16,9,33,20,15,11,29,8,14,9,8,12,15,11,11,34,25,13,12,7,15,17,12,21,11,7,4,14,14,9,19,9,14,4,29,10,19,13,12,8,10,8,27,28,20,27,19],[2,3,0,11,9,5,4,0,1,4,8,2,11,18,3,6,3,0,8,9,6,5,13,3,13,12,6,10,8,8,3,6,13,10,2,5,18,11,14,19,18,13,12,6,11,17,14,13,12,4,9,2,25,7,8,12,10,13,4,29,5,2,4,5,16,3,7,10,14,10,6,5,2,5,9,9,4,2,10,1,6,11,10,11,5,10,2,7,3,4,5,4,9,5,12,6,17,5,11,13],[12500.5,17679.5,15433,18245,22740.5,26757,21841,13077.5,16651.5,11474.75,13423,23605.01,25400,33034,16358,16158,10765,18506.5,21365,32960.5,28666,10736.5,13227.5,12905.5,13910.75,18536.5,29399.5,35987.5,16434.5,14744.5,11942,17049,16801,27690,33341.5,12473,9556,10998,12976,19385.5,35108,38595.5,11986,14492,21784.5,15358,18978.5,23182.5,39670,10437.5,12503.5,10452,12260,13899.5,29654.5,24630,6711.5,16457,14396,9704,22391,35087.5,37667,12586,14956,13597.5,10448,11101.5,25210.5,27881,13203.5,10204.5,12538,15337,23165.5,28458,31206,11463,12560.5,7204.5,14462,28304.5,28538.5,40855.5,12249.5,10306,11962.5,18582.5,22213.5,22524,35888,22715,13881,13393,5801.5,17276,29792.5,44533,19712.5,15929.5],[14296.5,26750.5,15433,23030,23814.5,26757,21841,13077.5,16651.5,11474.75,13423,23605.01,25400,33034,16358,16158,10765,18506.5,25025,39245.5,33451.5,12680.5,16370.5,15462.5,18636.75,27348.5,38420.5,38012,21604.5,21615.5,16191,21258,24286,29662,39884.5,19148,15795,13850,22380,28324.5,43002,50822.5,19612,19158,29315.5,21379,23711.5,30368.5,52206.5,15904.5,17595.5,15790,17718,20422,34999.5,30936,12767,26910.5,18751,17914,23938,37819.5,46219,16071,19660,16849.5,18417,16727,28912,35566,16395.5,13870.5,17800,27604,33439.5,31517.5,39366,18184,15565.51,13115.5,23970,37201,31491.5,51061,17989.5,15560.5,19854.5,30483.5,29572.5,25562,45622.5,29596,19958,18892,16829,26025,36069.5,54432,28454.5,21958.5],[113.16,117.65,119.39,125.8,131.22,136.1,161.78,123.56,128.92,157.62,116.34,148.97,187.08,175.33,118.7,63.33,120.42,115.64,149.74,167,179.65,103.99,103.16,116.67,118.35,115.1,281.3,163.26,107.49,80.52,140.4152,104.36,125.82,175.6,200.5,91.52,91.55,95.59,112.2,165.4,184.64,192.9,88.03,80,98.2,107.3,144.42,150.23,166.2,95.52,84.98,125.6,99.53,139.48,160.1,192.02,82.41,109.2,116.94,119.74,147.2,166.13,165.55,107.36,105.2,119.11,120.13,136,141.1,181.8,108.48,112.36,144.22,133.02,170,203.8,211.33,114.9,86.44,146.23,128.5,83,335.98,189.83,121.07,104.25,106.1,124.2,136.89,181.67,200.76,145.2,115.2,109.58,38,164.4,203.09,194.5,101.1,52.9],[169.05,170.67,119.39,197.65,156.23,178.53,227.95,190.09,190.22,220.6,189.01,219.05,253.53,239.67,177.77,110.03,137.8,150.39,220.2,213.88,262.58,148.59,176.46,149.89,178.68,172.77,329.18,250.48,167.21,161.17,209.7152,193.14,192.16,234.53,264.45,180.65,179.55,143.82,187.44,255.35,246.29,258.95,160.51,151.83,150.58,174,239.07,225.69,258.48,162.43,164.98,172.66,169.78,222.28,223.96,276.92,147.81,180.18,163.81,199.94,209.8,214.55,259.7,168.14,179,162.98,209.91,213.02,183.8,268.65,173.58,177.79,186.4,219.4,247.12,255.2,297.76,189,151.39,187.68,207.83,166.67,380.78,286.83,188.91,171.53,144.05,196,194.19,236.51,269.74,203.72,184.53,165.21,110.55,239.71,276.39,261.93,175.2,116.4]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Año<\/th>\n      <th>Mes<\/th>\n      <th>Semana<\/th>\n      <th>Dia<\/th>\n      <th>Fecha<\/th>\n      <th>Ventas<\/th>\n      <th>TotalVentas<\/th>\n      <th>Customers<\/th>\n      <th>Totalcustomers<\/th>\n      <th>CH_Promedio<\/th>\n      <th>TotalCH_Promedio<\/th>\n      <th>Burgers<\/th>\n      <th>TotalBurgers<\/th>\n      <th>Thickurgers<\/th>\n      <th>TotalThickburgers<\/th>\n      <th>Total_Burgers<\/th>\n      <th>T_Total_Burgers<\/th>\n      <th>Bebidas<\/th>\n      <th>Totalbebidas<\/th>\n      <th>Cervezas<\/th>\n      <th>Cafes<\/th>\n      <th>Totalcafes<\/th>\n      <th>Ventas_TPV<\/th>\n      <th>Total_Ventas_TPV<\/th>\n      <th>HR_Laborales<\/th>\n      <th>Total_HR_Laborales<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Año","targets":1},{"name":"Mes","targets":2},{"name":"Semana","targets":3},{"name":"Dia","targets":4},{"name":"Fecha","targets":5},{"name":"Ventas","targets":6},{"name":"TotalVentas","targets":7},{"name":"Customers","targets":8},{"name":"Totalcustomers","targets":9},{"name":"CH_Promedio","targets":10},{"name":"TotalCH_Promedio","targets":11},{"name":"Burgers","targets":12},{"name":"TotalBurgers","targets":13},{"name":"Thickurgers","targets":14},{"name":"TotalThickburgers","targets":15},{"name":"Total_Burgers","targets":16},{"name":"T_Total_Burgers","targets":17},{"name":"Bebidas","targets":18},{"name":"Totalbebidas","targets":19},{"name":"Cervezas","targets":20},{"name":"Cafes","targets":21},{"name":"Totalcafes","targets":22},{"name":"Ventas_TPV","targets":23},{"name":"Total_Ventas_TPV","targets":24},{"name":"HR_Laborales","targets":25},{"name":"Total_HR_Laborales","targets":26}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div style="text-align:justify">
<p>Para realizar la identificación de las diferentes distribuciones e implementar los gráficos como los histogramas y los boxplot, se elaboran filtros correspondientes para las ventas por cada día antes y después de pandemia</p>
<p>Los comandos para realizar los filtros es el siguiente:</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#filtra los datos del día Domingo antes de la pandemia</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>fil_dat_1_before<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(fil_before, Dia <span class="sc">==</span> <span class="dv">1</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#___________________________________________________________</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#filtra los datos del día Lunes antes de la pandemia</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>fil_dat_2_before<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(fil_before, Dia <span class="sc">==</span> <span class="dv">2</span>))</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co">#___________________________________________________________</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co">#filtra los datos del día martes antes de la pandemia</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>fil_dat_3_before<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(fil_before, Dia <span class="sc">==</span> <span class="dv">3</span>))</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="co">#___________________________________________________________</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co">#filtra los datos del día miércoles antes de la pandemia</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>fil_dat_4_before<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(fil_before, Dia <span class="sc">==</span> <span class="dv">4</span>))</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="co">#___________________________________________________________</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="co">#filtra los datos del día Jueves antes de la pandemia</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>fil_dat_5_before<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(fil_before, Dia <span class="sc">==</span> <span class="dv">5</span>))</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co">#___________________________________________________________</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="co">#filtra los datos del día Viernes antes de la pandemia</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>fil_dat_6_before<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(fil_before, Dia <span class="sc">==</span> <span class="dv">6</span>))</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co">#___________________________________________________________</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="co">#filtra los datos del día Sábado antes de la pandemia</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>fil_dat_7_before<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(fil_before, Dia <span class="sc">==</span> <span class="dv">7</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#____________________________________________________________________</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>fil_dat_after <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(datos, Año <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Mes<span class="sc">&gt;=</span><span class="dv">8</span>))</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co">#filtra los datos del día domingo despues de la pandemia</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>fil_dat_1_after<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(datos, </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>                                    Año <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Mes <span class="sc">&gt;=</span> <span class="dv">8</span> <span class="sc">&amp;</span> Dia<span class="sc">==</span><span class="dv">1</span>))</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co">#____________________________________________________________________</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co">#filtra los datos del día lunes despues de la pandemia</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>fil_dat_2_after<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(datos,</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>                                    Año <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Mes <span class="sc">&gt;=</span> <span class="dv">8</span> <span class="sc">&amp;</span> Dia <span class="sc">==</span><span class="dv">2</span>))</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#____________________________________________________________________</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co">#filtra los datos del día martes despues de la pandemia</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>fil_dat_3_after<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(datos,</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>                                    Año <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Mes <span class="sc">&gt;=</span> <span class="dv">8</span> <span class="sc">&amp;</span> Dia <span class="sc">==</span><span class="dv">3</span>))</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a><span class="co">#____________________________________________________________________</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#filtra los datos del día miércoles despues de la pandemia</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>fil_dat_4_after<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(datos,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>                                    Año <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Mes <span class="sc">&gt;=</span> <span class="dv">8</span> <span class="sc">&amp;</span> Dia <span class="sc">==</span><span class="dv">4</span>))</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co">#____________________________________________________________________</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co">#filtra los datos del día jueves despues de la pandemia</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>fil_dat_5_after<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(datos,</span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>                                    Año <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Mes <span class="sc">&gt;=</span> <span class="dv">8</span> <span class="sc">&amp;</span> Dia <span class="sc">==</span><span class="dv">5</span>))</span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="co">#____________________________________________________________________</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="co">#filtra los datos del día viernes despues de la pandemia</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>fil_dat_6_after<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(datos,</span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>                                    Año <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Mes <span class="sc">&gt;=</span> <span class="dv">8</span> <span class="sc">&amp;</span> Dia <span class="sc">==</span><span class="dv">6</span>))</span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co">#____________________________________________________________________</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a><span class="co">#filtra los datos del día sábado despues de la pandemia</span></span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>fil_dat_7_after<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">subset</span>(datos,</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>                                    Año <span class="sc">==</span> <span class="dv">2020</span> <span class="sc">&amp;</span> Mes <span class="sc">&gt;=</span> <span class="dv">8</span> <span class="sc">&amp;</span> Dia <span class="sc">==</span><span class="dv">7</span>))</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div style="text-align:justify">
<p>Para visualizar gráficamente el comportamiento de las ventas por día, a continuación se construyen los histogramas por día, en los periodos antes y después de la pandemia.</p>
</div>
</section>
<section id="análisis-gráfico-de-las-ventas-por-día" class="level3" data-number="6.2.5">
<h3 data-number="6.2.5" class="anchored" data-anchor-id="análisis-gráfico-de-las-ventas-por-día"><span class="header-section-number">6.2.5</span> Análisis gráfico de las ventas por día:</h3>
<div style="text-align:justify">
<p>Para la generación de los gráficos se empleó los filtros anteriores, con el fin de obtener un análisis descriptivo de cada uno de ellos.</p>
</div>
<section id="histogramas-de-los-datos-de-ventas-por-día-antes-de-la-pandemia" class="level4" data-number="6.2.5.1">
<h4 data-number="6.2.5.1" class="anchored" data-anchor-id="histogramas-de-los-datos-de-ventas-por-día-antes-de-la-pandemia"><span class="header-section-number">6.2.5.1</span> Histogramas de los datos de ventas por día antes de la pandemia</h4>
<div style="text-align:justify">
<p>El código que genera estos histogramas en R es el siguiente:</p>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># muestra el gráfico de todos los histogramas de ventas por día antes de la pandemia</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fil_dat_1_before<span class="sc">$</span>Ventas, <span class="at">main =</span> <span class="st">"Ventas día Domingo"</span>, <span class="at">xlab =</span> <span class="st">"Ventas"</span>)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fil_dat_2_before<span class="sc">$</span>Ventas, <span class="at">main =</span> <span class="st">"Ventas día Lunes"</span>, <span class="at">xlab =</span> <span class="st">"Ventas"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fil_dat_3_before<span class="sc">$</span>Ventas, <span class="at">main =</span> <span class="st">"Ventas día Martes"</span>, <span class="at">xlab =</span> <span class="st">"Ventas"</span>)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fil_dat_4_before<span class="sc">$</span>Ventas, <span class="at">main =</span> <span class="st">"Ventas día Miércoles"</span>, <span class="at">xlab =</span> <span class="st">"Ventas"</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fil_dat_5_before<span class="sc">$</span>Ventas, <span class="at">main =</span> <span class="st">"Ventas día Jueves"</span>, <span class="at">xlab =</span> <span class="st">"Ventas"</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fil_dat_6_before<span class="sc">$</span>Ventas, <span class="at">main =</span> <span class="st">"Ventas día Viernes"</span>, <span class="at">xlab =</span> <span class="st">"Ventas"</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fil_dat_7_before<span class="sc">$</span>Ventas, <span class="at">main =</span> <span class="st">"Ventas día Sábado"</span>, <span class="at">xlab =</span> <span class="st">"Ventas"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-his1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-his1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Estudio_caso_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-his1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.1: Histogramas de las ventas por día antes de la pandemia.
</figcaption>
</figure>
</div>
<div style="text-align:justify">
<p>Para profundizar en el análisis descriptivo de las ventas periódicas se presenta ahora los boxplot de las ventas por cada día de la semana.</p>
</div>
</section>
<section id="boxplot-de-datos-de-ventas-por-días-antes-de-la-pandemia" class="level4" data-number="6.2.5.2">
<h4 data-number="6.2.5.2" class="anchored" data-anchor-id="boxplot-de-datos-de-ventas-por-días-antes-de-la-pandemia"><span class="header-section-number">6.2.5.2</span> Boxplot de datos de ventas por días antes de la pandemia</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  30977  122963  135498  138498  158347  239776 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   7430   35919   48676   57388   68030  172946 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  12950   35210   44398   53367   56624  219702 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  10832   35847   44213   56365   63585  195662 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  13547   42368   49479   61068   70047  220827 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  10331   65730   79464   86514   96522  240519 </code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  24219  100751  110603  119332  135176  229542 </code></pre>
</div>
</div>
<div style="text-align:justify">
<p>El código que genera en R los boxplot es el siguiente:</p>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># muestra el gráfico de todos los boxplot de ventas por día antes de la pandemia </span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">y =</span>fil_dat_1_before<span class="sc">$</span>Ventas, <span class="at">name =</span> <span class="st">"Ventas día Domingo"</span>, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">boxpoints =</span> <span class="st">"all"</span>,<span class="at">type =</span> <span class="st">"box"</span>, )</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">y =</span> fil_dat_2_before<span class="sc">$</span>Ventas,  </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> <span class="st">"Ventas día Lunes"</span>, <span class="at">boxpoints =</span> <span class="st">"all"</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">y =</span> fil_dat_3_before<span class="sc">$</span>Ventas,  </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> <span class="st">"Ventas día Martes"</span>, <span class="at">boxpoints =</span> <span class="st">"all"</span>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">y =</span> fil_dat_4_before<span class="sc">$</span>Ventas,  </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> <span class="st">"Ventas día Miércoles"</span>, <span class="at">boxpoints =</span> <span class="st">"all"</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">y =</span> fil_dat_5_before<span class="sc">$</span>Ventas,  </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> <span class="st">"Ventas día Jueves"</span>, <span class="at">boxpoints =</span> <span class="st">"all"</span>)</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">y =</span> fil_dat_6_before<span class="sc">$</span>Ventas,  </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> <span class="st">"Ventas día Viernes"</span>, <span class="at">boxpoints =</span> <span class="st">"all"</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">y =</span> fil_dat_7_before<span class="sc">$</span>Ventas,  </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> <span class="st">"Ventas día Sábado"</span>, <span class="at">boxpoints =</span> <span class="st">"all"</span>)</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-box1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-box1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-9dd0b0864b4f528da387" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9dd0b0864b4f528da387">{"x":{"visdat":{"503013741bd3":["function () ","plotlyVisDat"]},"cur_data":"503013741bd3","attrs":{"503013741bd3":{"y":[239775.60000000001,224106.5,210023.5,187502,186582,180678.5,176622.5,173544,166807.5,167262.5,176270,155241,162756.5,146158,148116,163728.5,184964.5,162555.5,158346.5,152569.5,169846,183004.5,160648,125781,121161.5,140700,125911,128288.5,113462.5,122248.5,123953.5,138972.5,125291.60000000001,133300.10000000001,112134.3,119650.3,120672.5,112773.89999999999,124030.2,144755.39999999999,141233.10000000001,106459.39999999999,138812.39999999999,138767.79999999999,149580.89999999999,150234.29999999999,136017.29999999999,142955.5,160233.60000000001,133375.60000000001,139726.79999999999,139232.89999999999,121838.7,125860.10000000001,133451,135498.29999999999,124466.39999999999,137573.5,122963.10000000001,93791.300000000003,128758.5,150201.39999999999,133014.20000000001,100913.60000000001,125368.3,113488.3,112874.39999999999,126737.89999999999,180481.5,112854.2,125293.39999999999,157887.10000000001,171760.39999999999,186942.20000000001,148542.60000000001,128326.2,124114.2,116095,125006,99824.399999999994,106775,136038.79999999999,124785.10000000001,123623.10000000001,119983.7,95999.5,45407.199999999997,32004.099999999999,30977],"boxpoints":"all","name":"Ventas día Domingo","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"},"503013741bd3.1":{"y":[172946,152557,129751.5,78116,68030,68986,53070,60897,53360.5,59210.5,52488,58398.5,52754.5,46895.5,40663,50000,157693.5,48169,54569,62100.5,90382,72029.5,57422.5,50277.5,45882.5,41421.5,38891.5,108457,31938,33099,32647.599999999999,29517,32098.799999999999,88069.600000000006,35059.099999999999,34734.900000000001,35525.900000000001,71510,65272,44336.199999999997,34313.199999999997,42488.800000000003,37621.800000000003,43764.300000000003,40865.699999999997,54742,50357.699999999997,45061.400000000001,52800.5,74001,86144.800000000003,73659.600000000006,77883.5,55206.099999999999,51490,53703.099999999999,31481,34780.400000000001,32523.799999999999,108229.10000000001,27108.400000000001,34657.5,36081.099999999999,33773.699999999997,39866.5,24169.599999999999,28846.400000000001,40888.400000000001,157157.89999999999,36105.5,46501.300000000003,55111.699999999997,72208.899999999994,157096.10000000001,113564.7,59858.400000000001,29445.5,48675.5,36441,80578.199999999997,35918.949999999997,34451.800000000003,38096.800000000003,38122.300000000003,46895.300000000003,73364.600000000006,18278.299999999999,16471.599999999999,7429.6999999999998],"boxpoints":"all","name":"Ventas día Lunes","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","inherit":true},"503013741bd3.2":{"y":[210671,148675.5,125867.5,71871,71887,66672.5,51200.5,49682,51226,54915.5,52787,60411.5,49708.5,48514.5,43886,46455,41443.5,50815.5,52232,67357.5,100400.5,116951.5,97377.5,43394,50094.5,41220,46811,38856.5,28783.5,34744,36693.5,31409.799999999999,36144.900000000001,30171.099999999999,31540.799999999999,35210.199999999997,36569.5,83190.699999999997,59436,124725,38248,43041,44397.900000000001,219702.39999999999,43917.199999999997,34676,49843.800000000003,48529.699999999997,48347,56623.699999999997,75305.600000000006,62824.900000000001,75060.399999999994,50219.199999999997,64642.300000000003,56014.099999999999,29046.099999999999,33469.699999999997,35937.699999999997,19511.799999999999,45274.800000000003,35215.599999999999,25993.900000000001,35983.5,31816.900000000001,30997,36779.699999999997,38199.300000000003,39840.300000000003,32416.700000000001,45191.5,59804.5,80245.25,57511.599999999999,51311.5,55717.599999999999,35763.699999999997,39722.199999999997,39574.900000000001,33915.900000000001,33387.199999999997,36017.400000000001,31464.200000000001,28307.700000000001,28600.900000000001,35020,22846.799999999999,20427.599999999999,12950.4],"boxpoints":"all","name":"Ventas día Martes","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","inherit":true},"503013741bd3.3":{"y":[188037.5,195662,142344,133380,82471.5,74843.5,67484,64516,62988,54245,43862.5,59824,54656,47951,66312,40777,52257.5,37508,47122.5,61419,99654.5,117733,123364.5,103063,54722.5,55367.5,41260.5,43024,43969,30878,31850.5,40681.800000000003,33445,27448.200000000001,30028.599999999999,37879,40804,38193.699999999997,80338.199999999997,62587,120109.7,44664.400000000001,73208.399999999994,38978.099999999999,45424.099999999999,32101,59734.5,54739.5,48680,63784.400000000001,56825.5,72501.5,62440.800000000003,83394.199999999997,62894.5,60408.5,64331.599999999999,30377.200000000001,34701.400000000001,33526.599999999999,38385.400000000001,41309,24786.700000000001,33058.699999999997,35293,30487.799999999999,40272.5,34571.599999999999,44456.400000000001,41695.300000000003,39943.5,30819,61495.550000000003,83281.399999999994,97132,81934,42647.099999999999,43603.300000000003,40150.300000000003,38979.800000000003,29176.299999999999,34846.099999999999,40308.5,33259.599999999999,40315.5,33268.699999999997,35140.5,19397.700000000001,15214.700000000001,10832.1],"boxpoints":"all","name":"Ventas día Miércoles","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","inherit":true},"503013741bd3.4":{"y":[220827,193051,152189.5,135070.5,98739.5,77880.5,70495.5,81610.5,63809.5,63729.5,61547,53762,62828.5,60041,74036.5,36947,63789.5,42708.5,54615.5,59961,68722,134577,114424.5,85146,49011.5,45247,51897,48762,35632,93718.5,42205,47988.300000000003,37889.900000000001,41570.199999999997,44178.599999999999,35421.699999999997,38167.900000000001,43124.900000000001,82291.5,72835.600000000006,42653,53980.599999999999,69158.699999999997,42826.199999999997,49782.800000000003,41350.199999999997,53859.099999999999,54669.199999999997,65561,60659.5,70342.5,74497.600000000006,99066.899999999994,74445,57406.900000000001,63977.300000000003,64716.900000000001,43554.699999999997,36442.5,43618,34420,43037.400000000001,38303,29511.900000000001,43823,33440.900000000001,45739.5,38535,44895.400000000001,45357.400000000001,49176.099999999999,42552.5,94370.050000000003,106056.89999999999,111373.2,91922.800000000003,43258.5,49053.900000000001,48714.550000000003,51356.900000000001,31223.599999999999,42306.599999999999,39269.099999999999,42300,29549,45909.300000000003,33109.050000000003,13547,16709.599999999999,14240.4],"boxpoints":"all","name":"Ventas día Jueves","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","inherit":true},"503013741bd3.5":{"y":[240519,206803,171891,158927,131185.5,128575,104876,128973.5,90914,119543.5,102853,108648,93418,94496,143238,83095,135567,84153.5,96865.5,93407.5,96990.5,140285.5,126574,95491,71245.5,85562.5,76126.5,70145.5,60523,76009,61182,85013.899999999994,63389.5,54188.900000000001,65326.900000000001,66465.300000000003,72095.699999999997,76725.399999999994,82288.800000000003,92283.699999999997,61259.900000000001,70472.399999999994,76438.600000000006,75851,92777.399999999994,86281.899999999994,98422.699999999997,79115.5,88580.899999999994,83608,74996.699999999997,83469.199999999997,103450.2,88386.600000000006,81352.100000000006,90349.699999999997,69159.800000000003,67773.800000000003,58353.599999999999,76195.899999999994,49073.800000000003,59405.099999999999,68845,58331.900000000001,64207.199999999997,61250.099999999999,61845.900000000001,62966.300000000003,134674.5,65484.800000000003,79811.5,84548.100000000006,76511,118447.7,100888.2,85206.699999999997,65188.599999999999,51376.900000000001,56964.099999999999,76006.699999999997,59553.300000000003,118358,74538.300000000003,77477.300000000003,72588.100000000006,74351.300000000003,34818.800000000003,24600.799999999999,10331.4,16457.599999999999],"boxpoints":"all","name":"Ventas día Viernes","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","inherit":true},"503013741bd3.6":{"y":[229542,219399,194642.5,175382,157909.5,182618,148493.5,110157,146641,156898,151446,163899,148863.5,123020.5,146623,132589,170760.5,119149.5,146393.5,178110,158461,166324.10000000001,142232.5,112363,122408,108540,102003,98070,102680.5,113771.5,84909.600000000006,104665,95743.800000000003,111798.3,103919.2,107929.7,107583.39999999999,109769.89999999999,89490.800000000003,105947,100750.5,95621,109718.39999999999,94809,129534.2,121839,135175.89999999999,112822.3,124285.10000000001,122408.10000000001,125705.5,103878.7,110602.5,93775.800000000003,100306.21000000001,115034.10000000001,96125.899999999994,97784.399999999994,99172.600000000006,113059.10000000001,94255.600000000006,89917.699999999997,113235.10000000001,103401.60000000001,98092.899999999994,104472.7,101679.2,96357,182942.70000000001,92088.899999999994,112985.89999999999,110060.10000000001,149063.79999999999,151523.20000000001,114169.8,91722.600000000006,106090.10000000001,107340.5,98833,108465.89999999999,78264.600000000006,116458.10000000001,107478.60000000001,132427.10000000001,103935.8,111136.39999999999,34645.699999999997,31719.700000000001,24218.700000000001],"boxpoints":"all","name":"Ventas día Sábado","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"xaxis":{"domain":[0,1],"automargin":true},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(31,119,180,0.5)","y":[239775.60000000001,224106.5,210023.5,187502,186582,180678.5,176622.5,173544,166807.5,167262.5,176270,155241,162756.5,146158,148116,163728.5,184964.5,162555.5,158346.5,152569.5,169846,183004.5,160648,125781,121161.5,140700,125911,128288.5,113462.5,122248.5,123953.5,138972.5,125291.60000000001,133300.10000000001,112134.3,119650.3,120672.5,112773.89999999999,124030.2,144755.39999999999,141233.10000000001,106459.39999999999,138812.39999999999,138767.79999999999,149580.89999999999,150234.29999999999,136017.29999999999,142955.5,160233.60000000001,133375.60000000001,139726.79999999999,139232.89999999999,121838.7,125860.10000000001,133451,135498.29999999999,124466.39999999999,137573.5,122963.10000000001,93791.300000000003,128758.5,150201.39999999999,133014.20000000001,100913.60000000001,125368.3,113488.3,112874.39999999999,126737.89999999999,180481.5,112854.2,125293.39999999999,157887.10000000001,171760.39999999999,186942.20000000001,148542.60000000001,128326.2,124114.2,116095,125006,99824.399999999994,106775,136038.79999999999,124785.10000000001,123623.10000000001,119983.7,95999.5,45407.199999999997,32004.099999999999,30977],"boxpoints":"all","name":"Ventas día Domingo","type":"box","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(255,127,14,0.5)","y":[172946,152557,129751.5,78116,68030,68986,53070,60897,53360.5,59210.5,52488,58398.5,52754.5,46895.5,40663,50000,157693.5,48169,54569,62100.5,90382,72029.5,57422.5,50277.5,45882.5,41421.5,38891.5,108457,31938,33099,32647.599999999999,29517,32098.799999999999,88069.600000000006,35059.099999999999,34734.900000000001,35525.900000000001,71510,65272,44336.199999999997,34313.199999999997,42488.800000000003,37621.800000000003,43764.300000000003,40865.699999999997,54742,50357.699999999997,45061.400000000001,52800.5,74001,86144.800000000003,73659.600000000006,77883.5,55206.099999999999,51490,53703.099999999999,31481,34780.400000000001,32523.799999999999,108229.10000000001,27108.400000000001,34657.5,36081.099999999999,33773.699999999997,39866.5,24169.599999999999,28846.400000000001,40888.400000000001,157157.89999999999,36105.5,46501.300000000003,55111.699999999997,72208.899999999994,157096.10000000001,113564.7,59858.400000000001,29445.5,48675.5,36441,80578.199999999997,35918.949999999997,34451.800000000003,38096.800000000003,38122.300000000003,46895.300000000003,73364.600000000006,18278.299999999999,16471.599999999999,7429.6999999999998],"boxpoints":"all","name":"Ventas día Lunes","type":"box","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(44,160,44,0.5)","y":[210671,148675.5,125867.5,71871,71887,66672.5,51200.5,49682,51226,54915.5,52787,60411.5,49708.5,48514.5,43886,46455,41443.5,50815.5,52232,67357.5,100400.5,116951.5,97377.5,43394,50094.5,41220,46811,38856.5,28783.5,34744,36693.5,31409.799999999999,36144.900000000001,30171.099999999999,31540.799999999999,35210.199999999997,36569.5,83190.699999999997,59436,124725,38248,43041,44397.900000000001,219702.39999999999,43917.199999999997,34676,49843.800000000003,48529.699999999997,48347,56623.699999999997,75305.600000000006,62824.900000000001,75060.399999999994,50219.199999999997,64642.300000000003,56014.099999999999,29046.099999999999,33469.699999999997,35937.699999999997,19511.799999999999,45274.800000000003,35215.599999999999,25993.900000000001,35983.5,31816.900000000001,30997,36779.699999999997,38199.300000000003,39840.300000000003,32416.700000000001,45191.5,59804.5,80245.25,57511.599999999999,51311.5,55717.599999999999,35763.699999999997,39722.199999999997,39574.900000000001,33915.900000000001,33387.199999999997,36017.400000000001,31464.200000000001,28307.700000000001,28600.900000000001,35020,22846.799999999999,20427.599999999999,12950.4],"boxpoints":"all","name":"Ventas día Martes","type":"box","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(214,39,40,0.5)","y":[188037.5,195662,142344,133380,82471.5,74843.5,67484,64516,62988,54245,43862.5,59824,54656,47951,66312,40777,52257.5,37508,47122.5,61419,99654.5,117733,123364.5,103063,54722.5,55367.5,41260.5,43024,43969,30878,31850.5,40681.800000000003,33445,27448.200000000001,30028.599999999999,37879,40804,38193.699999999997,80338.199999999997,62587,120109.7,44664.400000000001,73208.399999999994,38978.099999999999,45424.099999999999,32101,59734.5,54739.5,48680,63784.400000000001,56825.5,72501.5,62440.800000000003,83394.199999999997,62894.5,60408.5,64331.599999999999,30377.200000000001,34701.400000000001,33526.599999999999,38385.400000000001,41309,24786.700000000001,33058.699999999997,35293,30487.799999999999,40272.5,34571.599999999999,44456.400000000001,41695.300000000003,39943.5,30819,61495.550000000003,83281.399999999994,97132,81934,42647.099999999999,43603.300000000003,40150.300000000003,38979.800000000003,29176.299999999999,34846.099999999999,40308.5,33259.599999999999,40315.5,33268.699999999997,35140.5,19397.700000000001,15214.700000000001,10832.1],"boxpoints":"all","name":"Ventas día Miércoles","type":"box","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(148,103,189,0.5)","y":[220827,193051,152189.5,135070.5,98739.5,77880.5,70495.5,81610.5,63809.5,63729.5,61547,53762,62828.5,60041,74036.5,36947,63789.5,42708.5,54615.5,59961,68722,134577,114424.5,85146,49011.5,45247,51897,48762,35632,93718.5,42205,47988.300000000003,37889.900000000001,41570.199999999997,44178.599999999999,35421.699999999997,38167.900000000001,43124.900000000001,82291.5,72835.600000000006,42653,53980.599999999999,69158.699999999997,42826.199999999997,49782.800000000003,41350.199999999997,53859.099999999999,54669.199999999997,65561,60659.5,70342.5,74497.600000000006,99066.899999999994,74445,57406.900000000001,63977.300000000003,64716.900000000001,43554.699999999997,36442.5,43618,34420,43037.400000000001,38303,29511.900000000001,43823,33440.900000000001,45739.5,38535,44895.400000000001,45357.400000000001,49176.099999999999,42552.5,94370.050000000003,106056.89999999999,111373.2,91922.800000000003,43258.5,49053.900000000001,48714.550000000003,51356.900000000001,31223.599999999999,42306.599999999999,39269.099999999999,42300,29549,45909.300000000003,33109.050000000003,13547,16709.599999999999,14240.4],"boxpoints":"all","name":"Ventas día Jueves","type":"box","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"line":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(140,86,75,0.5)","y":[240519,206803,171891,158927,131185.5,128575,104876,128973.5,90914,119543.5,102853,108648,93418,94496,143238,83095,135567,84153.5,96865.5,93407.5,96990.5,140285.5,126574,95491,71245.5,85562.5,76126.5,70145.5,60523,76009,61182,85013.899999999994,63389.5,54188.900000000001,65326.900000000001,66465.300000000003,72095.699999999997,76725.399999999994,82288.800000000003,92283.699999999997,61259.900000000001,70472.399999999994,76438.600000000006,75851,92777.399999999994,86281.899999999994,98422.699999999997,79115.5,88580.899999999994,83608,74996.699999999997,83469.199999999997,103450.2,88386.600000000006,81352.100000000006,90349.699999999997,69159.800000000003,67773.800000000003,58353.599999999999,76195.899999999994,49073.800000000003,59405.099999999999,68845,58331.900000000001,64207.199999999997,61250.099999999999,61845.900000000001,62966.300000000003,134674.5,65484.800000000003,79811.5,84548.100000000006,76511,118447.7,100888.2,85206.699999999997,65188.599999999999,51376.900000000001,56964.099999999999,76006.699999999997,59553.300000000003,118358,74538.300000000003,77477.300000000003,72588.100000000006,74351.300000000003,34818.800000000003,24600.799999999999,10331.4,16457.599999999999],"boxpoints":"all","name":"Ventas día Viernes","type":"box","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"line":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(227,119,194,0.5)","y":[229542,219399,194642.5,175382,157909.5,182618,148493.5,110157,146641,156898,151446,163899,148863.5,123020.5,146623,132589,170760.5,119149.5,146393.5,178110,158461,166324.10000000001,142232.5,112363,122408,108540,102003,98070,102680.5,113771.5,84909.600000000006,104665,95743.800000000003,111798.3,103919.2,107929.7,107583.39999999999,109769.89999999999,89490.800000000003,105947,100750.5,95621,109718.39999999999,94809,129534.2,121839,135175.89999999999,112822.3,124285.10000000001,122408.10000000001,125705.5,103878.7,110602.5,93775.800000000003,100306.21000000001,115034.10000000001,96125.899999999994,97784.399999999994,99172.600000000006,113059.10000000001,94255.600000000006,89917.699999999997,113235.10000000001,103401.60000000001,98092.899999999994,104472.7,101679.2,96357,182942.70000000001,92088.899999999994,112985.89999999999,110060.10000000001,149063.79999999999,151523.20000000001,114169.8,91722.600000000006,106090.10000000001,107340.5,98833,108465.89999999999,78264.600000000006,116458.10000000001,107478.60000000001,132427.10000000001,103935.8,111136.39999999999,34645.699999999997,31719.700000000001,24218.700000000001],"boxpoints":"all","name":"Ventas día Sábado","type":"box","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"line":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-box1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.2: Boxplot de las ventas por día antes de la pandemia.
</figcaption>
</figure>
</div>
</section>
<section id="histogramas-de-los-datos-de-ventas-por-día-después-de-la-pandemia" class="level4" data-number="6.2.5.3">
<h4 data-number="6.2.5.3" class="anchored" data-anchor-id="histogramas-de-los-datos-de-ventas-por-día-después-de-la-pandemia"><span class="header-section-number">6.2.5.3</span> Histogramas de los datos de ventas por día después de la pandemia</h4>
<div style="text-align:justify">
<p>El código que genera estos histogramas en R es el siguiente:</p>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># muestra el gráfico de todos los histogramas de ventas por día despues de la pandemia</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fil_dat_1_after<span class="sc">$</span>Ventas, <span class="at">main =</span> <span class="st">"Ventas día Domingo"</span>, <span class="at">xlab =</span> <span class="st">"Ventas"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fil_dat_2_after<span class="sc">$</span>Ventas, <span class="at">main =</span> <span class="st">"Ventas día Lunes"</span>, <span class="at">xlab =</span> <span class="st">"Ventas"</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fil_dat_3_after<span class="sc">$</span>Ventas, <span class="at">main =</span> <span class="st">"Ventas día Martes"</span>, <span class="at">xlab =</span> <span class="st">"Ventas"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fil_dat_4_after<span class="sc">$</span>Ventas, <span class="at">main =</span> <span class="st">"Ventas día Miércoles"</span>, <span class="at">xlab =</span> <span class="st">"Ventas"</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fil_dat_5_after<span class="sc">$</span>Ventas, <span class="at">main =</span> <span class="st">"Ventas día Jueves"</span>, <span class="at">xlab =</span> <span class="st">"Ventas"</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fil_dat_6_after<span class="sc">$</span>Ventas, <span class="at">main =</span> <span class="st">"Ventas día Viernes"</span>, <span class="at">xlab =</span> <span class="st">"Ventas"</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(fil_dat_7_after<span class="sc">$</span>Ventas, <span class="at">main =</span> <span class="st">"Ventas día Sábado"</span>, <span class="at">xlab =</span> <span class="st">"Ventas"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-his2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-his2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Estudio_caso_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-his2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.3: Histogramas de las ventas por día después de la pandemia.
</figcaption>
</figure>
</div>
<div style="text-align:justify">
<p>El comportamiento periódico de las ventas, se observa en los boxplot de las ventas por cada día de la semana.</p>
</div>
</section>
<section id="boxplot-de-datos-de-ventas-por-días-limpios-después-de-la-pandemia" class="level4" data-number="6.2.5.4">
<h4 data-number="6.2.5.4" class="anchored" data-anchor-id="boxplot-de-datos-de-ventas-por-días-limpios-después-de-la-pandemia"><span class="header-section-number">6.2.5.4</span> Boxplot de datos de ventas por días limpios después de la pandemia</h4>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fil_dat_1_after<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  80431   95346  103691  101919  107639  122397 </code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fil_dat_2_after<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  27106   33867   40804   42339   47566   77299 </code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fil_dat_3_after<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  30514   38860   41889   41752   44732   51733 </code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fil_dat_4_after<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  30335   34697   43071   43243   46480   70983 </code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fil_dat_5_after<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  31704   39901   43144   43010   47048   63104 </code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fil_dat_6_after<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  45908   56956   63361   61191   66915   70159 </code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fil_dat_7_after<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  73606   78646   84130   85684   89730  101467 </code></pre>
</div>
</div>
<div style="text-align:justify">
<p>El código que genera estos los boxplot en R es el siguiente:</p>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="co">#día 1 = domingo</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co">#día 2 = lunes</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="co">#día 3 = martes</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="co">#día 4 = miércoles</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="co">#día 5 = jueves</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="co">#día 6 = viernes </span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="co">#día 7 = sábado</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">y =</span>fil_dat_1_after<span class="sc">$</span>Ventas, <span class="at">name =</span> <span class="st">"Ventas día Domingo"</span>, <span class="at">boxpoints =</span> <span class="st">"all"</span>,<span class="at">type =</span> <span class="st">"box"</span>)</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">y =</span> fil_dat_2_after<span class="sc">$</span>Ventas,  </span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> <span class="st">"Ventas día Lunes"</span>, <span class="at">boxpoints =</span> <span class="st">"all"</span>)</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">y =</span> fil_dat_3_after<span class="sc">$</span>Ventas,  </span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> <span class="st">"Ventas día Martes"</span>, <span class="at">boxpoints =</span> <span class="st">"all"</span>)</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">y =</span> fil_dat_4_after<span class="sc">$</span>Ventas,  </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> <span class="st">"Ventas día Miércoles"</span>, <span class="at">boxpoints =</span> <span class="st">"all"</span>)</span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">y =</span> fil_dat_5_after<span class="sc">$</span>Ventas,  </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> <span class="st">"Ventas día Jueves"</span>, <span class="at">boxpoints =</span> <span class="st">"all"</span>)</span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">y =</span> fil_dat_6_after<span class="sc">$</span>Ventas,  </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> <span class="st">"Ventas día Viernes"</span>, <span class="at">boxpoints=</span><span class="st">"all"</span>)</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">y =</span> fil_dat_7_after<span class="sc">$</span>Ventas,  </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>                         <span class="at">name =</span> <span class="st">"Ventas día Sábado"</span>, <span class="at">boxpoints =</span> <span class="st">"all"</span>)</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-box2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-box2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a742ced6e6828b08ef24" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a742ced6e6828b08ef24">{"x":{"visdat":{"5030b5b38e3":["function () ","plotlyVisDat"]},"cur_data":"5030b5b38e3","attrs":{"5030b5b38e3":{"y":[113384.7,107918.3,102744.89999999999,103271.2,95213.199999999997,106802.10000000001,112426.8,80430.899999999994,105734.39999999999,95743.300000000003,88480.600000000006,104110.5,88208.600000000006,122397.2],"boxpoints":"all","name":"Ventas día Domingo","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box"},"5030b5b38e3.1":{"y":[44908.699999999997,40974.599999999999,48885.800000000003,34713.5,47309.400000000001,40803.599999999999,47822.400000000001,30176.700000000001,27106.099999999999,40305.5,37657,33020.199999999997,29893.900000000001,77298.600000000006,54206.699999999997],"boxpoints":"all","name":"Ventas día Lunes","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","inherit":true},"5030b5b38e3.2":{"y":[51733,48520.099999999999,48311.199999999997,40403.400000000001,44723.400000000001,38201,39518.900000000001,44740.300000000003,37465.5,43912.599999999999,30514.400000000001,41105.300000000003,31471.5,41889.099999999999,43766.5],"boxpoints":"all","name":"Ventas día Martes","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","inherit":true},"5030b5b38e3.3":{"y":[57876.949999999997,46649.150000000001,44658,47028.099999999999,44294.900000000001,41846.699999999997,70982.600000000006,30334.799999999999,45972.800000000003,39382.900000000001,36641.599999999999,34048.599999999999,32237.599999999999,33449.300000000003],"boxpoints":"all","name":"Ventas día Miércoles","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","inherit":true},"5030b5b38e3.4":{"y":[47554.599999999999,40556.900000000001,63104.300000000003,31703.549999999999,47556.949999999997,42694.300000000003,49385.900000000001,45527.300000000003,34305.900000000001,32090.700000000001,43593.699999999997,40561.800000000003,43825.900000000001,39682.5],"boxpoints":"all","name":"Ventas día Jueves","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","inherit":true},"5030b5b38e3.5":{"y":[67138.199999999997,70159.100000000006,67481.300000000003,59907.400000000001,62269.099999999999,57266.199999999997,55780.699999999997,48707.400000000001,64452.800000000003,45907.900000000001,65592.100000000006,68919.899999999994,56852.300000000003,66243.800000000003],"boxpoints":"all","name":"Ventas día Viernes","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","inherit":true},"5030b5b38e3.6":{"y":[89172.699999999997,77736.800000000003,89795.300000000003,89533.399999999994,83662.699999999997,94463.100000000006,75692.100000000006,84596.300000000003,101466.5,77369.199999999997,81561.309999999998,81373.5,73606,99547.899999999994],"boxpoints":"all","name":"Ventas día Sábado","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"box","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":[]},"xaxis":{"domain":[0,1],"automargin":true},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"fillcolor":"rgba(31,119,180,0.5)","y":[113384.7,107918.3,102744.89999999999,103271.2,95213.199999999997,106802.10000000001,112426.8,80430.899999999994,105734.39999999999,95743.300000000003,88480.600000000006,104110.5,88208.600000000006,122397.2],"boxpoints":"all","name":"Ventas día Domingo","type":"box","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(255,127,14,0.5)","y":[44908.699999999997,40974.599999999999,48885.800000000003,34713.5,47309.400000000001,40803.599999999999,47822.400000000001,30176.700000000001,27106.099999999999,40305.5,37657,33020.199999999997,29893.900000000001,77298.600000000006,54206.699999999997],"boxpoints":"all","name":"Ventas día Lunes","type":"box","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(44,160,44,0.5)","y":[51733,48520.099999999999,48311.199999999997,40403.400000000001,44723.400000000001,38201,39518.900000000001,44740.300000000003,37465.5,43912.599999999999,30514.400000000001,41105.300000000003,31471.5,41889.099999999999,43766.5],"boxpoints":"all","name":"Ventas día Martes","type":"box","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(214,39,40,0.5)","y":[57876.949999999997,46649.150000000001,44658,47028.099999999999,44294.900000000001,41846.699999999997,70982.600000000006,30334.799999999999,45972.800000000003,39382.900000000001,36641.599999999999,34048.599999999999,32237.599999999999,33449.300000000003],"boxpoints":"all","name":"Ventas día Miércoles","type":"box","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"line":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(148,103,189,0.5)","y":[47554.599999999999,40556.900000000001,63104.300000000003,31703.549999999999,47556.949999999997,42694.300000000003,49385.900000000001,45527.300000000003,34305.900000000001,32090.700000000001,43593.699999999997,40561.800000000003,43825.900000000001,39682.5],"boxpoints":"all","name":"Ventas día Jueves","type":"box","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"line":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(140,86,75,0.5)","y":[67138.199999999997,70159.100000000006,67481.300000000003,59907.400000000001,62269.099999999999,57266.199999999997,55780.699999999997,48707.400000000001,64452.800000000003,45907.900000000001,65592.100000000006,68919.899999999994,56852.300000000003,66243.800000000003],"boxpoints":"all","name":"Ventas día Viernes","type":"box","marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"line":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"fillcolor":"rgba(227,119,194,0.5)","y":[89172.699999999997,77736.800000000003,89795.300000000003,89533.399999999994,83662.699999999997,94463.100000000006,75692.100000000006,84596.300000000003,101466.5,77369.199999999997,81561.309999999998,81373.5,73606,99547.899999999994],"boxpoints":"all","name":"Ventas día Sábado","type":"box","marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"line":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-box2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.4: Boxplot de las ventas por día después de la pandemia.
</figcaption>
</figure>
</div>
</section>
</section>
</section>
<section id="identificación-de-distribuciones-de-probabilidad-de-las-ventas-por-día" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="identificación-de-distribuciones-de-probabilidad-de-las-ventas-por-día"><span class="header-section-number">6.3</span> Identificación de distribuciones de probabilidad de las ventas por día</h2>
<div style="text-align:justify">
<p>Con el fin de adaptar el modelo de Cramér Lundberg es necesario ajustar distribuciones de probabilidad de las ventas para cada día de la semana. Haciendo uso del test de Jarque Bera que ayuda a identificar cuales días siguen una distribución normal y el test de Kolmogorov de Smirnov.</p>
<p>El siguiente código aplica los diferentes test de normalidad para las ventas por día antes de la pandemia:(Citar Jarque Bera)</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcularemos los test correspondientes a los filtros</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co">#de ventas por día:</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co">#JARQUE BERA</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(fil_dat_1_before<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_1_before$Ventas
X-squared = 4.3177, df = 2, p-value = 0.1155</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#El valor p no es menor que α = .05, </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co">#entonces hay evidencia suficiente para decir </span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co">#por lo tanto los datos se distribuyen normalmente</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Se ajustara una distribuciión con el comando siguiente:</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_1_before<span class="sc">$</span>Ventas, <span class="st">"normal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      mean          sd    
  139929.468    24521.524 
 (  2675.518) (  1891.877)</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co">#JARQUE BERA</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(fil_dat_2_before<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_2_before$Ventas
X-squared = 2.7606, df = 2, p-value = 0.2515</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co">#El valor p no es menor que α = .05, </span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">#entonces hay evidencia suficiente para decir </span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co">#por lo tanto los datos se distribuyen normalmente</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Se ajustara una distribuciión con el comando siguiente:</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co">#ajustamos una distribución (normal)</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_2_before<span class="sc">$</span>Ventas, <span class="st">"normal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  48125.734   17150.338 
 ( 1917.466) ( 1355.853)</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#JARQUE BERA</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(fil_dat_3_before<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_3_before$Ventas
X-squared = 4.6048, df = 2, p-value = 0.1</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#El valor p no es menor que α = .05, </span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="co">#entonces hay evidencia suficiente para decir </span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="co">#por lo tanto los datos se distribuyen normalmente</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Se ajustara una distribuciión con el comando siguiente:</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="co">#ajustamos una distribución (normal)</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_3_before<span class="sc">$</span>Ventas, <span class="st">"normal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  44509.755   14312.338 
 ( 1590.260) ( 1124.483)</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co">#JARQUE BERA</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(fil_dat_4_before<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_4_before$Ventas
X-squared = 3.3204, df = 2, p-value = 0.1901</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co">#El valor p no es menor que α = .05, </span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co">#entonces hay evidencia suficiente para decir </span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co">#por lo tanto los datos se distribuyen normalmente</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Se ajustara una distribuciión con el comando siguiente:</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="co">#ajustamos una distribución (normal)</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_4_before<span class="sc">$</span>Ventas, <span class="st">"normal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  46904.516   16238.151 
 ( 1815.480) ( 1283.739)</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#JARQUE BERA</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(fil_dat_5_before<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_5_before$Ventas
X-squared = 4.553, df = 2, p-value = 0.1026</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#El valor p no es menor que α = .05, </span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="co">#entonces hay evidencia suficiente para decir </span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="co">#por lo tanto los datos se distribuyen normalmente</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Se ajustara una distribuciión con el comando siguiente:</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co">#ajustamos una distribución (normal)</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_5_before<span class="sc">$</span>Ventas, <span class="st">"normal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  52786.734   18403.175 
 ( 2032.291) ( 1437.047)</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#JARQUE BERA</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(fil_dat_6_before<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_6_before$Ventas
X-squared = 2.5406, df = 2, p-value = 0.2808</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#El valor p no es menor que α = .05, </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co">#entonces hay evidencia suficiente para decir </span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co">#por lo tanto los datos se distribuyen normalmente</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Se ajustara una distribuciión con el comando siguiente:</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="co">#ajustamos una distribución (normal)</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_6_before<span class="sc">$</span>Ventas, <span class="st">"normal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  81601.876   23756.037 
 ( 2591.996) ( 1832.818)</code></pre>
</div>
</div>
<div style="text-align:justify">
<p>Para el caso del día sábado, denotado como séptimo día, no se obtuvo una distribución normal por lo que se utilizo la paqueteria de R fitdistrplus para probar el ajuste de otras distribuciones clásicas de probabilidad. Las distribuciones probadas se presentan en el código siguiente:</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_7_before<span class="sc">$</span>Ventas, <span class="st">"weibull"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      shape          scale    
  3.646021e+00   1.335448e+05 
 (2.784858e-01) (4.365588e+03)</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_7_before<span class="sc">$</span>Ventas, <span class="st">"exponential"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>       rate    
  8.379989e-06 
 (8.882771e-07)</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_7_before<span class="sc">$</span>Ventas, <span class="st">"lognormal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     meanlog        sdlog   
  11.64220349    0.33374967 
 ( 0.03537739) ( 0.02501560)</code></pre>
</div>
</div>
<div style="text-align:justify">
<p>De lo anterior podemos decir que el mejor ajuste se obtuvo al usar la distribución Weibull.</p>
</div>
</div>
<section id="prueba-de-la-distribución-weibull" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="prueba-de-la-distribución-weibull"><span class="header-section-number">6.3.1</span> Prueba de la distribución Weibull:</h3>
<div style="text-align:justify">
<p>Una vez ajustada la distribución Weibull, se prueban sus parametros con la aplicación del test de Kolmogorov de Smirnov. El siguiente código implementa ambos procedimientos:</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcularemos los test correspondientes a los filtros de de ventas por día:</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co">#JARQUE BERA</span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(fil_dat_7_before<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_7_before$Ventas
X-squared = 12.707, df = 2, p-value = 0.001741</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Fitting de de una distri bución weibull</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co">#fil_dat_7_before$Ventas</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>fit.weibull <span class="ot">&lt;-</span> <span class="fu">fitdist</span>(fil_dat_7_before<span class="sc">$</span>Ventas, <span class="st">"weibull"</span>)</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>fit.weibull</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Fitting of the distribution ' weibull ' by maximum likelihood 
Parameters:
          estimate   Std. Error
shape 4.784508e+00    0.3789532
scale 1.295070e+05 3155.3275585</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>vector_ventas7_ordenados <span class="ot">&lt;-</span> fil_dat_7_before<span class="sc">$</span>Ventas[<span class="fu">order</span>(fil_dat_7_before<span class="sc">$</span>Ventas)]</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">83</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>F_x <span class="ot">=</span> <span class="fu">numeric</span>(n)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  F_x[i] <span class="ot">&lt;-</span> (i<span class="sc">/</span> n)</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co">#F_x</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>f_gorro_x <span class="ot">&lt;-</span>  <span class="fu">pweibull</span>(vector_ventas7_ordenados,</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>                       <span class="at">shape =</span> <span class="fl">4.784508e+00</span>, <span class="at">scale =</span><span class="fl">1.295070e+05</span>, </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>                       <span class="at">lower.tail =</span> <span class="cn">TRUE</span>, <span class="at">log.p =</span> <span class="cn">FALSE</span>)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>ks <span class="ot">&lt;-</span> <span class="fu">abs</span>(F_x <span class="sc">-</span> f_gorro_x)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="representación-gráfica-al-aplicar-el-test-de-kolmogorov-de-smirnov" class="level4" data-number="6.3.1.1">
<h4 data-number="6.3.1.1" class="anchored" data-anchor-id="representación-gráfica-al-aplicar-el-test-de-kolmogorov-de-smirnov"><span class="header-section-number">6.3.1.1</span> Representación gráfica al aplicar el test de Kolmogorov de Smirnov</h4>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1936014</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.1492794</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">83</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>g1 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">83</span>, F_x) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Estudio_caso_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>g2 <span class="ot">&lt;-</span> <span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">83</span>, f_gorro_x) </span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Estudio_caso_files/figure-html/unnamed-chunk-27-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, F_x, <span class="at">col=</span><span class="st">'red'</span>, <span class="at">xlab=</span><span class="st">'x'</span>, <span class="at">ylab=</span><span class="st">'y'</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co">#add second line to plot </span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(x, f_gorro_x, <span class="at">col=</span><span class="st">'blue'</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Estudio_caso_files/figure-html/unnamed-chunk-27-3.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div style="text-align:justify">
<p>Para el periodo despues de pandemia se repite la misma metodología. Aplicamos el test de Jarque Bera a los datos para cada día de la semana después de pandemia.</p>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_1_after$Ventas
X-squared = 0.24366, df = 2, p-value = 0.8853</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>      mean          sd    
  101919.050    10877.075 
 (  2907.021) (  2055.574)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_2_after$Ventas
X-squared = 0.65149, df = 2, p-value = 0.722</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  39841.721    7873.446 
 ( 2104.267) ( 1487.941)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_3_after$Ventas
X-squared = 0.39157, df = 2, p-value = 0.8222</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  41751.747    5687.030 
 ( 1468.385) ( 1038.305)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_4_after$Ventas
X-squared = 3.8727, df = 2, p-value = 0.1442</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  43243.143   10517.841 
 ( 2811.011) ( 1987.685)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_5_after$Ventas
X-squared = 2.0444, df = 2, p-value = 0.3598</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  43010.307    7741.889 
 ( 2069.107) ( 1463.080)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_6_after$Ventas
X-squared = 1.4585, df = 2, p-value = 0.4823</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  61191.300    7202.989 
 ( 1925.080) ( 1361.237)</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_7_after$Ventas
X-squared = 0.85511, df = 2, p-value = 0.6521</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  85684.058    8371.359 
 ( 2237.340) ( 1582.038)</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="co">#_______Después de la pandemia____________________________________</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="co">#El valor p no es menor que α = .05, </span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="co">#entonces hay evidencia suficiente para decir </span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="co">#que la muestra  proviene de una población con distribución normal.</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a><span class="co">#JARQUE BERA</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(fil_dat_1_after<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_1_after$Ventas
X-squared = 0.24366, df = 2, p-value = 0.8853</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_1_after<span class="sc">$</span>Ventas, <span class="st">"normal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      mean          sd    
  101919.050    10877.075 
 (  2907.021) (  2055.574)</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#________________________________________________________________</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcularemos los test correspondientes </span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co">#a los filtros de de ventas por día:</span></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="co">#El valor p no es menor que α = .05, </span></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="co">#entonces hay evidencia suficiente para decir </span></span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co">#que la muestra proviene de una población con distribución normal.</span></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="co">#JARQUE BERA</span></span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(fil_dat_2_after<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_2_after$Ventas
X-squared = 0.65149, df = 2, p-value = 0.722</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_2_after<span class="sc">$</span>Ventas, <span class="st">"normal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  39841.721    7873.446 
 ( 2104.267) ( 1487.941)</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co">#________________________________________________________________</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcularemos los test correspondientes </span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="co"># a los filtros de de ventas por día:</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="co">#El valor p no es menor que α = .05, </span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a><span class="co">#entonces hay evidencia suficiente para decir </span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="co">#que la muestra proviene de una población con distribución normal.</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a><span class="co">#JARQUE BERA</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(fil_dat_3_after<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_3_after$Ventas
X-squared = 0.39157, df = 2, p-value = 0.8222</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_3_after<span class="sc">$</span>Ventas, <span class="st">"normal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  41751.747    5687.030 
 ( 1468.385) ( 1038.305)</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co">#________________________________________________________________</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcularemos los test correspondientes </span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="co"># a los filtros de de ventas por día:</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="co">#El valor p no es menor que α = .05, </span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="co">#entonces hay evidencia suficiente para decir </span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="co">#que la muestra proviene de una población con distribución normal.</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="co">#JARQUE BERA</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(fil_dat_4_after<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_4_after$Ventas
X-squared = 3.8727, df = 2, p-value = 0.1442</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_4_after<span class="sc">$</span>Ventas, <span class="st">"normal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  43243.143   10517.841 
 ( 2811.011) ( 1987.685)</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co">#________________________________________________________________</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcularemos los test correspondientes </span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="co"># a los filtros de de ventas por día:</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="co">#El valor p no es menor que α = .05, </span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="co">#entonces hay evidencia suficiente para decir </span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a><span class="co">#que la muestra proviene de una población con distribución normal.</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="co">#JARQUE BERA</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(fil_dat_5_after<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_5_after$Ventas
X-squared = 2.0444, df = 2, p-value = 0.3598</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_5_after<span class="sc">$</span>Ventas, <span class="st">"normal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  43010.307    7741.889 
 ( 2069.107) ( 1463.080)</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co">#________________________________________________________________</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcularemos los test correspondientes </span></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># a los filtros de de ventas por día:</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="co"># El valor p no es menor que α = .05, </span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="co">#entonces hay evidencia suficiente para decir </span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="co">#que la muestra proviene de una población con distribución normal.</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="co">#JARQUE BERA</span></span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(fil_dat_6_after<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_6_after$Ventas
X-squared = 1.4585, df = 2, p-value = 0.4823</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_6_after<span class="sc">$</span>Ventas, <span class="st">"normal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  61191.300    7202.989 
 ( 1925.080) ( 1361.237)</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co">#________________________________________________________________</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Calcularemos los test correspondientes </span></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="co"># a los filtros de de ventas por día:</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="co">#El valor p no es menor que α = .05, </span></span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a><span class="co">#entonces hay evidencia suficiente para decir </span></span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a><span class="co">#que la muestra proviene de una población con distribución normal.</span></span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a><span class="fu">jarque.bera.test</span>(fil_dat_7_after<span class="sc">$</span>Ventas)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Jarque Bera Test

data:  fil_dat_7_after$Ventas
X-squared = 0.85511, df = 2, p-value = 0.6521</code></pre>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Se ajustara una distribución con el comando siguiente:</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a><span class="fu">fitdistr</span>(fil_dat_7_after<span class="sc">$</span>Ventas, <span class="st">"normal"</span>)</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>     mean         sd    
  85684.058    8371.359 
 ( 2237.340) ( 1582.038)</code></pre>
</div>
</div>
<div style="text-align:justify">
<p>Con las distribuciones identificadas de las ventas por día en los dos periodos, ahora es posible simular las variables aleatorias de las ventas de cada día de la semana y por lo tanto simular las ganancias de toda la semana.</p>
</div>
</section>
</section>
</section>
<section id="modelo-modificado-de-cramér-lundberg-para-identificar-la-probabilidad-de-las-ganancias-insuficientes-en-una-empresa-de-comida-rápida" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="modelo-modificado-de-cramér-lundberg-para-identificar-la-probabilidad-de-las-ganancias-insuficientes-en-una-empresa-de-comida-rápida"><span class="header-section-number">6.4</span> Modelo Modificado de Cramér-Lundberg para identificar la probabilidad de las ganancias insuficientes en una empresa de comida rápida</h2>
<div style="text-align:justify">
<p>Como ya se vio en la sección (<a href="Modelo_de_Cramer_Lundberg.html" class="quarto-xref"><span>Capítulo 5</span></a>) el Modelo de Cramér-Lundberg (MCL)es una herramienta utilizada en el campo de la gestión de riesgos y las finanzas para evaluar la probabilidad de incumplimiento o pérdidas insuficientes en una empresa. Aunque no es específicamente diseñado para analizar la variación de las ganancias de una empresa, en particular una empresa de comida rápida, se propone en este trabajo una adaptación del modelo, para evaluar la probabilidad de ganancias en este tipo de negocio, que puede facilitar el análisis de la evolución financiera de la empresa.</p>
<p>Para ello la ecuación general del modelo modificado que representa la evolución de las ganancias en el tiempo hasta la semana <span class="math inline">\(t\)</span>, denotada por <span class="math inline">\(G\)</span> queda definida como: <span id="eq-4.1"><span class="math display">\[G(t) = u -ct + V(t), \ \ t = 1, 2, 3, ... \tag{6.1}\]</span></span></p>
<div style="text-align:justify">
<p>la cual se estudiara en los periodos de tiempo (pre-pandemia, pos-pandemia).</p>
</div>
<ul>
<li><p><span class="math inline">\(V(t)\)</span>: son los ingresos de las ganancias por día para cada semana.</p></li>
<li><p><span class="math inline">\(c\)</span> : Son los costos de las obligaciones financieras del inversionista, como prestamos, pagos por adquisición de la franquicia, compras de equipos inmobiliarios, pagos de empleados, etc.</p></li>
<li><p><span class="math inline">\(u \geq 0\)</span> : Es el capital inicial con el cual inicia la empresa a trabajar.</p></li>
</ul>
</div>
<section id="caso-pre-pandemia" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="caso-pre-pandemia"><span class="header-section-number">6.4.1</span> Caso pre-pandemia</h3>
<div style="text-align:justify">
<p>Para la implementación del modelo modificado Cramér-Lundberg con los datos antes de la pandemia se hizo la simulación de las variables aleatorias mediante las distribuciones de las ventas por día tomado como las ganancias acumuladas, y se estimó los parámetros de <span class="math inline">\(u\)</span> y <span class="math inline">\(c\)</span>, por lo que el modelo es determinista y se incrementa por semana.</p>
</div>
<section id="modelo-de-cramér-lundberg-simulado-en-r-con-datos-reales-de-las-ventas-por-día-de-la-empresa." class="level4" data-number="6.4.1.1">
<h4 data-number="6.4.1.1" class="anchored" data-anchor-id="modelo-de-cramér-lundberg-simulado-en-r-con-datos-reales-de-las-ventas-por-día-de-la-empresa."><span class="header-section-number">6.4.1.1</span> Modelo de Cramér-Lundberg simulado en R con datos reales de las ventas por día de la empresa.</h4>
<div style="text-align:justify">
<p>En la (<a href="#fig-trayectoria" class="quarto-xref">Figura&nbsp;<span>6.5</span></a>) se muestra la trayectoria del modelo bajo los supuestos del modelo modificado, el proceso comienza con <span class="math inline">\(t = 90\)</span>, que son las <span class="math inline">\(90\)</span> semanas de de las ventas registradas por día antes del cierre pandemico, con un capital inicial de <span class="math inline">\(u= 1759629\)</span>, una tasa de <span class="math inline">\(c= 0.29\)</span>, los montos de las ganancias tienen distribución normal (<span class="math inline">\(N\)</span>) y weibull (<span class="math inline">\(W\)</span>).</p>
<p>El código que genera la trayectoria es el siguiente:</p>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulación Modelo Clásico de Cramér-Lundberg </span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co">#para tres meses: Antes de la pandemia</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Con los datos reales de la empresa</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># librería para poder renombrar las cabeceras </span></span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co"># de los dataframes</span></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="co">#Parámetros</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co">#semilla fija</span></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="dv">1759629</span> <span class="co">#surplus(capital inicial de salvamento)</span></span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Es un estimado a partir de la media de las ganancias por semana, </span></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="co">#multiplicado por 10/3, </span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a><span class="co">#siendo una proporción para evitar la ruina</span></span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a><span class="co"># u (sum(medias))*(10/3)</span></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span><span class="fl">0.29</span><span class="sc">*</span>u <span class="co">#prima de pago cada timepo t. c=0.5*u</span></span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a>t_final <span class="ot">=</span> <span class="dv">90</span></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a><span class="co"># S(t) = \sum_{i=1}^{N(t)}X_i</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="co">#donde N(t)~ Poisson (lambda*t)</span></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a><span class="co"># X_i ~ exponencial (lambda_Xi)</span></span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a><span class="co">#CL = REPRESENTA EL MODELO DE CRAMER LUNDBERG</span></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulación de trayectoria de CL_t, cuando t &lt; t_final.</span></span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>trayectoria_CLt <span class="ot">&lt;-</span> <span class="cf">function</span>(u, c, t_final)</span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>  tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a>  Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(u)</span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">&lt;</span> t_final)</span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>    tiempo_llegada <span class="ot">&lt;-</span> (<span class="dv">1</span>)</span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>  Y_i <span class="ot">&lt;-</span>  (<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">139929.468</span>, <span class="at">sd =</span> <span class="fl">24521.524</span> ) <span class="sc">+</span> </span>
<span id="cb114-30"><a href="#cb114-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">48125.734</span> , <span class="at">sd=</span><span class="fl">17150.338</span> ) <span class="sc">+</span>  </span>
<span id="cb114-31"><a href="#cb114-31" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">44509.755</span>, <span class="at">sd =</span> <span class="fl">14312.338</span> ) <span class="sc">+</span> </span>
<span id="cb114-32"><a href="#cb114-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">46904.516</span>, <span class="at">sd =</span> <span class="fl">16238.151</span> ) <span class="sc">+</span> </span>
<span id="cb114-33"><a href="#cb114-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">52786.734</span>  , <span class="at">sd =</span> <span class="fl">18403.17</span> ) <span class="sc">+</span> </span>
<span id="cb114-34"><a href="#cb114-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">118645.9</span>  , <span class="at">sd =</span> <span class="fl">36530.24</span>) <span class="sc">+</span> </span>
<span id="cb114-35"><a href="#cb114-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rweibull</span>(<span class="dv">1</span>,  <span class="at">shape =</span> <span class="fl">4.784508e+00</span>, <span class="at">scale =</span> <span class="fl">1.295070e+05</span> ) ) </span>
<span id="cb114-36"><a href="#cb114-36" aria-hidden="true" tabindex="-1"></a>    tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(tiempo, tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span> </span>
<span id="cb114-37"><a href="#cb114-37" aria-hidden="true" tabindex="-1"></a>                tiempo_llegada,tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span> tiempo_llegada ) </span>
<span id="cb114-38"><a href="#cb114-38" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(Cramer_trayectoria,</span>
<span id="cb114-39"><a href="#cb114-39" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span> c<span class="sc">*</span>tiempo_llegada,</span>
<span id="cb114-40"><a href="#cb114-40" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span> c<span class="sc">*</span>tiempo_llegada <span class="sc">+</span>  Y_i )</span>
<span id="cb114-41"><a href="#cb114-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="dv">0</span>){</span>
<span id="cb114-42"><a href="#cb114-42" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb114-43"><a href="#cb114-43" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb114-44"><a href="#cb114-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb114-45"><a href="#cb114-45" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb114-46"><a href="#cb114-46" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb114-47"><a href="#cb114-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb114-48"><a href="#cb114-48" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tiempo, Cramer_trayectoria)</span>
<span id="cb114-49"><a href="#cb114-49" aria-hidden="true" tabindex="-1"></a>  df_trayectoria <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df<span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Tiempo =</span> tiempo, <span class="at">Ct =</span> Cramer_trayectoria))</span>
<span id="cb114-50"><a href="#cb114-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_trayectoria)</span>
<span id="cb114-51"><a href="#cb114-51" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb114-52"><a href="#cb114-52" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-53"><a href="#cb114-53" aria-hidden="true" tabindex="-1"></a>trayectoria <span class="ot">&lt;-</span> <span class="fu">trayectoria_CLt</span>(u,c, t_final )</span>
<span id="cb114-54"><a href="#cb114-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-55"><a href="#cb114-55" aria-hidden="true" tabindex="-1"></a><span class="co">#Intalación de plotly usando github</span></span>
<span id="cb114-56"><a href="#cb114-56" aria-hidden="true" tabindex="-1"></a><span class="co">#devtools::install_github("ropensci/plotly")</span></span>
<span id="cb114-57"><a href="#cb114-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-58"><a href="#cb114-58" aria-hidden="true" tabindex="-1"></a>fig_tr<span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(trayectoria, <span class="at">x =</span> <span class="sc">~</span>Tiempo, <span class="at">y =</span> <span class="sc">~</span>Ct, </span>
<span id="cb114-59"><a href="#cb114-59" aria-hidden="true" tabindex="-1"></a><span class="at">name =</span> <span class="st">"Ganancias: G(t)"</span>, <span class="at">type =</span> <span class="st">"scatter"</span>, <span class="at">mode =</span> <span class="st">"lines"</span>)</span>
<span id="cb114-60"><a href="#cb114-60" aria-hidden="true" tabindex="-1"></a>fig_tr <span class="ot">&lt;-</span> fig_tr <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>Tiempo, <span class="at">y =</span> u,  </span>
<span id="cb114-61"><a href="#cb114-61" aria-hidden="true" tabindex="-1"></a><span class="at">name =</span> <span class="st">"Capital inicial: u"</span>, <span class="at">type =</span> <span class="st">"scatter"</span>, <span class="at">mode =</span> <span class="st">"lines"</span>)</span>
<span id="cb114-62"><a href="#cb114-62" aria-hidden="true" tabindex="-1"></a>fig_tr</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-trayectoria" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trayectoria-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-ec3fc2734ed504c380c7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ec3fc2734ed504c380c7">{"x":{"visdat":{"503036c9371e":["function () ","plotlyVisDat"]},"cur_data":"503036c9371e","attrs":{"503036c9371e":{"x":{},"y":{},"mode":"lines","name":"Ganancias: G(t)","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"503036c9371e.1":{"x":{},"y":1759629,"mode":"lines","name":"Capital inicial: u","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Tiempo"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Ct"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,30,30,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,39,39,40,40,41,41,42,42,43,43,44,44,45,45,46,46,47,47,48,48,49,49,50,50,51,51,52,52,53,53,54,54,55,55,56,56,57,57,58,58,59,59,60,60,61,61,62,62,63,63,64,64,65,65,66,66,67,67,68,68,69,69,70,70,71,71,72,72,73,73,74,74,75,75,76,76,77,77,78,78,79,79,80,80,81,81,82,82,83,83,84,84,85,85,86,86,87,87,88,88,89,89,90,90],"y":[1759629,1249336.5900000001,1832880.6822444811,1322588.2722444811,1855112.2888705537,1344819.8788705538,1925598.0309040393,1415305.6209040394,1915801.5247984878,1405509.1147984879,2002272.8877856857,1491980.4777856858,2113428.0769832502,1603135.6669832503,2162309.6937585808,1652017.2837585809,2292824.5189792304,1782532.1089792305,2307457.0541502009,1797164.644150201,2208948.989366909,1698656.5793669091,2268307.893683468,1758015.4836834681,2331470.3184298053,1821177.9084298054,2490354.6467446457,1980062.2367446458,2545147.9447438847,2034855.5347438848,2489878.6231902507,1979586.2131902508,2520841.0138409617,2010548.6038409618,2540125.5606337981,2029833.1506337982,2656956.1734054545,2146663.7634054543,2676939.0837648222,2166646.6737648221,2684922.2435795716,2174629.8335795715,2682933.7168177865,2172641.3068177863,2736898.6203202917,2226606.2103202916,2821746.8701886684,2311454.4601886682,2923846.6280742753,2413554.2180742752,2895001.0661772392,2384708.656177239,2982801.6272363537,2472509.2172363536,3048323.2785010939,2538030.8685010937,3143565.8452191339,2633273.4352191337,3160103.9043891015,2649811.4943891014,3320501.0181715349,2810208.6081715347,3356553.6095439796,2846261.1995439795,3488358.0259425174,2978065.6159425173,3484572.2664394705,2974279.8564394703,3582972.6353641669,3072680.2253641668,3571030.3609016109,3060737.9509016108,3676284.9563294798,3165992.5463294797,3814486.8889316749,3304194.4789316747,3816771.8516562181,3306479.4416562179,3857370.5339756026,3347078.1239756024,4001749.6857332978,3491457.2757332977,4068819.4669196522,3558527.056919652,4017069.5499255713,3506777.1399255712,4037000.9624480694,3526708.5524480692,4165400.0189986769,3655107.6089986768,4326785.5482281176,3816493.1382281175,4390990.8799053412,3880698.469905341,4420608.1141294884,3910315.7041294882,4531319.5797858061,4021027.169785806,4612940.0867484678,4102647.6767484676,4693965.9003745252,4183673.4903745251,4845079.9385874616,4334787.5285874614,4908333.7058855845,4398041.2958855843,4970414.795649861,4460122.3856498608,5005145.8627808075,4494853.4527808074,5049421.6671620458,4539129.2571620457,5114403.6445260998,4604111.2345260996,5111934.3997567846,4601641.9897567844,5058230.2735307198,4547937.8635307197,5168485.2264685743,4658192.8164685741,5150802.7257482903,4640510.3157482902,5240128.1037214268,4729835.6937214267,5321470.6466655144,4811178.2366655143,5416003.1733630747,4905710.7633630745,5440612.8521793541,4930320.4421793539,5483693.0084427623,4973400.5984427622,5582849.571242935,5072557.1612429349,5656638.9530027797,5146346.5430027796,5733750.2412165599,5223457.8312165597,5763517.980975084,5253225.5709750839,5876561.8623627797,5366269.4523627795,5911735.6305888854,5401443.2205888852,6007191.876554708,5496899.4665547078,6090794.3155563455,5580501.9055563454,6109468.6998220868,5599176.2898220867,6076582.945709792,5566290.5357097918,6159989.5346669406,5649697.1246669404,6196343.2301260764,5686050.8201260762,6318801.3819725942,5808508.971972594,6399023.4227396715,5888731.0127396714,6406016.2389884628,5895723.8289884627,6502697.0988894757,5992404.6888894755,6555940.4150587991,6045648.0050587989,6575010.6188009251,6064718.2088009249,6690405.3644782836,6180112.9544782834,6732334.5610546209,6222042.1510546207,6788827.9267860502,6278535.5167860501,6895197.5176123045,6384905.1076123044,6954426.6368333297,6444134.2268333295,6960068.3410152392,6449775.9310152391,6996856.8069571666],"mode":"lines","name":"Ganancias: G(t)","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14,15,15,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,30,30,31,31,32,32,33,33,34,34,35,35,36,36,37,37,38,38,39,39,40,40,41,41,42,42,43,43,44,44,45,45,46,46,47,47,48,48,49,49,50,50,51,51,52,52,53,53,54,54,55,55,56,56,57,57,58,58,59,59,60,60,61,61,62,62,63,63,64,64,65,65,66,66,67,67,68,68,69,69,70,70,71,71,72,72,73,73,74,74,75,75,76,76,77,77,78,78,79,79,80,80,81,81,82,82,83,83,84,84,85,85,86,86,87,87,88,88,89,89,90,90],"y":[1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629],"mode":"lines","name":"Capital inicial: u","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trayectoria-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.5: Trayectoria del proceso de evolución del modelo modificado de Cramér Lundberg antes de la pandemia.
</figcaption>
</figure>
</div>
</section>
<section id="probabilidad-de-ruina" class="level4" data-number="6.4.1.2">
<h4 data-number="6.4.1.2" class="anchored" data-anchor-id="probabilidad-de-ruina"><span class="header-section-number">6.4.1.2</span> Probabilidad de ruina</h4>
<div style="text-align:justify">
<p>Con la simulación de la variable aleatoria <span class="math inline">\(G(t)\)</span>, es posible ahora calcular la probabilidad de ruina, utilizando el método de Monte Carlo(citar).</p>
<p>Para ello, se quiere analizar el momento en el que <span class="math inline">\(G(t)\leq u\)</span>, es decir cuando la ganancia al final de la semana <span class="math inline">\(t\)</span> es menor al capital inicial. Cuando <span class="math inline">\(G(t)\leq0\)</span>, se alcanza como la ruina de la empresa, para ambos casos se utiliza la comparación con la tasa de interés para préstamos bancarios de <span class="math inline">\(0.8\)</span> anual.</p>
<p>El código para simular la probabilidad de las ganancias finales bajas es el siguiente:</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulación de la probabilidad de ruina: Antes de la pandemia</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Con los datos reales de la empresa</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># librería para poder renombrar </span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="co">#las cabeceras de los dataframes</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Parámetros</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co">#semilla fija</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="dv">1759629</span> <span class="co">#surplus(capital inicial de salvamento)</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Es un estimado a partir de la media de las ganancias por semana, </span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="co">#multiplicado por 10/3, </span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="co">#siendo una proporción para evitar la ruina</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a><span class="co"># u (sum(medias))*(10/3)</span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fl">0.29</span><span class="sc">*</span>u <span class="co">#prima de pago cada tiempo t. c=0.5*u</span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a>lambda_Nt <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a><span class="co">#lambda_Xi = 3</span></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a>t_final <span class="ot">=</span> <span class="dv">48</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="dv">1</span> <span class="co">#tiempos entrellegadas constantes</span></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a>trayectoria_CLt <span class="ot">&lt;-</span> <span class="cf">function</span>(u, c, lambda_Nt, t_final)</span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a>  tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a>  Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(u)</span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">&lt;</span> t_final)</span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a>    tiempo_llegada <span class="ot">&lt;-</span> (<span class="dv">1</span>) </span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Suponiendo los tiempos entrellegadas constantes \mu = 1</span></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a>    Y_i <span class="ot">&lt;-</span>  (<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">139929.468</span>, <span class="at">sd =</span> <span class="fl">24521.524</span> ) <span class="sc">+</span> </span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">48125.734</span> , <span class="at">sd=</span><span class="fl">17150.338</span> ) <span class="sc">+</span>  </span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">44509.755</span>, <span class="at">sd =</span> <span class="fl">14312.338</span> ) <span class="sc">+</span> </span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">46904.516</span>, <span class="at">sd =</span> <span class="fl">16238.151</span> ) <span class="sc">+</span> </span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">52786.734</span>  , <span class="at">sd =</span> <span class="fl">18403.17</span> ) <span class="sc">+</span> </span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">118645.9</span>  , <span class="at">sd =</span> <span class="fl">36530.24</span>) <span class="sc">+</span></span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rweibull</span>(<span class="dv">1</span>,  <span class="at">shape =</span> <span class="fl">4.784508e+00</span>, <span class="at">scale =</span> <span class="fl">1.295070e+05</span>)) </span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a>    tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(tiempo, tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span></span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>                  tiempo_llegada,tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span> </span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a>                  tiempo_llegada ) </span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria <span class="ot">&lt;-</span><span class="fu">c</span>(Cramer_trayectoria,</span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a>                Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span></span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a>                  c<span class="sc">*</span>tiempo_llegada,</span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a>                Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span></span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a>                  c<span class="sc">*</span>tiempo_llegada <span class="sc">+</span>  Y_i )</span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="dv">0</span>){</span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb115-44"><a href="#cb115-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb115-45"><a href="#cb115-45" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb115-46"><a href="#cb115-46" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb115-47"><a href="#cb115-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb115-48"><a href="#cb115-48" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.08*u es la ganancia inferior a la de un tasa de </span></span>
<span id="cb115-49"><a href="#cb115-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">#un título financiero </span></span>
<span id="cb115-50"><a href="#cb115-50" aria-hidden="true" tabindex="-1"></a><span class="co">#para el año 2018</span></span>
<span id="cb115-51"><a href="#cb115-51" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="fl">1.08</span><span class="sc">*</span>u) {</span>
<span id="cb115-52"><a href="#cb115-52" aria-hidden="true" tabindex="-1"></a>    ganancia_no_deseada <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb115-53"><a href="#cb115-53" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb115-54"><a href="#cb115-54" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb115-55"><a href="#cb115-55" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb115-56"><a href="#cb115-56" aria-hidden="true" tabindex="-1"></a>    ganancia_no_deseada <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb115-57"><a href="#cb115-57" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb115-58"><a href="#cb115-58" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tiempo, Cramer_trayectoria)</span>
<span id="cb115-59"><a href="#cb115-59" aria-hidden="true" tabindex="-1"></a>  df_trayectoria <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df<span class="sc">%&gt;%</span>rename</span>
<span id="cb115-60"><a href="#cb115-60" aria-hidden="true" tabindex="-1"></a>                               (<span class="at">Tiempo =</span> tiempo, </span>
<span id="cb115-61"><a href="#cb115-61" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Ct =</span> Cramer_trayectoria))</span>
<span id="cb115-62"><a href="#cb115-62" aria-hidden="true" tabindex="-1"></a>  salida <span class="ot">&lt;-</span> <span class="fu">c</span>(ruina, ganancia_no_deseada)</span>
<span id="cb115-63"><a href="#cb115-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(salida)</span>
<span id="cb115-64"><a href="#cb115-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-65"><a href="#cb115-65" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb115-66"><a href="#cb115-66" aria-hidden="true" tabindex="-1"></a>trayectoria <span class="ot">&lt;-</span> <span class="fu">trayectoria_CLt</span>(u,c,lambda_Nt, t_final )</span>
<span id="cb115-67"><a href="#cb115-67" aria-hidden="true" tabindex="-1"></a><span class="co">#Método de monte carlo para estimar </span></span>
<span id="cb115-68"><a href="#cb115-68" aria-hidden="true" tabindex="-1"></a><span class="co">#la probabilidad de las ganancias bajas</span></span>
<span id="cb115-69"><a href="#cb115-69" aria-hidden="true" tabindex="-1"></a>n_replicaciones <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb115-70"><a href="#cb115-70" aria-hidden="true" tabindex="-1"></a>r_baja_ganancia <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_replicaciones,</span>
<span id="cb115-71"><a href="#cb115-71" aria-hidden="true" tabindex="-1"></a><span class="fu">trayectoria_CLt</span>(u, c, lambda_Nt, t_final)</span>
<span id="cb115-72"><a href="#cb115-72" aria-hidden="true" tabindex="-1"></a>[<span class="dv">2</span>])</span>
<span id="cb115-73"><a href="#cb115-73" aria-hidden="true" tabindex="-1"></a><span class="co">#r_baja_ganancia </span></span>
<span id="cb115-74"><a href="#cb115-74" aria-hidden="true" tabindex="-1"></a>prob_baja_ganancia <span class="ot">&lt;-</span> <span class="fu">sum</span>(r_baja_ganancia <span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">/</span>n_replicaciones</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div style="text-align:justify">
<p>Es claro que la evolución de <span class="math inline">\(G(t)\)</span> antes de la pandemia genera una probabilidad de ganancias bajas cero.</p>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div style="text-align:justify">
<p>El código para calcular la probabilidad de ruina es el siguiente:</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulación de la probabilidad de ruina: Antes de la pandemia</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Con los datos reales de la empresa</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># libreria para poder renombrar </span></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="co">#las cabeceras de los dataframes</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Parametros</span></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co">#semilla fija</span></span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="dv">1759629</span> <span class="co">#surplus(capital inicial de salvamento)</span></span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Es un estimado a partir de la media de las ganancias por semana, </span></span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a><span class="co">#multiplicado por 10/3, </span></span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a><span class="co">#siendo una proporción para evitar la ruina</span></span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a><span class="co"># u (sum(medias))*(10/3)</span></span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fl">0.29</span><span class="sc">*</span>u <span class="co">#prima de pago cada tiempo t. c=0.5*u</span></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>lambda_Nt <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="co">#lambda_Xi = 3</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a>t_final <span class="ot">=</span> <span class="dv">48</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="dv">1</span> <span class="co">#tiempos entrellegadas constantes</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a>trayectoria_CLt <span class="ot">&lt;-</span> <span class="cf">function</span>(u, c, lambda_Nt, t_final)</span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a>  tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a>  Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(u)</span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">&lt;</span> t_final)</span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a>    tiempo_llegada <span class="ot">&lt;-</span> (<span class="dv">1</span>) </span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Suponiendo los tiempos entrellegadas constantes \mu = 1</span></span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a>    Y_i <span class="ot">&lt;-</span>  (<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">139929.468</span>, <span class="at">sd =</span> <span class="fl">24521.524</span> ) <span class="sc">+</span></span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">48125.734</span> , <span class="at">sd=</span><span class="fl">17150.338</span> )   <span class="sc">+</span>  </span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">44509.755</span>, <span class="at">sd =</span> <span class="fl">14312.338</span> ) <span class="sc">+</span> </span>
<span id="cb117-29"><a href="#cb117-29" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">46904.516</span>, <span class="at">sd =</span> <span class="fl">16238.151</span>) <span class="sc">+</span> </span>
<span id="cb117-30"><a href="#cb117-30" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">52786.734</span>  , <span class="at">sd =</span> <span class="fl">18403.17</span> ) <span class="sc">+</span></span>
<span id="cb117-31"><a href="#cb117-31" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">118645.9</span>  , <span class="at">sd =</span> <span class="fl">36530.24</span>)   <span class="sc">+</span> </span>
<span id="cb117-32"><a href="#cb117-32" aria-hidden="true" tabindex="-1"></a>             <span class="fu">rweibull</span>(<span class="dv">1</span>,  <span class="at">shape =</span> <span class="fl">4.784508e+00</span>, <span class="at">scale =</span> <span class="fl">1.295070e+05</span>)) </span>
<span id="cb117-33"><a href="#cb117-33" aria-hidden="true" tabindex="-1"></a>    tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(tiempo, tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span></span>
<span id="cb117-34"><a href="#cb117-34" aria-hidden="true" tabindex="-1"></a>                  tiempo_llegada,tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span> </span>
<span id="cb117-35"><a href="#cb117-35" aria-hidden="true" tabindex="-1"></a>                  tiempo_llegada ) </span>
<span id="cb117-36"><a href="#cb117-36" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria <span class="ot">&lt;-</span><span class="fu">c</span>(Cramer_trayectoria,</span>
<span id="cb117-37"><a href="#cb117-37" aria-hidden="true" tabindex="-1"></a>                Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span></span>
<span id="cb117-38"><a href="#cb117-38" aria-hidden="true" tabindex="-1"></a>                             c<span class="sc">*</span>tiempo_llegada,</span>
<span id="cb117-39"><a href="#cb117-39" aria-hidden="true" tabindex="-1"></a>                Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span></span>
<span id="cb117-40"><a href="#cb117-40" aria-hidden="true" tabindex="-1"></a>                             c<span class="sc">*</span>tiempo_llegada <span class="sc">+</span>  Y_i )</span>
<span id="cb117-41"><a href="#cb117-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="dv">0</span>){</span>
<span id="cb117-42"><a href="#cb117-42" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb117-43"><a href="#cb117-43" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb117-44"><a href="#cb117-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb117-45"><a href="#cb117-45" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb117-46"><a href="#cb117-46" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb117-47"><a href="#cb117-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb117-48"><a href="#cb117-48" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.08*u es la ganancia inferior a la de un tasa de</span></span>
<span id="cb117-49"><a href="#cb117-49" aria-hidden="true" tabindex="-1"></a><span class="co"># un título financiero para el año 2018</span></span>
<span id="cb117-50"><a href="#cb117-50" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="fl">1.08</span><span class="sc">*</span>u) {</span>
<span id="cb117-51"><a href="#cb117-51" aria-hidden="true" tabindex="-1"></a>    ganancia_no_deseada <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb117-52"><a href="#cb117-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb117-53"><a href="#cb117-53" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb117-54"><a href="#cb117-54" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb117-55"><a href="#cb117-55" aria-hidden="true" tabindex="-1"></a>    ganancia_no_deseada <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb117-56"><a href="#cb117-56" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb117-57"><a href="#cb117-57" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tiempo, Cramer_trayectoria)</span>
<span id="cb117-58"><a href="#cb117-58" aria-hidden="true" tabindex="-1"></a>  df_trayectoria <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df<span class="sc">%&gt;%</span> rename</span>
<span id="cb117-59"><a href="#cb117-59" aria-hidden="true" tabindex="-1"></a>                               (<span class="at">Tiempo =</span> tiempo, </span>
<span id="cb117-60"><a href="#cb117-60" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">Ct =</span> Cramer_trayectoria))</span>
<span id="cb117-61"><a href="#cb117-61" aria-hidden="true" tabindex="-1"></a>  salida <span class="ot">&lt;-</span> <span class="fu">c</span>(ruina, ganancia_no_deseada)</span>
<span id="cb117-62"><a href="#cb117-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(salida)</span>
<span id="cb117-63"><a href="#cb117-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb117-64"><a href="#cb117-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb117-65"><a href="#cb117-65" aria-hidden="true" tabindex="-1"></a>trayectoria <span class="ot">&lt;-</span> <span class="fu">trayectoria_CLt</span>(u,c,lambda_Nt, t_final )</span>
<span id="cb117-66"><a href="#cb117-66" aria-hidden="true" tabindex="-1"></a><span class="co">#Método de monte carlo para estimar la probabilidad de ruina</span></span>
<span id="cb117-67"><a href="#cb117-67" aria-hidden="true" tabindex="-1"></a>n_replicaciones <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb117-68"><a href="#cb117-68" aria-hidden="true" tabindex="-1"></a>r_ruina <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_replicaciones, </span>
<span id="cb117-69"><a href="#cb117-69" aria-hidden="true" tabindex="-1"></a>            <span class="fu">trayectoria_CLt</span>(u, c, lambda_Nt, t_final)[<span class="dv">1</span>])</span>
<span id="cb117-70"><a href="#cb117-70" aria-hidden="true" tabindex="-1"></a><span class="co">#r_ruina</span></span>
<span id="cb117-71"><a href="#cb117-71" aria-hidden="true" tabindex="-1"></a>prob_ruin <span class="ot">&lt;-</span> <span class="fu">sum</span>(r_ruina<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">/</span>n_replicaciones</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div style="text-align:justify">
<p>En efecto la evolución de <span class="math inline">\(G(t)\)</span> antes de la pandemia genera una probabilidad ruina cero.</p>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</section>
<section id="análisis-de-sensibilidad" class="level4" data-number="6.4.1.3">
<h4 data-number="6.4.1.3" class="anchored" data-anchor-id="análisis-de-sensibilidad"><span class="header-section-number">6.4.1.3</span> Análisis de sensibilidad</h4>
<div style="text-align:justify">
<p>Se desea ahora analizar los cambios del resultado del modelo cuando se modifican sus entradas o parámetros, por lo cual se realiza un análisis de sensibilidad de algunos parámetros.</p>
<p>Para ello del modelo modificado de Cramér Lundberg se toma los parámetros <span class="math inline">\(u\)</span> y <span class="math inline">\(c\)</span> del modelo modificado y se establece los rangos o valores posibles para cada uno de los ciertos parámetros, también se toma las medianas de las ganancia en la semana final de 100 simulaciones de las trayectorias del modelo, los rangos se determinan hasta que el modelo presente un comportamiento diferente.</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulación Modelo Clásico de Cramer-Lundberg para tres meses: </span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Antes de la pandemia Con los datos reales de la empresa</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># libreria para poder renombrar </span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="co">#las cabeceras de los dataframes</span></span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Parametros</span></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co">#semilla fija</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="dv">1759629</span> <span class="co">#surplus(capital inicial de salvamento)</span></span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Es un estimado a partir de la media de las ganancias por semana, </span></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="co">#multiplicado por 10/3, </span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a><span class="co">#siendo una proporción para evitar la ruina</span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a><span class="co"># u (sum(medias))*(10/3)</span></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>decimal_c <span class="ot">=</span> <span class="fl">0.29</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span>decimal_c<span class="sc">*</span>u <span class="co">#prima de pago cada timepo t. c=0.5*u</span></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>lambda_Nt <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a><span class="co">#lambda_Xi = 3</span></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>t_final <span class="ot">=</span> <span class="dv">90</span></span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a><span class="co"># S(t) = \sum_{i=1}^{N(t)}X_i</span></span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a><span class="co">#donde N(t)~ Poisson (lambda*t)</span></span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a><span class="co"># X_i ~ exponencial (lambda_Xi)</span></span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a><span class="co">#CL = REPRESENTA EL MODELO DE CRAMER LUNDBERG</span></span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulación de trayectoria de CL_t, cuando t &lt; t_final.</span></span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>trayectoria_CLt <span class="ot">&lt;-</span> <span class="cf">function</span>(u, c, lambda_Nt, t_final)</span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a>  tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a>  Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(u)</span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">&lt;</span> t_final)</span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tiempo_llegada &lt;- rexp(1, rate = lambda_Nt)</span></span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a>    tiempo_llegada <span class="ot">&lt;-</span> (<span class="dv">1</span>)</span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a>    Y_i <span class="ot">&lt;-</span>  (<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">139929.468</span>, <span class="at">sd =</span> <span class="fl">24521.524</span> ) <span class="sc">+</span></span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">48125.734</span> , <span class="at">sd=</span><span class="fl">17150.338</span> ) <span class="sc">+</span>  </span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">44509.755</span>, <span class="at">sd =</span> <span class="fl">14312.338</span> ) <span class="sc">+</span> </span>
<span id="cb119-34"><a href="#cb119-34" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">46904.516</span>, <span class="at">sd =</span> <span class="fl">16238.151</span> ) <span class="sc">+</span> </span>
<span id="cb119-35"><a href="#cb119-35" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">52786.734</span>  , <span class="at">sd =</span> <span class="fl">18403.17</span> ) </span>
<span id="cb119-36"><a href="#cb119-36" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">81601.876</span>  , <span class="at">sd =</span> <span class="fl">23756.037</span>) </span>
<span id="cb119-37"><a href="#cb119-37" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="fu">rweibull</span>(<span class="dv">1</span>,  <span class="at">shape =</span> <span class="fl">4.784508e+00</span>, <span class="at">scale =</span> <span class="fl">1.295070e+05</span> )) </span>
<span id="cb119-38"><a href="#cb119-38" aria-hidden="true" tabindex="-1"></a>    tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(tiempo, tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span> tiempo_llegada,</span>
<span id="cb119-39"><a href="#cb119-39" aria-hidden="true" tabindex="-1"></a>    tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span> tiempo_llegada ) </span>
<span id="cb119-40"><a href="#cb119-40" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(Cramer_trayectoria,</span>
<span id="cb119-41"><a href="#cb119-41" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span> </span>
<span id="cb119-42"><a href="#cb119-42" aria-hidden="true" tabindex="-1"></a>      c<span class="sc">*</span>tiempo_llegada,</span>
<span id="cb119-43"><a href="#cb119-43" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span></span>
<span id="cb119-44"><a href="#cb119-44" aria-hidden="true" tabindex="-1"></a>      c<span class="sc">*</span>tiempo_llegada <span class="sc">+</span>  Y_i )</span>
<span id="cb119-45"><a href="#cb119-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb119-46"><a href="#cb119-46" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb119-47"><a href="#cb119-47" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb119-48"><a href="#cb119-48" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb119-49"><a href="#cb119-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb119-50"><a href="#cb119-50" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb119-51"><a href="#cb119-51" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb119-52"><a href="#cb119-52" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb119-53"><a href="#cb119-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb119-54"><a href="#cb119-54" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tiempo, Cramer_trayectoria)</span>
<span id="cb119-55"><a href="#cb119-55" aria-hidden="true" tabindex="-1"></a>  df_trayectoria <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df<span class="sc">%&gt;%</span> rename</span>
<span id="cb119-56"><a href="#cb119-56" aria-hidden="true" tabindex="-1"></a>                               (<span class="at">Tiempo =</span> tiempo, </span>
<span id="cb119-57"><a href="#cb119-57" aria-hidden="true" tabindex="-1"></a>                                <span class="at">Ct =</span> Cramer_trayectoria))</span>
<span id="cb119-58"><a href="#cb119-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_trayectoria<span class="sc">$</span>Ct[<span class="fu">length</span>(df_trayectoria<span class="sc">$</span>Ct)])</span>
<span id="cb119-59"><a href="#cb119-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb119-60"><a href="#cb119-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb119-61"><a href="#cb119-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-62"><a href="#cb119-62" aria-hidden="true" tabindex="-1"></a><span class="co"># La función generador_mediana nos calcula </span></span>
<span id="cb119-63"><a href="#cb119-63" aria-hidden="true" tabindex="-1"></a><span class="co">#la mediana de las ganancias finales </span></span>
<span id="cb119-64"><a href="#cb119-64" aria-hidden="true" tabindex="-1"></a><span class="co">#de 100 trayectorias, fijando el u= surplus y el c</span></span>
<span id="cb119-65"><a href="#cb119-65" aria-hidden="true" tabindex="-1"></a>generador_mediana<span class="ot">&lt;-</span> <span class="cf">function</span>(ui,cj)</span>
<span id="cb119-66"><a href="#cb119-66" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb119-67"><a href="#cb119-67" aria-hidden="true" tabindex="-1"></a>  ganancia_final_replicas <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100</span>, </span>
<span id="cb119-68"><a href="#cb119-68" aria-hidden="true" tabindex="-1"></a>                                       <span class="fu">trayectoria_CLt</span>(u, c,</span>
<span id="cb119-69"><a href="#cb119-69" aria-hidden="true" tabindex="-1"></a>                                        lambda_Nt, t_final))</span>
<span id="cb119-70"><a href="#cb119-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>( <span class="fu">median</span>(ganancia_final_replicas))</span>
<span id="cb119-71"><a href="#cb119-71" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb119-72"><a href="#cb119-72" aria-hidden="true" tabindex="-1"></a><span class="co">#Se crea la rejilla donde se hace el analisis de sensibilidad</span></span>
<span id="cb119-73"><a href="#cb119-73" aria-hidden="true" tabindex="-1"></a><span class="co">#para diferentes valores de u y c</span></span>
<span id="cb119-74"><a href="#cb119-74" aria-hidden="true" tabindex="-1"></a>grid_u <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> (u<span class="dv">-100000</span><span class="sc">*</span><span class="dv">4</span>), <span class="at">to =</span> (u<span class="sc">+</span><span class="dv">100000</span><span class="sc">*</span><span class="dv">4</span>), <span class="at">by =</span> <span class="dv">100000</span>)</span>
<span id="cb119-75"><a href="#cb119-75" aria-hidden="true" tabindex="-1"></a>grid_c <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> (decimal_c<span class="fl">-0.01</span><span class="sc">*</span><span class="dv">4</span>), <span class="at">to =</span> (decimal_c<span class="fl">+0.01</span><span class="sc">*</span><span class="dv">4</span>), </span>
<span id="cb119-76"><a href="#cb119-76" aria-hidden="true" tabindex="-1"></a>              <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb119-77"><a href="#cb119-77" aria-hidden="true" tabindex="-1"></a>u_t <span class="ot">&lt;-</span> grid_u</span>
<span id="cb119-78"><a href="#cb119-78" aria-hidden="true" tabindex="-1"></a>matriz_mediana <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(u_t)<span class="sc">*</span><span class="fu">length</span>(grid_c)),</span>
<span id="cb119-79"><a href="#cb119-79" aria-hidden="true" tabindex="-1"></a><span class="at">nrow=</span> <span class="fu">length</span>(u_t), <span class="at">ncol=</span> <span class="fu">length</span>(grid_c))</span>
<span id="cb119-80"><a href="#cb119-80" aria-hidden="true" tabindex="-1"></a>G_t <span class="ot">&lt;-</span> matriz_mediana</span>
<span id="cb119-81"><a href="#cb119-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-82"><a href="#cb119-82" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(u_t)) </span>
<span id="cb119-83"><a href="#cb119-83" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb119-84"><a href="#cb119-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(grid_c)) </span>
<span id="cb119-85"><a href="#cb119-85" aria-hidden="true" tabindex="-1"></a>      {</span>
<span id="cb119-86"><a href="#cb119-86" aria-hidden="true" tabindex="-1"></a>      G_t[i,j] <span class="ot">&lt;-</span> <span class="fu">generador_mediana</span>(u_t[i],grid_c[j]<span class="sc">*</span>u_t[i])</span>
<span id="cb119-87"><a href="#cb119-87" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb119-88"><a href="#cb119-88" aria-hidden="true" tabindex="-1"></a>  }  </span>
<span id="cb119-89"><a href="#cb119-89" aria-hidden="true" tabindex="-1"></a><span class="co">#matriz_mediana</span></span>
<span id="cb119-90"><a href="#cb119-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-91"><a href="#cb119-91" aria-hidden="true" tabindex="-1"></a><span class="co">#Grafica del ánalisis de sensibilidad</span></span>
<span id="cb119-92"><a href="#cb119-92" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb119-93"><a href="#cb119-93" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb119-94"><a href="#cb119-94" aria-hidden="true" tabindex="-1"></a>c_t <span class="ot">&lt;-</span> u_t<span class="sc">*</span>grid_c</span>
<span id="cb119-95"><a href="#cb119-95" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb119-96"><a href="#cb119-96" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'surface'</span>,</span>
<span id="cb119-97"><a href="#cb119-97" aria-hidden="true" tabindex="-1"></a>  <span class="at">contours =</span> <span class="fu">list</span>(</span>
<span id="cb119-98"><a href="#cb119-98" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">list</span>(<span class="at">show =</span> <span class="cn">TRUE</span>, <span class="at">start =</span> u_t[<span class="dv">1</span>], </span>
<span id="cb119-99"><a href="#cb119-99" aria-hidden="true" tabindex="-1"></a>             <span class="at">end =</span> u_t[<span class="fu">length</span>(u_t)], </span>
<span id="cb119-100"><a href="#cb119-100" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span><span class="dv">100000</span> , <span class="at">color =</span> <span class="st">'red'</span>),</span>
<span id="cb119-101"><a href="#cb119-101" aria-hidden="true" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">list</span>(<span class="at">show =</span> <span class="cn">TRUE</span>, <span class="at">start =</span> G_t[<span class="dv">1</span>], </span>
<span id="cb119-102"><a href="#cb119-102" aria-hidden="true" tabindex="-1"></a>             <span class="at">end =</span> G_t[<span class="fu">length</span>(G_t)], </span>
<span id="cb119-103"><a href="#cb119-103" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.01</span><span class="sc">*</span><span class="dv">100000</span>)),</span>
<span id="cb119-104"><a href="#cb119-104" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>u_t,</span>
<span id="cb119-105"><a href="#cb119-105" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>c_t,</span>
<span id="cb119-106"><a href="#cb119-106" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="sc">~</span>G_t)</span>
<span id="cb119-107"><a href="#cb119-107" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">layout</span>(</span>
<span id="cb119-108"><a href="#cb119-108" aria-hidden="true" tabindex="-1"></a>  <span class="at">scene =</span> <span class="fu">list</span>(<span class="at">autosize =</span> F, <span class="at">width =</span> <span class="dv">500</span>, <span class="at">height =</span> <span class="dv">500</span>,</span>
<span id="cb119-109"><a href="#cb119-109" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">nticks =</span> <span class="dv">20</span>),</span>
<span id="cb119-110"><a href="#cb119-110" aria-hidden="true" tabindex="-1"></a>    <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">nticks =</span> <span class="dv">8</span>),</span>
<span id="cb119-111"><a href="#cb119-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">camera =</span> <span class="fu">list</span>(<span class="at">eye =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="dv">0</span>, </span>
<span id="cb119-112"><a href="#cb119-112" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">z =</span> <span class="dv">1</span>)),</span>
<span id="cb119-113"><a href="#cb119-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">aspectratio =</span> <span class="fu">list</span>(<span class="at">x =</span> .<span class="dv">9</span>, <span class="at">y =</span> .<span class="dv">8</span>, <span class="at">z =</span> <span class="fl">0.2</span>)))</span>
<span id="cb119-114"><a href="#cb119-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-115"><a href="#cb119-115" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-be17ae7a238d70ce2d68" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-be17ae7a238d70ce2d68">{"x":{"visdat":{"50306a6e7a57":["function () ","plotlyVisDat"]},"cur_data":"50306a6e7a57","attrs":{"50306a6e7a57":{"contours":{"x":{"show":true,"start":1359629,"end":2159629,"size":100000,"color":"red"},"z":{"show":true,"start":3799678.6700499668,"end":3810911.3366321749,"size":1000}},"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"autosize":false,"width":500,"height":500,"xaxis":{"nticks":20,"title":"u_t"},"zaxis":{"nticks":8,"title":"G_t"},"camera":{"eye":{"x":0,"y":-1,"z":1}},"aspectratio":{"x":0.90000000000000002,"y":0.80000000000000004,"z":0.20000000000000001},"yaxis":{"title":"c_t"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"G_t","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666665","rgba(70,19,97,1)"],["0.0833333333333331","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666666","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.249999999999999","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333334","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666666","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.750000000000001","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333334","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"contours":{"x":{"show":true,"start":1359629,"end":2159629,"size":100000,"color":"red"},"z":{"show":true,"start":3799678.6700499668,"end":3810911.3366321749,"size":1000}},"x":[1359629,1459629,1559629,1659629,1759629,1859629,1959629,2059629,2159629],"y":[339907.24999999994,379503.53999999992,421099.82999999996,464696.11999999994,510292.40999999997,557888.69999999995,607484.98999999987,659081.27999999991,712677.56999999995],"z":[[3799678.6700499668,3688285.9704615688,3746091.3443302959,3700163.0626185639,3760031.3644225723,3787419.3148879316,3732026.0166124618,3761243.5369998477,3670013.5259366343],[3727452.4501464507,3774191.3301523631,3881911.6927769771,3810544.7686568098,3805116.5533685433,3764533.9239688762,3880555.4952453612,3743685.4966322188,3660435.4476360753],[3727405.8224729113,3696632.0001658741,3730205.9999463297,3736368.1315661846,3617349.8368322402,3789645.3430817928,3663391.8116608895,3708038.1194446045,3827045.2309511201],[3711512.3580661556,3781154.0421757814,3612154.8190585682,3704459.3077384625,3650230.3950041295,3739352.6542624757,3739365.924647633,3681748.8092028615,3832182.7924254085],[3800751.7364376574,3735342.6678619394,3773862.5644430746,3899167.6942620343,3664343.3414752167,3806877.2750951047,3848848.8569553653,3778638.3633829458,3699324.6197089683],[3792736.4724762458,3743970.8824600372,3799525.8498507971,3708420.3432116732,3811074.0543498513,3922355.5938575109,3704888.3385800873,3832635.3890647739,3624918.2272250727],[3795110.9385138247,3786126.3527958179,3741030.7597755957,3790229.4274179386,3709111.7312897262,3750010.6261366527,3772676.2396585164,3644120.1410103636,3639719.4087858601],[3801608.6559405564,3670345.6876529935,3754746.5531679257,3735504.0464769779,3763718.6624695212,3769465.284592147,3844062.3705451293,3714926.1658289535,3800325.5918319011],[3868128.9805945484,3597666.8931931835,3772782.7345622573,3717252.7157873251,3717149.7165429117,3771145.6313881353,3771022.0791135794,3770412.6815507389,3810911.3366321749]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="caso-pos-pandemia" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="caso-pos-pandemia"><span class="header-section-number">6.4.2</span> Caso pos-pandemia</h3>
<div style="text-align:justify">
<p>De manera análoga a la metodología empleada con los datos pre-pandemicos, para la simulación del modelo Crámer-Lundberg con los datos después de la pandemia se hizo uso de las medias de las distribuciones de las ventas por día tomado como las ganancias acumuladas, y se estimó los parámetros de <span class="math inline">\(u\)</span> y <span class="math inline">\(c\)</span>.</p>
</div>
<section id="modelo-de-cramér-lundberg-simulado-en-r-con-datos-reales-de-las-ventas-por-día-de-la-empresa" class="level4" data-number="6.4.2.1">
<h4 data-number="6.4.2.1" class="anchored" data-anchor-id="modelo-de-cramér-lundberg-simulado-en-r-con-datos-reales-de-las-ventas-por-día-de-la-empresa"><span class="header-section-number">6.4.2.1</span> Modelo de Cramér-Lundberg simulado en R con datos reales de las ventas por día de la empresa</h4>
<div style="text-align:justify">
<p>En la (<a href="#fig-trayectoria2" class="quarto-xref">Figura&nbsp;<span>6.6</span></a>) se muestra la trayectoria del modelo bajo los supuestos del modelo modificado, el proceso comienza con <span class="math inline">\(t = 14\)</span>, que son las <span class="math inline">\(14\)</span> semanas de las ventas registradas por día después del cierre pandémico, con un capital inicial de <span class="math inline">\(u= 1759629\)</span>, una tasa de <span class="math inline">\(c= 0.29\)</span>, los montos de las ganancias tienen todas distribución normal (<span class="math inline">\(N\)</span>).</p>
<p>El código que genera la trayectoria es el siguiente:</p>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># libreria para poder renombrar </span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="co">#las cabeceras de los dataframes</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Parametros</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co">#semilla fija</span></span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="dv">1759629</span> <span class="co">#surplus(capital inicial de salvamento)</span></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Es un estimado a partir de la media de las ganancias por semana, </span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a><span class="co">#multiplicado por 10/3, </span></span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a><span class="co">#siendo una proporción para evitar la ruina</span></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="co"># u (sum(medias))*(10/3)</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> (<span class="fl">0.29</span><span class="sc">*</span>u) <span class="co">#prima de pago cada timepo t. c=0.5*u</span></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a>lambda_Nt <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a><span class="co">#lambda_Xi = 3</span></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>t_final <span class="ot">=</span> <span class="dv">14</span></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a><span class="co"># S(t) = \sum_{i=1}^{N(t)}X_i</span></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a><span class="co">#donde N(t)~ Poisson (lambda*t)</span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a><span class="co"># X_i ~ exponencial (lambda_Xi)</span></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="co">#CL = REPRESENTA EL MODELO DE CRAMER LUNDBERG</span></span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulación de trayectoria de CL_t, cuando t &lt; t_final.</span></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>trayectoria_CLt_post_pandemia <span class="ot">&lt;-</span> <span class="cf">function</span>(u, c, lambda_Nt, t_final)</span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>  tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a>  Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(u)</span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">&lt;</span> t_final)</span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a>    tiempo_llegada <span class="ot">&lt;-</span> (<span class="dv">1</span>)<span class="co">#rexp(1, rate = lambda_Nt)</span></span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>    Y_i <span class="ot">&lt;-</span>  (<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">101919.050</span> , <span class="at">sd =</span> <span class="fl">10877.075</span>  ) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">39841.721</span> , <span class="at">sd=</span> <span class="fl">7873.446</span> </span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span>  <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">41751.747</span>, <span class="at">sd =</span> <span class="fl">5687.030</span>  ) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">43243.143</span>, <span class="at">sd =</span> <span class="fl">10517.841</span> ) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">43010.307</span>  , <span class="at">sd =</span> <span class="fl">7741.889</span> ) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">61191.300</span>  , <span class="at">sd =</span> <span class="fl">7202.989</span>) <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">85684.058</span> , <span class="at">sd =</span> <span class="fl">8371.359</span> ) ) </span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a>    tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(tiempo, tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span> tiempo_llegada,tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span> tiempo_llegada ) </span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a>Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(Cramer_trayectoria,</span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a>Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]</span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a><span class="sc">-</span>c<span class="sc">*</span>tiempo_llegada,</span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a>Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span></span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a>c<span class="sc">*</span>tiempo_llegada <span class="sc">+</span>  Y_i )</span>
<span id="cb120-36"><a href="#cb120-36" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb120-37"><a href="#cb120-37" aria-hidden="true" tabindex="-1"></a>  df_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tiempo, Cramer_trayectoria)</span>
<span id="cb120-38"><a href="#cb120-38" aria-hidden="true" tabindex="-1"></a>  df_trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df_post_pandemia<span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Tiempo =</span> tiempo, <span class="at">Ct =</span> Cramer_trayectoria))</span>
<span id="cb120-39"><a href="#cb120-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_trayectoria_post_pandemia)</span>
<span id="cb120-40"><a href="#cb120-40" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb120-41"><a href="#cb120-41" aria-hidden="true" tabindex="-1"></a>trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">trayectoria_CLt_post_pandemia</span>(u,c,lambda_Nt, t_final )</span>
<span id="cb120-42"><a href="#cb120-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-43"><a href="#cb120-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-44"><a href="#cb120-44" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb120-45"><a href="#cb120-45" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(trayectoria$Tiempo, trayectoria$Ct, type= "l")</span></span>
<span id="cb120-46"><a href="#cb120-46" aria-hidden="true" tabindex="-1"></a>fig_tr2 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(trayectoria_post_pandemia, <span class="at">x =</span> <span class="sc">~</span>Tiempo, <span class="at">y =</span> <span class="sc">~</span>Ct, <span class="at">name =</span> <span class="st">"Ganancias: G(t)"</span>,<span class="at">type =</span> <span class="st">"scatter"</span>, <span class="at">mode =</span> <span class="st">"lines"</span>)</span>
<span id="cb120-47"><a href="#cb120-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-48"><a href="#cb120-48" aria-hidden="true" tabindex="-1"></a>fig_tr2 <span class="ot">&lt;-</span> fig_tr2 <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>Tiempo, <span class="at">y =</span> u,  <span class="at">name =</span> <span class="st">"Capital inicial: u"</span>, <span class="at">type =</span> <span class="st">"scatter"</span>, <span class="at">mode =</span> <span class="st">"lines"</span>)</span>
<span id="cb120-49"><a href="#cb120-49" aria-hidden="true" tabindex="-1"></a>fig_tr2</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-trayectoria2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trayectoria2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-7bc39ff695e287477b8e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-7bc39ff695e287477b8e">{"x":{"visdat":{"5030742d59e8":["function () ","plotlyVisDat"]},"cur_data":"5030742d59e8","attrs":{"5030742d59e8":{"x":{},"y":{},"mode":"lines","name":"Ganancias: G(t)","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"5030742d59e8.1":{"x":{},"y":1759629,"mode":"lines","name":"Capital inicial: u","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Tiempo"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Ct"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14],"y":[1759629,1249336.5900000001,1650427.2550780997,1140134.8450780998,1576023.9892703742,1065731.5792703743,1499524.2424877754,989231.83248777548,1413469.2455134529,903176.835513453,1332514.7896336743,822222.3796336744,1278207.7005535015,767915.29055350157,1146961.0190454307,636668.60904543079,1076923.5359462299,566631.12594623002,966560.99285337748,456268.58285337751,854290.74500261247,343998.3350026125,766580.44720342848,256288.03720342851,726176.77125742938,215884.36125742941,616001.23672117235,105708.82672117237,532960.76050670235],"mode":"lines","name":"Ganancias: G(t)","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14],"y":[1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629],"mode":"lines","name":"Capital inicial: u","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trayectoria2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.6: Trayectoria de pérdidas del proceso de evolución modificado de Cramér Lundberg después de la pandemia.
</figcaption>
</figure>
</div>
<div style="text-align:justify">
<p>Se emplean los mismos parámetros obtenidos en el periodo de tiempo pre pandemia del modelo modificado donde se observa una completa ruina al alcanzar <span class="math inline">\(17\)</span> semanas.</p>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># libreria para poder renombrar </span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="co"># las cabeceras de los dataframes</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Parametros</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co">#semilla fija</span></span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="dv">1759629</span> <span class="co">#surplus(capital inicial de salvamento)</span></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Es un estimado a partir de la media de las ganancias por semana, </span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="co">#multiplicado por 10/3, </span></span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a><span class="co">#siendo una proporción para evitar la ruina</span></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="co"># u (sum(medias))*(10/3)</span></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fl">0.29</span><span class="sc">*</span>u <span class="co">#prima de pago cada timepo t. c=0.5*u</span></span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a>lambda_Nt <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a><span class="co">#lambda_Xi = 3</span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>t_final <span class="ot">=</span> <span class="dv">17</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a><span class="co"># S(t) = \sum_{i=1}^{N(t)}X_i</span></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="co">#donde N(t)~ Poisson (lambda*t)</span></span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a><span class="co"># X_i ~ exponencial (lambda_Xi)</span></span>
<span id="cb121-18"><a href="#cb121-18" aria-hidden="true" tabindex="-1"></a><span class="co">#CL = REPRESENTA EL MODELO DE CRAMER LUNDBERG</span></span>
<span id="cb121-19"><a href="#cb121-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulación de trayectoria de CL_t, cuando t &lt; t_final.</span></span>
<span id="cb121-20"><a href="#cb121-20" aria-hidden="true" tabindex="-1"></a>trayectoria_CLt_post_pandemia <span class="ot">&lt;-</span> <span class="cf">function</span>(u, c, lambda_Nt, t_final)</span>
<span id="cb121-21"><a href="#cb121-21" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb121-22"><a href="#cb121-22" aria-hidden="true" tabindex="-1"></a>  tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb121-23"><a href="#cb121-23" aria-hidden="true" tabindex="-1"></a>  Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(u)</span>
<span id="cb121-24"><a href="#cb121-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">&lt;</span> t_final)</span>
<span id="cb121-25"><a href="#cb121-25" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb121-26"><a href="#cb121-26" aria-hidden="true" tabindex="-1"></a>    tiempo_llegada <span class="ot">&lt;-</span> (<span class="dv">1</span>)<span class="co">#rexp(1, rate = lambda_Nt)</span></span>
<span id="cb121-27"><a href="#cb121-27" aria-hidden="true" tabindex="-1"></a>    Y_i <span class="ot">&lt;-</span>  (<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">101919.050</span> , <span class="at">sd =</span> <span class="fl">10877.075</span>  ) </span>
<span id="cb121-28"><a href="#cb121-28" aria-hidden="true" tabindex="-1"></a><span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">39841.721</span> , <span class="at">sd=</span> <span class="fl">7873.446</span> </span>
<span id="cb121-29"><a href="#cb121-29" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span>  </span>
<span id="cb121-30"><a href="#cb121-30" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">41751.747</span>, <span class="at">sd =</span> <span class="fl">5687.030</span>  ) <span class="sc">+</span> </span>
<span id="cb121-31"><a href="#cb121-31" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">43243.143</span>, <span class="at">sd =</span> <span class="fl">10517.841</span> ) <span class="sc">+</span> </span>
<span id="cb121-32"><a href="#cb121-32" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">43010.307</span>  , <span class="at">sd =</span> <span class="fl">7741.889</span> ) <span class="sc">+</span> </span>
<span id="cb121-33"><a href="#cb121-33" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">61191.300</span>  , <span class="at">sd =</span> <span class="fl">7202.989</span>) <span class="sc">+</span> </span>
<span id="cb121-34"><a href="#cb121-34" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">85684.058</span> , <span class="at">sd =</span> <span class="fl">8371.359</span> ) ) </span>
<span id="cb121-35"><a href="#cb121-35" aria-hidden="true" tabindex="-1"></a>    tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(tiempo, tiempo[<span class="fu">length</span>(tiempo)] </span>
<span id="cb121-36"><a href="#cb121-36" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> tiempo_llegada,tiempo[<span class="fu">length</span>(tiempo)]</span>
<span id="cb121-37"><a href="#cb121-37" aria-hidden="true" tabindex="-1"></a>    <span class="sc">+</span> tiempo_llegada ) </span>
<span id="cb121-38"><a href="#cb121-38" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(Cramer_trayectoria,</span>
<span id="cb121-39"><a href="#cb121-39" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]</span>
<span id="cb121-40"><a href="#cb121-40" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span> c<span class="sc">*</span>tiempo_llegada,</span>
<span id="cb121-41"><a href="#cb121-41" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span></span>
<span id="cb121-42"><a href="#cb121-42" aria-hidden="true" tabindex="-1"></a>    c<span class="sc">*</span>tiempo_llegada <span class="sc">+</span>  Y_i )</span>
<span id="cb121-43"><a href="#cb121-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb121-44"><a href="#cb121-44" aria-hidden="true" tabindex="-1"></a>  df_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tiempo, Cramer_trayectoria)</span>
<span id="cb121-45"><a href="#cb121-45" aria-hidden="true" tabindex="-1"></a>df_trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df_post_pandemia<span class="sc">%&gt;%</span></span>
<span id="cb121-46"><a href="#cb121-46" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">rename</span>(<span class="at">Tiempo =</span> tiempo,</span>
<span id="cb121-47"><a href="#cb121-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">Ct =</span> Cramer_trayectoria))</span>
<span id="cb121-48"><a href="#cb121-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_trayectoria_post_pandemia)</span>
<span id="cb121-49"><a href="#cb121-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb121-50"><a href="#cb121-50" aria-hidden="true" tabindex="-1"></a>trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">trayectoria_CLt_post_pandemia</span>(u,c,</span>
<span id="cb121-51"><a href="#cb121-51" aria-hidden="true" tabindex="-1"></a>                                            lambda_Nt, t_final )</span>
<span id="cb121-52"><a href="#cb121-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-53"><a href="#cb121-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb121-54"><a href="#cb121-54" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(trayectoria$Tiempo, trayectoria$Ct, type= "l")</span></span>
<span id="cb121-55"><a href="#cb121-55" aria-hidden="true" tabindex="-1"></a>fig_tr3 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(trayectoria_post_pandemia, <span class="at">x =</span> <span class="sc">~</span>Tiempo, </span>
<span id="cb121-56"><a href="#cb121-56" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="sc">~</span>Ct, </span>
<span id="cb121-57"><a href="#cb121-57" aria-hidden="true" tabindex="-1"></a>                   <span class="at">name =</span> <span class="st">"Ganancias:G(t)"</span>,</span>
<span id="cb121-58"><a href="#cb121-58" aria-hidden="true" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">"scatter"</span>, <span class="at">mode =</span> <span class="st">"lines"</span>)</span>
<span id="cb121-59"><a href="#cb121-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-60"><a href="#cb121-60" aria-hidden="true" tabindex="-1"></a>fig_tr3 <span class="ot">&lt;-</span> fig_tr3 <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>Tiempo, <span class="at">y =</span> u,</span>
<span id="cb121-61"><a href="#cb121-61" aria-hidden="true" tabindex="-1"></a>           <span class="at">name =</span> <span class="st">"Capital inicial:u"</span>, </span>
<span id="cb121-62"><a href="#cb121-62" aria-hidden="true" tabindex="-1"></a>           <span class="at">type =</span> <span class="st">"scatter"</span>, <span class="at">mode =</span> <span class="st">"lines"</span>)</span>
<span id="cb121-63"><a href="#cb121-63" aria-hidden="true" tabindex="-1"></a>fig_tr3</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-trayectoria3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trayectoria3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div>

</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig quarto-uncaptioned" id="fig-trayectoria3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.7
</figcaption>
</figure>
</div>
<div style="text-align:justify">
<p>La evolución del proceso de pérdidas en el modelo modificado de Cramér-Lundberg proporciona una herramienta más precisa y adaptable para predecir y contrarrestar los impactos financieros negativos de la empresa.</p>
<p>Se incorpora un factor adicional y ajuste que mejoran la simulación del modelo, mediante la modificación del parámetro <span class="math inline">\(c\)</span>, reduciendo un <span class="math inline">\(17\%\)</span> presentándose así los resultados siguientes mediante el siguiente código.</p>
</div>
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># libreria para poder renombrar </span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="co"># las cabeceras de los dataframes</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Parametros</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co">#semilla fija</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="dv">1759629</span> <span class="co">#surplus(capital inicial de salvamento)</span></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Es un estimado a partir de la media de las ganancias por semana, </span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="co">#multiplicado por 10/3, </span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a><span class="co">#siendo una proporción para evitar la ruina</span></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a><span class="co"># u (sum(medias))*(10/3)</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> (<span class="fl">0.29</span><span class="sc">*</span>u)<span class="sc">*</span>(<span class="fl">0.83</span>) <span class="co">#prima de pago cada timepo t. c=0.5*u</span></span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>lambda_Nt <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a><span class="co">#lambda_Xi = 3</span></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>t_final <span class="ot">=</span> <span class="dv">14</span></span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a><span class="co"># S(t) = \sum_{i=1}^{N(t)}X_i</span></span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a><span class="co">#donde N(t)~ Poisson (lambda*t)</span></span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a><span class="co"># X_i ~ exponencial (lambda_Xi)</span></span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a><span class="co">#CL = REPRESENTA EL MODELO DE CRAMER LUNDBERG</span></span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulación de trayectoria de CL_t, cuando t &lt; t_final.</span></span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>trayectoria_CLt_post_pandemia <span class="ot">&lt;-</span> <span class="cf">function</span>(u, c, lambda_Nt, t_final)</span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a>  tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a>  Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(u)</span>
<span id="cb122-24"><a href="#cb122-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">&lt;</span> t_final)</span>
<span id="cb122-25"><a href="#cb122-25" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb122-26"><a href="#cb122-26" aria-hidden="true" tabindex="-1"></a>    tiempo_llegada <span class="ot">&lt;-</span> (<span class="dv">1</span>)<span class="co">#rexp(1, rate = lambda_Nt)</span></span>
<span id="cb122-27"><a href="#cb122-27" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-28"><a href="#cb122-28" aria-hidden="true" tabindex="-1"></a>    Y_i <span class="ot">&lt;-</span>  (<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">101919.050</span> , <span class="at">sd =</span> <span class="fl">10877.075</span>) <span class="sc">+</span> </span>
<span id="cb122-29"><a href="#cb122-29" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">39841.721</span> , <span class="at">sd=</span> <span class="fl">7873.446</span>) <span class="sc">+</span>  </span>
<span id="cb122-30"><a href="#cb122-30" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">41751.747</span>, <span class="at">sd =</span> <span class="fl">5687.030</span>) <span class="sc">+</span> </span>
<span id="cb122-31"><a href="#cb122-31" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">43243.143</span>, <span class="at">sd =</span> <span class="fl">10517.841</span>) <span class="sc">+</span> </span>
<span id="cb122-32"><a href="#cb122-32" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">43010.307</span>  , <span class="at">sd =</span> <span class="fl">7741.889</span>) <span class="sc">+</span> </span>
<span id="cb122-33"><a href="#cb122-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">61191.300</span>  , <span class="at">sd =</span> <span class="fl">7202.989</span>) <span class="sc">+</span> </span>
<span id="cb122-34"><a href="#cb122-34" aria-hidden="true" tabindex="-1"></a>            <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">85684.058</span> , <span class="at">sd =</span> <span class="fl">8371.359</span> )) </span>
<span id="cb122-35"><a href="#cb122-35" aria-hidden="true" tabindex="-1"></a>    tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(tiempo, tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span> </span>
<span id="cb122-36"><a href="#cb122-36" aria-hidden="true" tabindex="-1"></a>                tiempo_llegada,tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span> </span>
<span id="cb122-37"><a href="#cb122-37" aria-hidden="true" tabindex="-1"></a>                tiempo_llegada ) </span>
<span id="cb122-38"><a href="#cb122-38" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(Cramer_trayectoria,</span>
<span id="cb122-39"><a href="#cb122-39" aria-hidden="true" tabindex="-1"></a>                            Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span></span>
<span id="cb122-40"><a href="#cb122-40" aria-hidden="true" tabindex="-1"></a>                            c<span class="sc">*</span>tiempo_llegada, </span>
<span id="cb122-41"><a href="#cb122-41" aria-hidden="true" tabindex="-1"></a>                            Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span> </span>
<span id="cb122-42"><a href="#cb122-42" aria-hidden="true" tabindex="-1"></a>                            c<span class="sc">*</span>tiempo_llegada <span class="sc">+</span> Y_i )</span>
<span id="cb122-43"><a href="#cb122-43" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb122-44"><a href="#cb122-44" aria-hidden="true" tabindex="-1"></a>  df_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tiempo, Cramer_trayectoria)</span>
<span id="cb122-45"><a href="#cb122-45" aria-hidden="true" tabindex="-1"></a>  df_trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df_post_pandemia<span class="sc">%&gt;%</span> rename</span>
<span id="cb122-46"><a href="#cb122-46" aria-hidden="true" tabindex="-1"></a>                                             (<span class="at">Tiempo =</span> tiempo, </span>
<span id="cb122-47"><a href="#cb122-47" aria-hidden="true" tabindex="-1"></a>                                               <span class="at">Ct =</span> Cramer_trayectoria))</span>
<span id="cb122-48"><a href="#cb122-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_trayectoria_post_pandemia)</span>
<span id="cb122-49"><a href="#cb122-49" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb122-50"><a href="#cb122-50" aria-hidden="true" tabindex="-1"></a>trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">trayectoria_CLt_post_pandemia</span>(u,c,lambda_Nt, t_final )</span>
<span id="cb122-51"><a href="#cb122-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-52"><a href="#cb122-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-53"><a href="#cb122-53" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb122-54"><a href="#cb122-54" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(trayectoria$Tiempo, trayectoria$Ct, type= "l")</span></span>
<span id="cb122-55"><a href="#cb122-55" aria-hidden="true" tabindex="-1"></a>fig_tr4 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(trayectoria_post_pandemia, <span class="at">x =</span> <span class="sc">~</span>Tiempo, </span>
<span id="cb122-56"><a href="#cb122-56" aria-hidden="true" tabindex="-1"></a>                   <span class="at">y =</span> <span class="sc">~</span>Ct, </span>
<span id="cb122-57"><a href="#cb122-57" aria-hidden="true" tabindex="-1"></a>         <span class="at">name =</span> <span class="st">"Ganancias: G(t)"</span>,<span class="at">type =</span> <span class="st">"scatter"</span>, <span class="at">mode =</span> <span class="st">"lines"</span>)</span>
<span id="cb122-58"><a href="#cb122-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-59"><a href="#cb122-59" aria-hidden="true" tabindex="-1"></a>fig_tr4 <span class="ot">&lt;-</span> fig_tr4 <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>Tiempo, <span class="at">y =</span> u,</span>
<span id="cb122-60"><a href="#cb122-60" aria-hidden="true" tabindex="-1"></a>           <span class="at">name =</span> <span class="st">"Capital inicial:u"</span>, <span class="at">type =</span> <span class="st">"scatter"</span>, <span class="at">mode =</span> <span class="st">"lines"</span>)</span>
<span id="cb122-61"><a href="#cb122-61" aria-hidden="true" tabindex="-1"></a>fig_tr4</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="fig-trayectoria4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-trayectoria4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell">
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-37866405e98a32b4926e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-37866405e98a32b4926e">{"x":{"visdat":{"503055d6ead":["function () ","plotlyVisDat"]},"cur_data":"503055d6ead","attrs":{"503055d6ead":{"x":{},"y":{},"mode":"lines","name":"Ganancias: G(t)","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"503055d6ead.1":{"x":{},"y":1759629,"mode":"lines","name":"Capital inicial:u","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Tiempo"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Ct"},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14],"y":[1759629,1336086.2997000001,1737176.9647780997,1313634.2644780998,1749523.4086703742,1325980.7083703743,1759773.3715877754,1336230.6712877755,1760468.0843134529,1336925.384013453,1766263.3381336743,1342720.6378336744,1798705.9587535015,1375163.2584535016,1754208.9869454307,1330666.2866454308,1770921.21354623,1347378.5132462301,1747308.3801533775,1323765.6798533776,1721787.8420026125,1298245.1417026126,1720827.2539034286,1297284.5536034286,1767173.2876574295,1343630.5873574296,1743747.4628211726,1320204.7625211726,1747456.6963067027],"mode":"lines","name":"Ganancias: G(t)","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,14,14],"y":[1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629,1759629],"mode":"lines","name":"Capital inicial:u","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-trayectoria4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figura&nbsp;6.8: Trayectoria del proceso de pérdidas generadas por el modelo modificado de Cramér Lundberg después de la pandemia con una reducción de los costos al <span class="math inline">\(17 \%\)</span>.
</figcaption>
</figure>
</div>
</section>
<section id="probabilidad-de-ruina-1" class="level4" data-number="6.4.2.2">
<h4 data-number="6.4.2.2" class="anchored" data-anchor-id="probabilidad-de-ruina-1"><span class="header-section-number">6.4.2.2</span> Probabilidad de ruina</h4>
<div style="text-align:justify">
<p>Al igual que para el caso con los datos antes de la pandemia se analizó la semana en el que <span class="math inline">\(G(t)\leq u\)</span> y cuando <span class="math inline">\(G(t)\leq0\)</span>, haciendo la comparación con la tasa de interés de <span class="math inline">\(0.8\)</span> anual en una cuenta de ahorro para una inversión del capital inicial <span class="math inline">\(u\)</span>, para este periodo tomamos <span class="math inline">\(t = 14\)</span>, es decir los datos registrados hasta las <span class="math inline">\(14\)</span> semanas después de pandemia donde la tasa es de <span class="math inline">\(0.0233\)</span></p>
<p>El código para calcular la probabilidad de las ganancias finales bajas es el siguiente:</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># librería para poder renombrar las </span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="co"># cabeceras de los dataframes</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Parámetros</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co">#semilla fija</span></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="dv">1759629</span> <span class="co">#surplus(capital inicial de salvamento)</span></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Es un estimado a partir de la media de las ganancias por semana, </span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a><span class="co">#multiplicado por 10/3, </span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a><span class="co">#siendo una proporción para evitar la ruina</span></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="co"># u (sum(medias))*(10/3)</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fl">0.29</span><span class="sc">*</span>u <span class="co">#prima de pago cada timepo t. c=0.5*u</span></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>lambda_Nt <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a><span class="co">#lambda_Xi = 3</span></span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>t_final <span class="ot">=</span> <span class="dv">14</span></span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="dv">1</span> <span class="co">#tiempos entrellegadas constantes</span></span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a><span class="co"># S(t) = \sum_{i=1}^{N(t)}X_i</span></span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a><span class="co">#donde N(t)~ Poisson (lambda*t)</span></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="co"># X_i ~ exponencial (lambda_Xi)</span></span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a><span class="co">#CL = REPRESENTA EL MODELO DE CRAMER LUNDBERG</span></span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulación de trayectoria de CL_t, cuando t &lt; t_final.</span></span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>trayectoria_CLt_post_pandemia <span class="ot">&lt;-</span> <span class="cf">function</span>(u, c, lambda_Nt, t_final)</span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a>  tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a>  Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(u)</span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">&lt;</span> t_final)</span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tiempo_llegada &lt;- rexp(1, rate = lambda_Nt)</span></span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a>    tiempo_llegada <span class="ot">&lt;-</span> (<span class="dv">1</span>) </span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a><span class="co">#Suponiendo los tiempos entrellegadas constantes \mu = 1</span></span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true" tabindex="-1"></a>    Y_i <span class="ot">&lt;-</span>  (<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">101919.050</span> , <span class="at">sd =</span> <span class="fl">10877.075</span>   ) </span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true" tabindex="-1"></a>              <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">39841.721</span> , <span class="at">sd=</span> <span class="fl">7873.446</span>  ) </span>
<span id="cb123-32"><a href="#cb123-32" aria-hidden="true" tabindex="-1"></a>              <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">41751.747</span>, <span class="at">sd =</span> <span class="fl">5687.030</span> ) </span>
<span id="cb123-33"><a href="#cb123-33" aria-hidden="true" tabindex="-1"></a>              <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">43243.143</span>, <span class="at">sd =</span> <span class="fl">10517.841</span>) </span>
<span id="cb123-34"><a href="#cb123-34" aria-hidden="true" tabindex="-1"></a>              <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">43010.307</span>  , <span class="at">sd =</span> <span class="fl">7741.889</span> ) </span>
<span id="cb123-35"><a href="#cb123-35" aria-hidden="true" tabindex="-1"></a>              <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">61191.300</span>  , <span class="at">sd =</span> <span class="fl">7202.989</span> ) </span>
<span id="cb123-36"><a href="#cb123-36" aria-hidden="true" tabindex="-1"></a>              <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">85684.058</span> , <span class="at">sd =</span> <span class="fl">8371.359</span>)) </span>
<span id="cb123-37"><a href="#cb123-37" aria-hidden="true" tabindex="-1"></a>    tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(tiempo, tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span> </span>
<span id="cb123-38"><a href="#cb123-38" aria-hidden="true" tabindex="-1"></a>                  tiempo_llegada,tiempo[<span class="fu">length</span>(tiempo)]<span class="sc">+</span> </span>
<span id="cb123-39"><a href="#cb123-39" aria-hidden="true" tabindex="-1"></a>                  tiempo_llegada) </span>
<span id="cb123-40"><a href="#cb123-40" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(Cramer_trayectoria,</span>
<span id="cb123-41"><a href="#cb123-41" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">-</span> </span>
<span id="cb123-42"><a href="#cb123-42" aria-hidden="true" tabindex="-1"></a>      c<span class="sc">*</span>tiempo_llegada, </span>
<span id="cb123-43"><a href="#cb123-43" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span> </span>
<span id="cb123-44"><a href="#cb123-44" aria-hidden="true" tabindex="-1"></a>      c<span class="sc">*</span>tiempo_llegada <span class="sc">+</span>  Y_i )</span>
<span id="cb123-45"><a href="#cb123-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="dv">0</span>){</span>
<span id="cb123-46"><a href="#cb123-46" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb123-47"><a href="#cb123-47" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb123-48"><a href="#cb123-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb123-49"><a href="#cb123-49" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb123-50"><a href="#cb123-50" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb123-51"><a href="#cb123-51" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb123-52"><a href="#cb123-52" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.08*u es la ganancia inferior a la de un tasa de </span></span>
<span id="cb123-53"><a href="#cb123-53" aria-hidden="true" tabindex="-1"></a><span class="co"># un título financiero  para el año 2018</span></span>
<span id="cb123-54"><a href="#cb123-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-55"><a href="#cb123-55" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> (<span class="dv">1</span> <span class="sc">+</span> (<span class="dv">14</span><span class="sc">*</span><span class="fl">0.08</span>)<span class="sc">/</span><span class="dv">48</span>)<span class="sc">*</span>u) {</span>
<span id="cb123-56"><a href="#cb123-56" aria-hidden="true" tabindex="-1"></a>    ganancia_no_deseada <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb123-57"><a href="#cb123-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-58"><a href="#cb123-58" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb123-59"><a href="#cb123-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb123-60"><a href="#cb123-60" aria-hidden="true" tabindex="-1"></a>    ganancia_no_deseada <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb123-61"><a href="#cb123-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb123-62"><a href="#cb123-62" aria-hidden="true" tabindex="-1"></a>  df_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tiempo, Cramer_trayectoria)</span>
<span id="cb123-63"><a href="#cb123-63" aria-hidden="true" tabindex="-1"></a>  df_trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df_post_pandemia<span class="sc">%&gt;%</span> </span>
<span id="cb123-64"><a href="#cb123-64" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">rename</span>(<span class="at">Tiempo =</span> tiempo,</span>
<span id="cb123-65"><a href="#cb123-65" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">Ct =</span> Cramer_trayectoria))</span>
<span id="cb123-66"><a href="#cb123-66" aria-hidden="true" tabindex="-1"></a>  salida <span class="ot">&lt;-</span> <span class="fu">c</span>(ruina, ganancia_no_deseada)</span>
<span id="cb123-67"><a href="#cb123-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(salida)</span>
<span id="cb123-68"><a href="#cb123-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-69"><a href="#cb123-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb123-70"><a href="#cb123-70" aria-hidden="true" tabindex="-1"></a>trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">trayectoria_CLt_post_pandemia</span>(u,c,</span>
<span id="cb123-71"><a href="#cb123-71" aria-hidden="true" tabindex="-1"></a>                                            lambda_Nt, t_final )</span>
<span id="cb123-72"><a href="#cb123-72" aria-hidden="true" tabindex="-1"></a><span class="co">#Método de monte carlo para estimar la probabilidad de ruina</span></span>
<span id="cb123-73"><a href="#cb123-73" aria-hidden="true" tabindex="-1"></a>n_replicaciones <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb123-74"><a href="#cb123-74" aria-hidden="true" tabindex="-1"></a>r_baja_ganancia_post_pandemia <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_replicaciones,</span>
<span id="cb123-75"><a href="#cb123-75" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">trayectoria_CLt_post_pandemia</span>(u, c, </span>
<span id="cb123-76"><a href="#cb123-76" aria-hidden="true" tabindex="-1"></a>                                         lambda_Nt, t_final)[<span class="dv">2</span>])</span>
<span id="cb123-77"><a href="#cb123-77" aria-hidden="true" tabindex="-1"></a>r_baja_ganancia_post_pandemia </span>
<span id="cb123-78"><a href="#cb123-78" aria-hidden="true" tabindex="-1"></a>prob_baja_ganancia_post_pandemia <span class="ot">&lt;-</span> <span class="fu">sum</span>(r_baja_ganancia_post_pandemia <span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">/</span></span>
<span id="cb123-79"><a href="#cb123-79" aria-hidden="true" tabindex="-1"></a>n_replicaciones</span>
<span id="cb123-80"><a href="#cb123-80" aria-hidden="true" tabindex="-1"></a>prob_baja_ganancia_post_pandemia</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div style="text-align:justify">
<p>Claramente la probabilidad de las ganancias bajas de la evolución de <span class="math inline">\(G(t)\)</span> después de la pandemia sea <span class="math inline">\(1\)</span>, pues como se muestra en la gráfica (<a href="#fig-trayectoria" class="quarto-xref">Figura&nbsp;<span>6.5</span></a>) #fig-trayectoriatodas las ventas registradas están por debajo del capital inicial</p>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<p>El código para calcular la probabilidad de las ganancias finales bajas durante las <span class="math inline">\(17\)</span> semanas es el siguiente:</p>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># libreria para poder renombrar </span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="co">#las cabeceras de los dataframes</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Parametros</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co">#semilla fija</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="dv">1759629</span> <span class="co">#surplus(capital inicial de salvamento)</span></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Es un estimado a partir de la media de las ganancias por semana, </span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="co">#multiplicado por 10/3, </span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="co">#siendo una proporción para evitar la ruina</span></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="co"># u (sum(medias))*(10/3)</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fl">0.29</span><span class="sc">*</span>u <span class="co">#prima de pago cada timepo t. c=0.5*u</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>lambda_Nt <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a><span class="co">#lambda_Xi = 3</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>t_final <span class="ot">=</span> <span class="dv">17</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="dv">1</span> <span class="co">#tiempos entrellegadas constantes</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a><span class="co">#df_media &lt;- data.frame(df_media%&gt;% rename(tiempos = Tiempo ,</span></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a><span class="co">#media_trayectoria = cramer_media)</span></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a><span class="co"># S(t) = \sum_{i=1}^{N(t)}X_i</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a><span class="co">#donde N(t)~ Poisson (lambda*t)</span></span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a><span class="co"># X_i ~ exponencial (lambda_Xi)</span></span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a><span class="co">#CL = REPRESENTA EL MODELO DE CRAMER LUNDBERG</span></span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulación de trayectoria de CL_t, cuando t &lt; t_final.</span></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a>trayectoria_CLt_post_pandemia <span class="ot">&lt;-</span> <span class="cf">function</span>(u, c, lambda_Nt, t_final)</span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a>  tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a>  Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(u)</span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">&lt;</span> t_final)</span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tiempo_llegada &lt;- rexp(1, rate = lambda_Nt)</span></span>
<span id="cb125-30"><a href="#cb125-30" aria-hidden="true" tabindex="-1"></a>    tiempo_llegada <span class="ot">&lt;-</span> (<span class="dv">1</span>) </span>
<span id="cb125-31"><a href="#cb125-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Suponiendo los tiempos entrellegadas constantes \mu = 1</span></span>
<span id="cb125-32"><a href="#cb125-32" aria-hidden="true" tabindex="-1"></a>    Y_i <span class="ot">&lt;-</span>  (<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">101919.050</span> , <span class="at">sd =</span> <span class="fl">10877.075</span>)<span class="sc">+</span> </span>
<span id="cb125-33"><a href="#cb125-33" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">39841.721</span> , <span class="at">sd=</span> <span class="fl">7873.446</span>) <span class="sc">+</span> </span>
<span id="cb125-34"><a href="#cb125-34" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">41751.747</span>, <span class="at">sd =</span> <span class="fl">5687.030</span>)<span class="sc">+</span> </span>
<span id="cb125-35"><a href="#cb125-35" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">43243.143</span>, <span class="at">sd =</span> <span class="fl">10517.841</span>)<span class="sc">+</span> </span>
<span id="cb125-36"><a href="#cb125-36" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">43010.307</span>  , <span class="at">sd =</span> <span class="fl">7741.889</span>)<span class="sc">+</span> </span>
<span id="cb125-37"><a href="#cb125-37" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">61191.300</span>  , <span class="at">sd =</span> <span class="fl">7202.989</span>)<span class="sc">+</span> </span>
<span id="cb125-38"><a href="#cb125-38" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">85684.058</span> , <span class="at">sd =</span> <span class="fl">8371.359</span> )) </span>
<span id="cb125-39"><a href="#cb125-39" aria-hidden="true" tabindex="-1"></a>    tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(tiempo, tiempo[<span class="fu">length</span>(tiempo)]<span class="sc">+</span> </span>
<span id="cb125-40"><a href="#cb125-40" aria-hidden="true" tabindex="-1"></a>                  tiempo_llegada,tiempo[<span class="fu">length</span>(tiempo)]<span class="sc">+</span> </span>
<span id="cb125-41"><a href="#cb125-41" aria-hidden="true" tabindex="-1"></a>                  tiempo_llegada ) </span>
<span id="cb125-42"><a href="#cb125-42" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(Cramer_trayectoria,</span>
<span id="cb125-43"><a href="#cb125-43" aria-hidden="true" tabindex="-1"></a>                      Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span></span>
<span id="cb125-44"><a href="#cb125-44" aria-hidden="true" tabindex="-1"></a>                      c<span class="sc">*</span>tiempo_llegada, </span>
<span id="cb125-45"><a href="#cb125-45" aria-hidden="true" tabindex="-1"></a>                      Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span> </span>
<span id="cb125-46"><a href="#cb125-46" aria-hidden="true" tabindex="-1"></a>                      c<span class="sc">*</span>tiempo_llegada <span class="sc">+</span>  Y_i )</span>
<span id="cb125-47"><a href="#cb125-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="dv">0</span>){</span>
<span id="cb125-48"><a href="#cb125-48" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb125-49"><a href="#cb125-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb125-50"><a href="#cb125-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb125-51"><a href="#cb125-51" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb125-52"><a href="#cb125-52" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb125-53"><a href="#cb125-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb125-54"><a href="#cb125-54" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.08*u es la ganancia inferior a la de un tasa de </span></span>
<span id="cb125-55"><a href="#cb125-55" aria-hidden="true" tabindex="-1"></a><span class="co"># un título financieropara el año 2018</span></span>
<span id="cb125-56"><a href="#cb125-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="fl">1.02833</span><span class="sc">*</span>u) {</span>
<span id="cb125-57"><a href="#cb125-57" aria-hidden="true" tabindex="-1"></a>    ganancia_no_deseada <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb125-58"><a href="#cb125-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb125-59"><a href="#cb125-59" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb125-60"><a href="#cb125-60" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb125-61"><a href="#cb125-61" aria-hidden="true" tabindex="-1"></a>    ganancia_no_deseada <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb125-62"><a href="#cb125-62" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb125-63"><a href="#cb125-63" aria-hidden="true" tabindex="-1"></a>  df_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tiempo, Cramer_trayectoria)</span>
<span id="cb125-64"><a href="#cb125-64" aria-hidden="true" tabindex="-1"></a>  df_trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df_post_pandemia<span class="sc">%&gt;%</span></span>
<span id="cb125-65"><a href="#cb125-65" aria-hidden="true" tabindex="-1"></a>                                            <span class="fu">rename</span>(<span class="at">Tiempo =</span> tiempo, </span>
<span id="cb125-66"><a href="#cb125-66" aria-hidden="true" tabindex="-1"></a>                                            <span class="at">Ct =</span> Cramer_trayectoria))</span>
<span id="cb125-67"><a href="#cb125-67" aria-hidden="true" tabindex="-1"></a>  salida <span class="ot">&lt;-</span> <span class="fu">c</span>(ruina, ganancia_no_deseada)</span>
<span id="cb125-68"><a href="#cb125-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(salida)</span>
<span id="cb125-69"><a href="#cb125-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb125-70"><a href="#cb125-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb125-71"><a href="#cb125-71" aria-hidden="true" tabindex="-1"></a>trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">trayectoria_CLt_post_pandemia</span>(u,c,</span>
<span id="cb125-72"><a href="#cb125-72" aria-hidden="true" tabindex="-1"></a>                                            lambda_Nt, t_final )</span>
<span id="cb125-73"><a href="#cb125-73" aria-hidden="true" tabindex="-1"></a><span class="co">#Método de monte carlo para estimar la probabilidad de ruina</span></span>
<span id="cb125-74"><a href="#cb125-74" aria-hidden="true" tabindex="-1"></a>n_replicaciones <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb125-75"><a href="#cb125-75" aria-hidden="true" tabindex="-1"></a>r_baja_ganancia_post_pandemia <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_replicaciones, </span>
<span id="cb125-76"><a href="#cb125-76" aria-hidden="true" tabindex="-1"></a>          <span class="fu">trayectoria_CLt_post_pandemia</span>(u, c, lambda_Nt, t_final)[<span class="dv">2</span>])</span>
<span id="cb125-77"><a href="#cb125-77" aria-hidden="true" tabindex="-1"></a><span class="co">#r_baja_ganancia_post_pandemia </span></span>
<span id="cb125-78"><a href="#cb125-78" aria-hidden="true" tabindex="-1"></a>prob_baja_ganancia_post_pandemia <span class="ot">&lt;-</span> <span class="fu">sum</span>(r_baja_ganancia_post_pandemia <span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">/</span></span>
<span id="cb125-79"><a href="#cb125-79" aria-hidden="true" tabindex="-1"></a>n_replicaciones</span>
<span id="cb125-80"><a href="#cb125-80" aria-hidden="true" tabindex="-1"></a>prob_baja_ganancia_post_pandemia</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
<div style="text-align:justify">
<p>El código para calcular la probabilidad de ruina es el siguiente:</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># libreria para poder renombrar </span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="co">#las cabeceras de los dataframes</span></span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Parametros</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co">#semilla fija</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="dv">1759629</span> <span class="co">#surplus(capital inicial de salvamento)</span></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Es un estimado a partir de la media de las ganancias por semana, </span></span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a><span class="co">#multiplicado por 10/3, </span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="co">#siendo una proporción para evitar la ruina</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a><span class="co"># u (sum(medias))*(10/3)</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fl">0.29</span><span class="sc">*</span>u <span class="co">#prima de pago cada timepo t. c=0.5*u</span></span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a>lambda_Nt <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a><span class="co">#lambda_Xi = 3</span></span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a>t_final <span class="ot">=</span> <span class="dv">14</span></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="dv">1</span> <span class="co">#tiempos entrellegadas constantes</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a><span class="co">#df_media &lt;- data.frame(df_media%&gt;% rename(tiempos = Tiempo , </span></span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a><span class="co">#media_trayectoria = cramer_media)</span></span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a><span class="co"># S(t) = \sum_{i=1}^{N(t)}X_i</span></span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a><span class="co">#donde N(t)~ Poisson (lambda*t)</span></span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a><span class="co"># X_i ~ exponencial (lambda_Xi)</span></span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a><span class="co">#CL = REPRESENTA EL MODELO DE CRAMER LUNDBERG</span></span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulación de trayectoria de CL_t, cuando t &lt; t_final.</span></span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a>trayectoria_CLt_post_pandemia <span class="ot">&lt;-</span> <span class="cf">function</span>(u, c, lambda_Nt, t_final)</span>
<span id="cb127-24"><a href="#cb127-24" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb127-25"><a href="#cb127-25" aria-hidden="true" tabindex="-1"></a>  tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb127-26"><a href="#cb127-26" aria-hidden="true" tabindex="-1"></a>  Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(u)</span>
<span id="cb127-27"><a href="#cb127-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">&lt;</span> t_final)</span>
<span id="cb127-28"><a href="#cb127-28" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb127-29"><a href="#cb127-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tiempo_llegada &lt;- rexp(1, rate = lambda_Nt)</span></span>
<span id="cb127-30"><a href="#cb127-30" aria-hidden="true" tabindex="-1"></a>    tiempo_llegada <span class="ot">&lt;-</span> (<span class="dv">1</span>) </span>
<span id="cb127-31"><a href="#cb127-31" aria-hidden="true" tabindex="-1"></a><span class="co">#Suponiendo los tiempos entrellegadas constantes \mu = 1</span></span>
<span id="cb127-32"><a href="#cb127-32" aria-hidden="true" tabindex="-1"></a>    Y_i <span class="ot">&lt;-</span>  (<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">101919.050</span> , <span class="at">sd =</span> <span class="fl">10877.075</span>)  <span class="sc">+</span></span>
<span id="cb127-33"><a href="#cb127-33" aria-hidden="true" tabindex="-1"></a>               <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">39841.721</span> , <span class="at">sd=</span> <span class="fl">7873.446</span> ) <span class="sc">+</span> </span>
<span id="cb127-34"><a href="#cb127-34" aria-hidden="true" tabindex="-1"></a>               <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">41751.747</span>, <span class="at">sd =</span> <span class="fl">5687.030</span>) <span class="sc">+</span> </span>
<span id="cb127-35"><a href="#cb127-35" aria-hidden="true" tabindex="-1"></a>               <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">43243.143</span>, <span class="at">sd =</span> <span class="fl">10517.841</span>)<span class="sc">+</span> </span>
<span id="cb127-36"><a href="#cb127-36" aria-hidden="true" tabindex="-1"></a>               <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">43010.307</span>  , <span class="at">sd =</span> <span class="fl">7741.889</span> )<span class="sc">+</span></span>
<span id="cb127-37"><a href="#cb127-37" aria-hidden="true" tabindex="-1"></a>               <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">61191.300</span>  , <span class="at">sd =</span> <span class="fl">7202.989</span>) <span class="sc">+</span></span>
<span id="cb127-38"><a href="#cb127-38" aria-hidden="true" tabindex="-1"></a>               <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">85684.058</span> , <span class="at">sd =</span> <span class="fl">8371.359</span> )) </span>
<span id="cb127-39"><a href="#cb127-39" aria-hidden="true" tabindex="-1"></a>    tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(tiempo, tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span></span>
<span id="cb127-40"><a href="#cb127-40" aria-hidden="true" tabindex="-1"></a>                  tiempo_llegada,tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span> </span>
<span id="cb127-41"><a href="#cb127-41" aria-hidden="true" tabindex="-1"></a>                  tiempo_llegada ) </span>
<span id="cb127-42"><a href="#cb127-42" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(Cramer_trayectoria,</span>
<span id="cb127-43"><a href="#cb127-43" aria-hidden="true" tabindex="-1"></a>                       Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span></span>
<span id="cb127-44"><a href="#cb127-44" aria-hidden="true" tabindex="-1"></a>                          c<span class="sc">*</span>tiempo_llegada, </span>
<span id="cb127-45"><a href="#cb127-45" aria-hidden="true" tabindex="-1"></a>                       Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span></span>
<span id="cb127-46"><a href="#cb127-46" aria-hidden="true" tabindex="-1"></a>                         c<span class="sc">*</span>tiempo_llegada <span class="sc">+</span>  Y_i )</span>
<span id="cb127-47"><a href="#cb127-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="dv">0</span>){</span>
<span id="cb127-48"><a href="#cb127-48" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb127-49"><a href="#cb127-49" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb127-50"><a href="#cb127-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb127-51"><a href="#cb127-51" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb127-52"><a href="#cb127-52" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb127-53"><a href="#cb127-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb127-54"><a href="#cb127-54" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.08*u es la ganancia inferior a la de un tasa de </span></span>
<span id="cb127-55"><a href="#cb127-55" aria-hidden="true" tabindex="-1"></a><span class="co"># un título financiero para el año 2018</span></span>
<span id="cb127-56"><a href="#cb127-56" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="fl">1.02333</span><span class="sc">*</span>u) {</span>
<span id="cb127-57"><a href="#cb127-57" aria-hidden="true" tabindex="-1"></a>    ganancia_no_deseada <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb127-58"><a href="#cb127-58" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb127-59"><a href="#cb127-59" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb127-60"><a href="#cb127-60" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb127-61"><a href="#cb127-61" aria-hidden="true" tabindex="-1"></a>    ganancia_no_deseada <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb127-62"><a href="#cb127-62" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb127-63"><a href="#cb127-63" aria-hidden="true" tabindex="-1"></a>  df_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tiempo, Cramer_trayectoria)</span>
<span id="cb127-64"><a href="#cb127-64" aria-hidden="true" tabindex="-1"></a>  df_trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df_post_pandemia<span class="sc">%&gt;%</span> </span>
<span id="cb127-65"><a href="#cb127-65" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">rename</span>(<span class="at">Tiempo =</span> tiempo, </span>
<span id="cb127-66"><a href="#cb127-66" aria-hidden="true" tabindex="-1"></a>                                  <span class="at">Ct =</span> Cramer_trayectoria))</span>
<span id="cb127-67"><a href="#cb127-67" aria-hidden="true" tabindex="-1"></a>  salida <span class="ot">&lt;-</span> <span class="fu">c</span>(ruina, ganancia_no_deseada)</span>
<span id="cb127-68"><a href="#cb127-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(salida)</span>
<span id="cb127-69"><a href="#cb127-69" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb127-70"><a href="#cb127-70" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb127-71"><a href="#cb127-71" aria-hidden="true" tabindex="-1"></a>trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">trayectoria_CLt_post_pandemia</span>(u,c,</span>
<span id="cb127-72"><a href="#cb127-72" aria-hidden="true" tabindex="-1"></a>                                            lambda_Nt, t_final )</span>
<span id="cb127-73"><a href="#cb127-73" aria-hidden="true" tabindex="-1"></a><span class="co">#Método de monte carlo para estimar la probabilidad de ruina</span></span>
<span id="cb127-74"><a href="#cb127-74" aria-hidden="true" tabindex="-1"></a>n_replicaciones <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb127-75"><a href="#cb127-75" aria-hidden="true" tabindex="-1"></a>r_ruina_post_pandemia <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_replicaciones,</span>
<span id="cb127-76"><a href="#cb127-76" aria-hidden="true" tabindex="-1"></a>          <span class="fu">trayectoria_CLt_post_pandemia</span>(u, c, lambda_Nt, t_final)[<span class="dv">1</span>])</span>
<span id="cb127-77"><a href="#cb127-77" aria-hidden="true" tabindex="-1"></a><span class="co">#r_ruina_post_pandemia</span></span>
<span id="cb127-78"><a href="#cb127-78" aria-hidden="true" tabindex="-1"></a>prob_ruin_post_pandemia <span class="ot">&lt;-</span> <span class="fu">sum</span>(r_ruina_post_pandemia<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">/</span></span>
<span id="cb127-79"><a href="#cb127-79" aria-hidden="true" tabindex="-1"></a>n_replicaciones</span>
<span id="cb127-80"><a href="#cb127-80" aria-hidden="true" tabindex="-1"></a>prob_ruin_post_pandemia</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div style="text-align:justify">
<p>Lo que significa que a pesar de que las ganancias sean todas menores al capital inicial, en todas la simulaciones, nunca se presenta una que sea menor que cero.</p>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div style="text-align:justify">
<p>El código para calcular la probabilidad de ruina durante las <span class="math inline">\(17\)</span> semanas es el siguiente:</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># libreria para poder renombrar </span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="co">#las cabeceras de los dataframes</span></span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Parametros</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co">#semilla fija</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="dv">1759629</span> <span class="co">#surplus(capital inicial de salvamento)</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Es un estimado a partir de la media de las ganancias por semana, </span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a><span class="co">#multiplicado por 10/3, </span></span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="co">#siendo una proporción para evitar la ruina</span></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="co"># u (sum(medias))*(10/3)</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span> <span class="fl">0.29</span><span class="sc">*</span>u <span class="co">#prima de pago cada timepo t. c=0.5*u</span></span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a>lambda_Nt <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="co">#lambda_Xi = 3</span></span>
<span id="cb129-14"><a href="#cb129-14" aria-hidden="true" tabindex="-1"></a>t_final <span class="ot">=</span> <span class="dv">17</span></span>
<span id="cb129-15"><a href="#cb129-15" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">=</span> <span class="dv">1</span> <span class="co">#tiempos entrellegadas constantes</span></span>
<span id="cb129-16"><a href="#cb129-16" aria-hidden="true" tabindex="-1"></a><span class="co">#df_media &lt;- data.frame(df_media%&gt;% rename(tiempos = Tiempo , </span></span>
<span id="cb129-17"><a href="#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="co">#media_trayectoria = cramer_media)</span></span>
<span id="cb129-18"><a href="#cb129-18" aria-hidden="true" tabindex="-1"></a><span class="co"># S(t) = \sum_{i=1}^{N(t)}X_i</span></span>
<span id="cb129-19"><a href="#cb129-19" aria-hidden="true" tabindex="-1"></a><span class="co">#donde N(t)~ Poisson (lambda*t)</span></span>
<span id="cb129-20"><a href="#cb129-20" aria-hidden="true" tabindex="-1"></a><span class="co"># X_i ~ exponencial (lambda_Xi)</span></span>
<span id="cb129-21"><a href="#cb129-21" aria-hidden="true" tabindex="-1"></a><span class="co">#CL = REPRESENTA EL MODELO DE CRAMER LUNDBERG</span></span>
<span id="cb129-22"><a href="#cb129-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulación de trayectoria de CL_t, cuando t &lt; t_final.</span></span>
<span id="cb129-23"><a href="#cb129-23" aria-hidden="true" tabindex="-1"></a>trayectoria_CLt_post_pandemia <span class="ot">&lt;-</span> <span class="cf">function</span>(u, c, lambda_Nt, t_final)</span>
<span id="cb129-24"><a href="#cb129-24" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb129-25"><a href="#cb129-25" aria-hidden="true" tabindex="-1"></a>  tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb129-26"><a href="#cb129-26" aria-hidden="true" tabindex="-1"></a>  Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(u)</span>
<span id="cb129-27"><a href="#cb129-27" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">&lt;</span> t_final)</span>
<span id="cb129-28"><a href="#cb129-28" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb129-29"><a href="#cb129-29" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tiempo_llegada &lt;- rexp(1, rate = lambda_Nt)</span></span>
<span id="cb129-30"><a href="#cb129-30" aria-hidden="true" tabindex="-1"></a>    tiempo_llegada <span class="ot">&lt;-</span> (<span class="dv">1</span>) </span>
<span id="cb129-31"><a href="#cb129-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Suponiendo los tiempos entrellegadas constantes \mu = 1</span></span>
<span id="cb129-32"><a href="#cb129-32" aria-hidden="true" tabindex="-1"></a>    Y_i <span class="ot">&lt;-</span>  (<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">101919.050</span> , <span class="at">sd =</span> <span class="fl">10877.075</span>)  <span class="sc">+</span> </span>
<span id="cb129-33"><a href="#cb129-33" aria-hidden="true" tabindex="-1"></a>               <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">39841.721</span> , <span class="at">sd=</span> <span class="fl">7873.446</span>)  <span class="sc">+</span>  </span>
<span id="cb129-34"><a href="#cb129-34" aria-hidden="true" tabindex="-1"></a>               <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">41751.747</span>, <span class="at">sd =</span> <span class="fl">5687.030</span>) <span class="sc">+</span> </span>
<span id="cb129-35"><a href="#cb129-35" aria-hidden="true" tabindex="-1"></a>               <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">43243.143</span>, <span class="at">sd =</span> <span class="fl">10517.841</span>)<span class="sc">+</span> </span>
<span id="cb129-36"><a href="#cb129-36" aria-hidden="true" tabindex="-1"></a>               <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">43010.307</span>  , <span class="at">sd =</span> <span class="fl">7741.889</span>) <span class="sc">+</span> </span>
<span id="cb129-37"><a href="#cb129-37" aria-hidden="true" tabindex="-1"></a>               <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">85684.058</span> , <span class="at">sd =</span> <span class="fl">8371.359</span>)) </span>
<span id="cb129-38"><a href="#cb129-38" aria-hidden="true" tabindex="-1"></a>    tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(tiempo, tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span> </span>
<span id="cb129-39"><a href="#cb129-39" aria-hidden="true" tabindex="-1"></a>                  tiempo_llegada,tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">+</span> </span>
<span id="cb129-40"><a href="#cb129-40" aria-hidden="true" tabindex="-1"></a>                  tiempo_llegada ) </span>
<span id="cb129-41"><a href="#cb129-41" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(Cramer_trayectoria,</span>
<span id="cb129-42"><a href="#cb129-42" aria-hidden="true" tabindex="-1"></a>                      Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span></span>
<span id="cb129-43"><a href="#cb129-43" aria-hidden="true" tabindex="-1"></a>                      c<span class="sc">*</span>tiempo_llegada, </span>
<span id="cb129-44"><a href="#cb129-44" aria-hidden="true" tabindex="-1"></a>                      Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span> </span>
<span id="cb129-45"><a href="#cb129-45" aria-hidden="true" tabindex="-1"></a>                      c<span class="sc">*</span>tiempo_llegada <span class="sc">+</span>  Y_i )</span>
<span id="cb129-46"><a href="#cb129-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="dv">0</span>){</span>
<span id="cb129-47"><a href="#cb129-47" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb129-48"><a href="#cb129-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb129-49"><a href="#cb129-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>{</span>
<span id="cb129-50"><a href="#cb129-50" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb129-51"><a href="#cb129-51" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb129-52"><a href="#cb129-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb129-53"><a href="#cb129-53" aria-hidden="true" tabindex="-1"></a><span class="co"># 1.08*u es la ganancia inferior a la de </span></span>
<span id="cb129-54"><a href="#cb129-54" aria-hidden="true" tabindex="-1"></a><span class="co"># un tasa de un título financiero para el año 2018</span></span>
<span id="cb129-55"><a href="#cb129-55" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="fl">1.02833</span><span class="sc">*</span>u) {</span>
<span id="cb129-56"><a href="#cb129-56" aria-hidden="true" tabindex="-1"></a>    ganancia_no_deseada <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb129-57"><a href="#cb129-57" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb129-58"><a href="#cb129-58" aria-hidden="true" tabindex="-1"></a>  } </span>
<span id="cb129-59"><a href="#cb129-59" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>{</span>
<span id="cb129-60"><a href="#cb129-60" aria-hidden="true" tabindex="-1"></a>    ganancia_no_deseada <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb129-61"><a href="#cb129-61" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb129-62"><a href="#cb129-62" aria-hidden="true" tabindex="-1"></a>  df_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tiempo, Cramer_trayectoria)</span>
<span id="cb129-63"><a href="#cb129-63" aria-hidden="true" tabindex="-1"></a>  df_trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df_post_pandemia<span class="sc">%&gt;%</span> </span>
<span id="cb129-64"><a href="#cb129-64" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">rename</span>(<span class="at">Tiempo =</span> tiempo, </span>
<span id="cb129-65"><a href="#cb129-65" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">Ct =</span> Cramer_trayectoria))</span>
<span id="cb129-66"><a href="#cb129-66" aria-hidden="true" tabindex="-1"></a>  salida <span class="ot">&lt;-</span> <span class="fu">c</span>(ruina, ganancia_no_deseada)</span>
<span id="cb129-67"><a href="#cb129-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(salida)</span>
<span id="cb129-68"><a href="#cb129-68" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb129-69"><a href="#cb129-69" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb129-70"><a href="#cb129-70" aria-hidden="true" tabindex="-1"></a>trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">trayectoria_CLt_post_pandemia</span>(u,c,</span>
<span id="cb129-71"><a href="#cb129-71" aria-hidden="true" tabindex="-1"></a>                                            lambda_Nt, t_final )</span>
<span id="cb129-72"><a href="#cb129-72" aria-hidden="true" tabindex="-1"></a><span class="co">#Método de monte carlo para estimar la probabilidad de ruina</span></span>
<span id="cb129-73"><a href="#cb129-73" aria-hidden="true" tabindex="-1"></a>n_replicaciones <span class="ot">=</span> <span class="dv">100</span></span>
<span id="cb129-74"><a href="#cb129-74" aria-hidden="true" tabindex="-1"></a>r_ruina_post_pandemia <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_replicaciones,</span>
<span id="cb129-75"><a href="#cb129-75" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">trayectoria_CLt_post_pandemia</span>(u, c, </span>
<span id="cb129-76"><a href="#cb129-76" aria-hidden="true" tabindex="-1"></a>                                          lambda_Nt, t_final)[<span class="dv">1</span>])</span>
<span id="cb129-77"><a href="#cb129-77" aria-hidden="true" tabindex="-1"></a><span class="co">#r_ruina_post_pandemia</span></span>
<span id="cb129-78"><a href="#cb129-78" aria-hidden="true" tabindex="-1"></a>prob_ruin_post_pandemia <span class="ot">&lt;-</span> <span class="fu">sum</span>(r_ruina_post_pandemia<span class="sc">&gt;</span><span class="dv">0</span>)<span class="sc">/</span></span>
<span id="cb129-79"><a href="#cb129-79" aria-hidden="true" tabindex="-1"></a>n_replicaciones</span>
<span id="cb129-80"><a href="#cb129-80" aria-hidden="true" tabindex="-1"></a>prob_ruin_post_pandemia</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1</code></pre>
</div>
</div>
</section>
<section id="análisis-de-sensibilidad-1" class="level4" data-number="6.4.2.3">
<h4 data-number="6.4.2.3" class="anchored" data-anchor-id="análisis-de-sensibilidad-1"><span class="header-section-number">6.4.2.3</span> Análisis de sensibilidad</h4>
<div style="text-align:justify">
<p>Modificando los parámetros <span class="math inline">\(u\)</span> y <span class="math inline">\(c\)</span> para erl periodo pso-pandemia del modelo modificado y estableciendo los rangos o valores posibles para cada uno de los ciertos parámetros, se presenta el análisis de sensibilidad durante las semanas registradas después de la pandemia que fueron <span class="math inline">\(14\)</span>,. Se toman la mediana de las <span class="math inline">\(100\)</span> simulaciones de la ganancia final de la semana obtenida por el modelo, es decir la venta registrada en la última semana de los datos registrados.</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># librería para poder renombrar </span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="co"># las cabeceras de los dataframes</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Parametros</span></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co">#semilla fija</span></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="dv">1759629</span> <span class="co">#surplus(capital inicial de salvamento)</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Es un estimado a partir de la media de las ganancias por semana, </span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="co">#multiplicado por 10/3, </span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a><span class="co">#siendo una proporción para evitar la ruina</span></span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a><span class="co"># u (sum(medias))*(10/3)</span></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>decimal_c <span class="ot">=</span> <span class="fl">0.29</span></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span>decimal_c<span class="sc">*</span>u <span class="co">#prima de pago cada timepo t. c = 0.5*u</span></span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>lambda_Nt <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a><span class="co">#lambda_Xi = 3</span></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>t_final <span class="ot">=</span> <span class="dv">14</span></span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a><span class="co"># S(t) = \sum_{i=1}^{N(t)}X_i</span></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a><span class="co">#donde N(t)~ Poisson (lambda*t)</span></span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a><span class="co"># X_i ~ exponencial (lambda_Xi)</span></span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a><span class="co">#CL = REPRESENTA EL MODELO DE CRAMER LUNDBERG</span></span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a><span class="co">#Simulación de trayectoria de CL_t, cuando t &lt; t_final.</span></span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>trayectoria_CLt_post_pandemia <span class="ot">&lt;-</span> <span class="cf">function</span>(u, c, lambda_Nt, t_final)</span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>  tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>  Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(u)</span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">&lt;</span> t_final)</span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tiempo_llegada &lt;- rexp(1, rate = lambda_Nt)</span></span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>    tiempo_llegada <span class="ot">&lt;-</span> (<span class="dv">1</span>)</span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>    Y_i <span class="ot">&lt;-</span>  (<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">101919.050</span> , <span class="at">sd =</span> <span class="fl">10877.075</span>) <span class="sc">+</span> </span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">39841.721</span> , <span class="at">sd=</span> <span class="fl">7873.446</span>)  <span class="sc">+</span>  </span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">41751.747</span>, <span class="at">sd =</span> <span class="fl">5687.030</span>) <span class="sc">+</span> </span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">43243.143</span>, <span class="at">sd =</span> <span class="fl">10517.841</span>)<span class="sc">+</span> </span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">43010.307</span>  , <span class="at">sd =</span> <span class="fl">7741.889</span>) <span class="sc">+</span> </span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">61191.300</span>  , <span class="at">sd =</span> <span class="fl">7202.989</span>) <span class="sc">+</span> </span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">85684.058</span> , <span class="at">sd =</span> <span class="fl">8371.359</span>)) </span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>    tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(tiempo, tiempo[<span class="fu">length</span>(tiempo)] </span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> tiempo_llegada,tiempo[<span class="fu">length</span>(tiempo)] </span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> tiempo_llegada ) </span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(Cramer_trayectoria,</span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>                      Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span> </span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a>                        c<span class="sc">*</span>tiempo_llegada, </span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a>                      Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span> </span>
<span id="cb131-43"><a href="#cb131-43" aria-hidden="true" tabindex="-1"></a>                       c<span class="sc">*</span>tiempo_llegada <span class="sc">+</span>  Y_i )</span>
<span id="cb131-44"><a href="#cb131-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb131-45"><a href="#cb131-45" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb131-46"><a href="#cb131-46" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb131-47"><a href="#cb131-47" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb131-48"><a href="#cb131-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb131-49"><a href="#cb131-49" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb131-50"><a href="#cb131-50" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb131-51"><a href="#cb131-51" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb131-52"><a href="#cb131-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-53"><a href="#cb131-53" aria-hidden="true" tabindex="-1"></a>  df_post_pandemia<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tiempo, Cramer_trayectoria)</span>
<span id="cb131-54"><a href="#cb131-54" aria-hidden="true" tabindex="-1"></a>  df_trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df_post_pandemia<span class="sc">%&gt;%</span></span>
<span id="cb131-55"><a href="#cb131-55" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">rename</span>(<span class="at">Tiempo =</span> tiempo, </span>
<span id="cb131-56"><a href="#cb131-56" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">Ct =</span> Cramer_trayectoria))</span>
<span id="cb131-57"><a href="#cb131-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_trayectoria_post_pandemia<span class="sc">$</span>Ct[length</span>
<span id="cb131-58"><a href="#cb131-58" aria-hidden="true" tabindex="-1"></a>                                (df_trayectoria_post_pandemia<span class="sc">$</span>Ct)])</span>
<span id="cb131-59"><a href="#cb131-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-60"><a href="#cb131-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-61"><a href="#cb131-61" aria-hidden="true" tabindex="-1"></a><span class="co"># La función generador_mediana nos calcula la mediana de </span></span>
<span id="cb131-62"><a href="#cb131-62" aria-hidden="true" tabindex="-1"></a><span class="co"># las ganancias finales de 100 trayectorias, </span></span>
<span id="cb131-63"><a href="#cb131-63" aria-hidden="true" tabindex="-1"></a><span class="co"># fijando el u= surplus y el c</span></span>
<span id="cb131-64"><a href="#cb131-64" aria-hidden="true" tabindex="-1"></a>generador_mediana_post_pandemia<span class="ot">&lt;-</span> <span class="cf">function</span>(ui,cj)</span>
<span id="cb131-65"><a href="#cb131-65" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb131-66"><a href="#cb131-66" aria-hidden="true" tabindex="-1"></a>  ganancia_final_replicas_post_pandemia <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100</span>,</span>
<span id="cb131-67"><a href="#cb131-67" aria-hidden="true" tabindex="-1"></a>           <span class="fu">trayectoria_CLt_post_pandemia</span>(u, c,lambda_Nt, t_final))</span>
<span id="cb131-68"><a href="#cb131-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>( <span class="fu">median</span>(ganancia_final_replicas_post_pandemia))</span>
<span id="cb131-69"><a href="#cb131-69" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-70"><a href="#cb131-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Se crea la rejilla donde se hace el analisis de sensibilidad</span></span>
<span id="cb131-71"><a href="#cb131-71" aria-hidden="true" tabindex="-1"></a><span class="co"># para diferentes valores de u y c</span></span>
<span id="cb131-72"><a href="#cb131-72" aria-hidden="true" tabindex="-1"></a>grid_u_post_pandemia <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> (u<span class="dv">-100000</span><span class="sc">*</span><span class="dv">4</span>), </span>
<span id="cb131-73"><a href="#cb131-73" aria-hidden="true" tabindex="-1"></a>                            <span class="at">to =</span> (u<span class="sc">+</span><span class="dv">100000</span><span class="sc">*</span><span class="dv">4</span>), </span>
<span id="cb131-74"><a href="#cb131-74" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by =</span> <span class="dv">100000</span>)</span>
<span id="cb131-75"><a href="#cb131-75" aria-hidden="true" tabindex="-1"></a>grid_c_post_pandemia <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> (decimal_c<span class="fl">-0.01</span><span class="sc">*</span><span class="dv">4</span>), </span>
<span id="cb131-76"><a href="#cb131-76" aria-hidden="true" tabindex="-1"></a>                            <span class="at">to =</span> (decimal_c<span class="fl">+0.01</span><span class="sc">*</span><span class="dv">4</span>), </span>
<span id="cb131-77"><a href="#cb131-77" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb131-78"><a href="#cb131-78" aria-hidden="true" tabindex="-1"></a>u_t <span class="ot">&lt;-</span> grid_u_post_pandemia</span>
<span id="cb131-79"><a href="#cb131-79" aria-hidden="true" tabindex="-1"></a>matriz_mediana_post_pandemia <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, </span>
<span id="cb131-80"><a href="#cb131-80" aria-hidden="true" tabindex="-1"></a>      <span class="fu">length</span>(grid_u_post_pandemia)<span class="sc">*</span><span class="fu">length</span>(grid_c_post_pandemia)),</span>
<span id="cb131-81"><a href="#cb131-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">nrow=</span> <span class="fu">length</span>(grid_u_post_pandemia), </span>
<span id="cb131-82"><a href="#cb131-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">ncol=</span> <span class="fu">length</span>(grid_c_post_pandemia))</span>
<span id="cb131-83"><a href="#cb131-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-84"><a href="#cb131-84" aria-hidden="true" tabindex="-1"></a>G_t <span class="ot">&lt;-</span> matriz_mediana_post_pandemia</span>
<span id="cb131-85"><a href="#cb131-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-86"><a href="#cb131-86" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(u_t)) </span>
<span id="cb131-87"><a href="#cb131-87" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb131-88"><a href="#cb131-88" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(grid_c_post_pandemia)) </span>
<span id="cb131-89"><a href="#cb131-89" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb131-90"><a href="#cb131-90" aria-hidden="true" tabindex="-1"></a>    G_t[i,j] <span class="ot">&lt;-</span> <span class="fu">generador_mediana_post_pandemia</span>(u_t[i], </span>
<span id="cb131-91"><a href="#cb131-91" aria-hidden="true" tabindex="-1"></a>                                  grid_c_post_pandemia[j]<span class="sc">*</span>u_t[i])</span>
<span id="cb131-92"><a href="#cb131-92" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-93"><a href="#cb131-93" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb131-94"><a href="#cb131-94" aria-hidden="true" tabindex="-1"></a><span class="co"># matriz_mediana_post_pandemia  </span></span>
<span id="cb131-95"><a href="#cb131-95" aria-hidden="true" tabindex="-1"></a><span class="co"># Grafica del ánalisis de sensibilidad</span></span>
<span id="cb131-96"><a href="#cb131-96" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb131-97"><a href="#cb131-97" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb131-98"><a href="#cb131-98" aria-hidden="true" tabindex="-1"></a>c_t <span class="ot">&lt;-</span> u_t<span class="sc">*</span>grid_c_post_pandemia</span>
<span id="cb131-99"><a href="#cb131-99" aria-hidden="true" tabindex="-1"></a>fig2 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb131-100"><a href="#cb131-100" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'surface'</span>,</span>
<span id="cb131-101"><a href="#cb131-101" aria-hidden="true" tabindex="-1"></a>  <span class="at">contours =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="fu">list</span>(<span class="at">show =</span> <span class="cn">TRUE</span>, <span class="at">start =</span> u_t[<span class="dv">1</span>], </span>
<span id="cb131-102"><a href="#cb131-102" aria-hidden="true" tabindex="-1"></a>                  <span class="at">end =</span> grid_u_post_pandemia[<span class="fu">length</span>(u_t)], </span>
<span id="cb131-103"><a href="#cb131-103" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span><span class="dv">100000</span> , <span class="at">color =</span> <span class="st">'black'</span>),</span>
<span id="cb131-104"><a href="#cb131-104" aria-hidden="true" tabindex="-1"></a>                  <span class="at">z =</span> <span class="fu">list</span>(<span class="at">show =</span> <span class="cn">TRUE</span>, <span class="at">start =</span> G_t[<span class="dv">1</span>], </span>
<span id="cb131-105"><a href="#cb131-105" aria-hidden="true" tabindex="-1"></a>                  <span class="at">end =</span> G_t[<span class="fu">length</span>(G_t)], </span>
<span id="cb131-106"><a href="#cb131-106" aria-hidden="true" tabindex="-1"></a>                  <span class="at">size =</span> <span class="fl">0.01</span><span class="sc">*</span><span class="dv">100000</span>)),</span>
<span id="cb131-107"><a href="#cb131-107" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>u_t,</span>
<span id="cb131-108"><a href="#cb131-108" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>c_t,</span>
<span id="cb131-109"><a href="#cb131-109" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="sc">~</span>G_t)</span>
<span id="cb131-110"><a href="#cb131-110" aria-hidden="true" tabindex="-1"></a>fig2 <span class="ot">&lt;-</span> fig2 <span class="sc">%&gt;%</span> <span class="fu">layout</span>(</span>
<span id="cb131-111"><a href="#cb131-111" aria-hidden="true" tabindex="-1"></a>    <span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb131-112"><a href="#cb131-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">nticks =</span> <span class="dv">20</span>),</span>
<span id="cb131-113"><a href="#cb131-113" aria-hidden="true" tabindex="-1"></a>    <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">nticks =</span> <span class="dv">4</span>),</span>
<span id="cb131-114"><a href="#cb131-114" aria-hidden="true" tabindex="-1"></a>    <span class="at">camera =</span> <span class="fu">list</span>(<span class="at">eye =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="dv">0</span>, </span>
<span id="cb131-115"><a href="#cb131-115" aria-hidden="true" tabindex="-1"></a>                             <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span>, </span>
<span id="cb131-116"><a href="#cb131-116" aria-hidden="true" tabindex="-1"></a>                             <span class="at">z =</span> <span class="dv">1</span>)),</span>
<span id="cb131-117"><a href="#cb131-117" aria-hidden="true" tabindex="-1"></a>    <span class="at">aspectratio =</span> <span class="fu">list</span>(<span class="at">x =</span> .<span class="dv">9</span>, <span class="at">y =</span> .<span class="dv">8</span>, <span class="at">z =</span> <span class="fl">0.2</span>)))</span>
<span id="cb131-118"><a href="#cb131-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-119"><a href="#cb131-119" aria-hidden="true" tabindex="-1"></a>fig2</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-2fc2ab1f018008862249" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2fc2ab1f018008862249">{"x":{"visdat":{"5030795e7772":["function () ","plotlyVisDat"]},"cur_data":"5030795e7772","attrs":{"5030795e7772":{"contours":{"x":{"show":true,"start":1359629,"end":2159629,"size":100000,"color":"black"},"z":{"show":true,"start":454092.34907058818,"end":456572.36400168837,"size":1000}},"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"nticks":20,"title":"u_t"},"zaxis":{"nticks":4,"title":"G_t"},"camera":{"eye":{"x":0,"y":-1,"z":1}},"aspectratio":{"x":0.90000000000000002,"y":0.80000000000000004,"z":0.20000000000000001},"yaxis":{"title":"c_t"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"G_t","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666663","rgba(70,19,97,1)"],["0.0833333333333336","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666666","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.500000000000001","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666666","rgba(199,225,42,1)"],["0.958333333333334","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"contours":{"x":{"show":true,"start":1359629,"end":2159629,"size":100000,"color":"black"},"z":{"show":true,"start":454092.34907058818,"end":456572.36400168837,"size":1000}},"x":[1359629,1459629,1559629,1659629,1759629,1859629,1959629,2059629,2159629],"y":[339907.24999999994,379503.53999999992,421099.82999999996,464696.11999999994,510292.40999999997,557888.69999999995,607484.98999999987,659081.27999999991,712677.56999999995],"z":[[454092.34907058818,453093.35680890409,439565.20977918193,444431.83976858779,464158.30317293736,446552.78444350825,456243.50502816564,435163.32929764793,452611.96853757906],[467137.63421506598,452209.25350370596,462065.43938073039,442431.08984707075,459172.95955152786,449903.77295475436,452231.84594520729,455449.95546715747,441007.78657056688],[446099.12703727279,459552.04022215656,445301.0475531962,454538.6451131521,442603.07121928176,460499.68658917921,448017.40883160511,441433.7295231825,451673.25414403749],[437306.92630781501,447358.9631014429,444602.55542576336,444072.17745284189,454895.94517371221,454675.97676431597,435580.0187345859,449567.06202769815,437004.31228275306],[469412.52296787116,455337.54838576022,456218.22211003391,458949.89381340117,453876.86500159866,443523.99915329681,461161.4609116136,453508.99101114908,457955.60565604654],[444544.55288381909,450224.87555215234,440942.19135131186,450164.61218841351,457465.01719169517,448151.23010054103,447776.78011783934,434185.07305141736,458471.75831244898],[446517.23831105151,440462.36036760721,454281.0818749629,457703.89162527607,423146.35523610149,437460.66286237939,440114.5660556528,470860.27435214608,435927.49965698808],[477139.04320102523,467933.54579202126,438436.78042156145,442122.56290584692,453049.12481540546,454346.10823955922,454268.17088881909,462259.00973362348,458807.56233917992],[450117.68241106614,442396.810712184,435993.97567394422,451287.20801693015,450000.51957465126,456534.82773747109,455896.52017224778,447831.59130039776,456572.36400168837]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="fig-analisis2pdf.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="600"></p>
</figure>
</div>
<div style="text-align:justify">
<p>Se presenta también el análisis de sensibilidad para <span class="math inline">\(t = 19\)</span>, debido a que en <span class="math inline">\(19\)</span> semanas se presenta el caso donde se pueden registrar ventas por debajo del cero, es decir, casos donde <span class="math inline">\(G(t)\leq0\)</span>.</p>
</div>
<div class="cell">
<details class="code-fold">
<summary>Código</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) <span class="co"># libreria para poder </span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a><span class="co"># renombrar las cabeceras de los dataframes</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Parametros</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>) <span class="co">#semilla fija</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>u <span class="ot">=</span> <span class="dv">1759629</span> <span class="co">#surplus(capital inicial de salvamento)</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Es un estimado a partir de la media de las ganancias por semana, </span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="co"># multiplicado por 10/3, </span></span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a><span class="co"># siendo una proporción para evitar la ruina</span></span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a><span class="co"># u (sum(medias))*(10/3)</span></span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>decimal_c <span class="ot">=</span> <span class="fl">0.29</span></span>
<span id="cb132-12"><a href="#cb132-12" aria-hidden="true" tabindex="-1"></a>c <span class="ot">=</span>decimal_c<span class="sc">*</span>u <span class="co">#prima de pago cada timepo t. c=0.5*u</span></span>
<span id="cb132-13"><a href="#cb132-13" aria-hidden="true" tabindex="-1"></a>lambda_Nt <span class="ot">=</span> <span class="fl">0.5</span></span>
<span id="cb132-14"><a href="#cb132-14" aria-hidden="true" tabindex="-1"></a><span class="co">#lambda_Xi = 3</span></span>
<span id="cb132-15"><a href="#cb132-15" aria-hidden="true" tabindex="-1"></a>t_final <span class="ot">=</span> <span class="dv">19</span></span>
<span id="cb132-16"><a href="#cb132-16" aria-hidden="true" tabindex="-1"></a><span class="co"># S(t) = \sum_{i=1}^{N(t)}X_i</span></span>
<span id="cb132-17"><a href="#cb132-17" aria-hidden="true" tabindex="-1"></a><span class="co"># donde N(t)~ Poisson (lambda*t)</span></span>
<span id="cb132-18"><a href="#cb132-18" aria-hidden="true" tabindex="-1"></a><span class="co"># X_i ~ exponencial (lambda_Xi)</span></span>
<span id="cb132-19"><a href="#cb132-19" aria-hidden="true" tabindex="-1"></a><span class="co"># CL = REPRESENTA EL MODELO DE CRAMER LUNDBERG</span></span>
<span id="cb132-20"><a href="#cb132-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Simulación de trayectoria de CL_t, cuando t &lt; t_final.</span></span>
<span id="cb132-21"><a href="#cb132-21" aria-hidden="true" tabindex="-1"></a>trayectoria_CLt_post_pandemia <span class="ot">&lt;-</span> <span class="cf">function</span>(u, c, lambda_Nt, t_final)</span>
<span id="cb132-22"><a href="#cb132-22" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb132-23"><a href="#cb132-23" aria-hidden="true" tabindex="-1"></a>  tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>)</span>
<span id="cb132-24"><a href="#cb132-24" aria-hidden="true" tabindex="-1"></a>  Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(u)</span>
<span id="cb132-25"><a href="#cb132-25" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span>(tiempo[<span class="fu">length</span>(tiempo)] <span class="sc">&lt;</span> t_final)</span>
<span id="cb132-26"><a href="#cb132-26" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb132-27"><a href="#cb132-27" aria-hidden="true" tabindex="-1"></a>    <span class="co">#tiempo_llegada &lt;- rexp(1, rate = lambda_Nt)</span></span>
<span id="cb132-28"><a href="#cb132-28" aria-hidden="true" tabindex="-1"></a>    tiempo_llegada <span class="ot">&lt;-</span> (<span class="dv">1</span>)</span>
<span id="cb132-29"><a href="#cb132-29" aria-hidden="true" tabindex="-1"></a>    Y_i <span class="ot">&lt;-</span>  (<span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">101919.050</span> , <span class="at">sd =</span> <span class="fl">10877.075</span>) <span class="sc">+</span> </span>
<span id="cb132-30"><a href="#cb132-30" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">39841.721</span> , <span class="at">sd=</span> <span class="fl">7873.446</span>)  <span class="sc">+</span>  </span>
<span id="cb132-31"><a href="#cb132-31" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">41751.747</span>, <span class="at">sd =</span> <span class="fl">5687.030</span>) <span class="sc">+</span> </span>
<span id="cb132-32"><a href="#cb132-32" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>   <span class="fl">43243.143</span>, <span class="at">sd =</span> <span class="fl">10517.841</span>)<span class="sc">+</span> </span>
<span id="cb132-33"><a href="#cb132-33" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">43010.307</span>  , <span class="at">sd =</span> <span class="fl">7741.889</span>) <span class="sc">+</span> </span>
<span id="cb132-34"><a href="#cb132-34" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="fl">61191.300</span>  , <span class="at">sd =</span> <span class="fl">7202.989</span>) <span class="sc">+</span> </span>
<span id="cb132-35"><a href="#cb132-35" aria-hidden="true" tabindex="-1"></a>              <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span>  <span class="fl">85684.058</span> , <span class="at">sd =</span> <span class="fl">8371.359</span>)) </span>
<span id="cb132-36"><a href="#cb132-36" aria-hidden="true" tabindex="-1"></a>    tiempo <span class="ot">&lt;-</span> <span class="fu">c</span>(tiempo, tiempo[<span class="fu">length</span>(tiempo)] </span>
<span id="cb132-37"><a href="#cb132-37" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> tiempo_llegada,tiempo[<span class="fu">length</span>(tiempo)] </span>
<span id="cb132-38"><a href="#cb132-38" aria-hidden="true" tabindex="-1"></a>                <span class="sc">+</span> tiempo_llegada ) </span>
<span id="cb132-39"><a href="#cb132-39" aria-hidden="true" tabindex="-1"></a>    Cramer_trayectoria <span class="ot">&lt;-</span> <span class="fu">c</span>(Cramer_trayectoria,</span>
<span id="cb132-40"><a href="#cb132-40" aria-hidden="true" tabindex="-1"></a>                      Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span> </span>
<span id="cb132-41"><a href="#cb132-41" aria-hidden="true" tabindex="-1"></a>                        c<span class="sc">*</span>tiempo_llegada, </span>
<span id="cb132-42"><a href="#cb132-42" aria-hidden="true" tabindex="-1"></a>                      Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)]<span class="sc">-</span> </span>
<span id="cb132-43"><a href="#cb132-43" aria-hidden="true" tabindex="-1"></a>                       c<span class="sc">*</span>tiempo_llegada <span class="sc">+</span>  Y_i )</span>
<span id="cb132-44"><a href="#cb132-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(Cramer_trayectoria[<span class="fu">length</span>(Cramer_trayectoria)] <span class="sc">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb132-45"><a href="#cb132-45" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb132-46"><a href="#cb132-46" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">1</span></span>
<span id="cb132-47"><a href="#cb132-47" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb132-48"><a href="#cb132-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span></span>
<span id="cb132-49"><a href="#cb132-49" aria-hidden="true" tabindex="-1"></a>    {</span>
<span id="cb132-50"><a href="#cb132-50" aria-hidden="true" tabindex="-1"></a>      ruina <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb132-51"><a href="#cb132-51" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb132-52"><a href="#cb132-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb132-53"><a href="#cb132-53" aria-hidden="true" tabindex="-1"></a>  df_post_pandemia<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(tiempo, Cramer_trayectoria)</span>
<span id="cb132-54"><a href="#cb132-54" aria-hidden="true" tabindex="-1"></a>  df_trayectoria_post_pandemia <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(df_post_pandemia<span class="sc">%&gt;%</span></span>
<span id="cb132-55"><a href="#cb132-55" aria-hidden="true" tabindex="-1"></a>                                  <span class="fu">rename</span>(<span class="at">Tiempo =</span> tiempo, </span>
<span id="cb132-56"><a href="#cb132-56" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">Ct =</span> Cramer_trayectoria))</span>
<span id="cb132-57"><a href="#cb132-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(df_trayectoria_post_pandemia<span class="sc">$</span>Ct[length</span>
<span id="cb132-58"><a href="#cb132-58" aria-hidden="true" tabindex="-1"></a>                                (df_trayectoria_post_pandemia<span class="sc">$</span>Ct)])</span>
<span id="cb132-59"><a href="#cb132-59" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb132-60"><a href="#cb132-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-61"><a href="#cb132-61" aria-hidden="true" tabindex="-1"></a><span class="co"># La función generador_mediana nos calcula la mediana de </span></span>
<span id="cb132-62"><a href="#cb132-62" aria-hidden="true" tabindex="-1"></a><span class="co"># las ganancias finales de 100 trayectorias, </span></span>
<span id="cb132-63"><a href="#cb132-63" aria-hidden="true" tabindex="-1"></a><span class="co"># fijando el u= surplus y el c</span></span>
<span id="cb132-64"><a href="#cb132-64" aria-hidden="true" tabindex="-1"></a>generador_mediana_post_pandemia<span class="ot">&lt;-</span> <span class="cf">function</span>(ui,cj)</span>
<span id="cb132-65"><a href="#cb132-65" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb132-66"><a href="#cb132-66" aria-hidden="true" tabindex="-1"></a>  ganancia_final_replicas_post_pandemia <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100</span>,</span>
<span id="cb132-67"><a href="#cb132-67" aria-hidden="true" tabindex="-1"></a>           <span class="fu">trayectoria_CLt_post_pandemia</span>(u, c,lambda_Nt, t_final))</span>
<span id="cb132-68"><a href="#cb132-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>( <span class="fu">median</span>(ganancia_final_replicas_post_pandemia))</span>
<span id="cb132-69"><a href="#cb132-69" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb132-70"><a href="#cb132-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Se crea la rejilla donde se hace el analisis de sensibilidad</span></span>
<span id="cb132-71"><a href="#cb132-71" aria-hidden="true" tabindex="-1"></a><span class="co"># para diferentes valores de u y c</span></span>
<span id="cb132-72"><a href="#cb132-72" aria-hidden="true" tabindex="-1"></a>grid_u_post_pandemia <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> (u<span class="dv">-100000</span><span class="sc">*</span><span class="dv">4</span>), </span>
<span id="cb132-73"><a href="#cb132-73" aria-hidden="true" tabindex="-1"></a>                            <span class="at">to =</span> (u<span class="sc">+</span><span class="dv">100000</span><span class="sc">*</span><span class="dv">4</span>), </span>
<span id="cb132-74"><a href="#cb132-74" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by =</span> <span class="dv">100000</span>)</span>
<span id="cb132-75"><a href="#cb132-75" aria-hidden="true" tabindex="-1"></a>grid_c_post_pandemia <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> (decimal_c<span class="fl">-0.01</span><span class="sc">*</span><span class="dv">4</span>), </span>
<span id="cb132-76"><a href="#cb132-76" aria-hidden="true" tabindex="-1"></a>                            <span class="at">to =</span> (decimal_c<span class="fl">+0.01</span><span class="sc">*</span><span class="dv">4</span>), </span>
<span id="cb132-77"><a href="#cb132-77" aria-hidden="true" tabindex="-1"></a>                            <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb132-78"><a href="#cb132-78" aria-hidden="true" tabindex="-1"></a>u_t <span class="ot">&lt;-</span> grid_u_post_pandemia</span>
<span id="cb132-79"><a href="#cb132-79" aria-hidden="true" tabindex="-1"></a>matriz_mediana_post_pandemia <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>, </span>
<span id="cb132-80"><a href="#cb132-80" aria-hidden="true" tabindex="-1"></a>      <span class="fu">length</span>(grid_u_post_pandemia)<span class="sc">*</span><span class="fu">length</span>(grid_c_post_pandemia)),</span>
<span id="cb132-81"><a href="#cb132-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">nrow=</span> <span class="fu">length</span>(grid_u_post_pandemia), </span>
<span id="cb132-82"><a href="#cb132-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">ncol=</span> <span class="fu">length</span>(grid_c_post_pandemia))</span>
<span id="cb132-83"><a href="#cb132-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-84"><a href="#cb132-84" aria-hidden="true" tabindex="-1"></a>G_t <span class="ot">&lt;-</span> matriz_mediana_post_pandemia</span>
<span id="cb132-85"><a href="#cb132-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-86"><a href="#cb132-86" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(u_t)) </span>
<span id="cb132-87"><a href="#cb132-87" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb132-88"><a href="#cb132-88" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(grid_c_post_pandemia)) </span>
<span id="cb132-89"><a href="#cb132-89" aria-hidden="true" tabindex="-1"></a>  {</span>
<span id="cb132-90"><a href="#cb132-90" aria-hidden="true" tabindex="-1"></a>    G_t[i,j] <span class="ot">&lt;-</span> <span class="fu">generador_mediana_post_pandemia</span>(u_t[i], </span>
<span id="cb132-91"><a href="#cb132-91" aria-hidden="true" tabindex="-1"></a>                                  grid_c_post_pandemia[j]<span class="sc">*</span>u_t[i])</span>
<span id="cb132-92"><a href="#cb132-92" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb132-93"><a href="#cb132-93" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb132-94"><a href="#cb132-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-95"><a href="#cb132-95" aria-hidden="true" tabindex="-1"></a><span class="co">#Grafica del ánalisis de sensibilidad</span></span>
<span id="cb132-96"><a href="#cb132-96" aria-hidden="true" tabindex="-1"></a><span class="co">#Grafica del ánalisis de sensibilidad</span></span>
<span id="cb132-97"><a href="#cb132-97" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb132-98"><a href="#cb132-98" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb132-99"><a href="#cb132-99" aria-hidden="true" tabindex="-1"></a>c_t <span class="ot">&lt;-</span> grid_u_post_pandemia<span class="sc">*</span>grid_c_post_pandemia</span>
<span id="cb132-100"><a href="#cb132-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-101"><a href="#cb132-101" aria-hidden="true" tabindex="-1"></a>z1<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="dv">0</span>,</span>
<span id="cb132-102"><a href="#cb132-102" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(grid_u_post_pandemia)<span class="sc">*</span><span class="fu">length</span>(grid_c_post_pandemia)), <span class="at">nrow=</span></span>
<span id="cb132-103"><a href="#cb132-103" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(grid_u_post_pandemia), <span class="at">ncol=</span> <span class="fu">length</span>(grid_c_post_pandemia))</span>
<span id="cb132-104"><a href="#cb132-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-105"><a href="#cb132-105" aria-hidden="true" tabindex="-1"></a>z2<span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(u,</span>
<span id="cb132-106"><a href="#cb132-106" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(grid_u_post_pandemia)<span class="sc">*</span><span class="fu">length</span>(grid_c_post_pandemia)), <span class="at">nrow=</span></span>
<span id="cb132-107"><a href="#cb132-107" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(grid_u_post_pandemia), <span class="at">ncol=</span> <span class="fu">length</span>(grid_c_post_pandemia))</span>
<span id="cb132-108"><a href="#cb132-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-109"><a href="#cb132-109" aria-hidden="true" tabindex="-1"></a>fig3 <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(</span>
<span id="cb132-110"><a href="#cb132-110" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'surface'</span>,</span>
<span id="cb132-111"><a href="#cb132-111" aria-hidden="true" tabindex="-1"></a>  <span class="at">contours =</span> <span class="fu">list</span>(</span>
<span id="cb132-112"><a href="#cb132-112" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">list</span>(<span class="at">show =</span> <span class="cn">TRUE</span>, <span class="at">start =</span> u_t[<span class="dv">1</span>], <span class="at">end =</span></span>
<span id="cb132-113"><a href="#cb132-113" aria-hidden="true" tabindex="-1"></a>u_t[<span class="fu">length</span>(u_t)], <span class="at">size =</span><span class="dv">100000</span> ,</span>
<span id="cb132-114"><a href="#cb132-114" aria-hidden="true" tabindex="-1"></a><span class="at">color =</span> <span class="st">'black'</span>),</span>
<span id="cb132-115"><a href="#cb132-115" aria-hidden="true" tabindex="-1"></a>    <span class="at">z =</span> <span class="fu">list</span>(<span class="at">show =</span> <span class="cn">TRUE</span>, <span class="at">start =</span> G_t[<span class="dv">1</span>], </span>
<span id="cb132-116"><a href="#cb132-116" aria-hidden="true" tabindex="-1"></a>             <span class="at">end =</span> G_t[<span class="fu">length</span>(G_t)], <span class="at">size =</span><span class="fl">0.01</span><span class="sc">*</span><span class="dv">100000</span> , </span>
<span id="cb132-117"><a href="#cb132-117" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">'white'</span>)),</span>
<span id="cb132-118"><a href="#cb132-118" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>u_t,</span>
<span id="cb132-119"><a href="#cb132-119" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>c_t,</span>
<span id="cb132-120"><a href="#cb132-120" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="sc">~</span>G_t)</span>
<span id="cb132-121"><a href="#cb132-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-122"><a href="#cb132-122" aria-hidden="true" tabindex="-1"></a>fig3 <span class="ot">&lt;-</span> fig3<span class="sc">%&gt;%</span> <span class="fu">add_surface</span>(</span>
<span id="cb132-123"><a href="#cb132-123" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">'surface'</span>,</span>
<span id="cb132-124"><a href="#cb132-124" aria-hidden="true" tabindex="-1"></a>  <span class="at">contours =</span> <span class="fu">list</span>(</span>
<span id="cb132-125"><a href="#cb132-125" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">list</span>(<span class="at">show =</span> <span class="cn">TRUE</span>, <span class="at">start =</span> u_t[<span class="dv">1</span>], </span>
<span id="cb132-126"><a href="#cb132-126" aria-hidden="true" tabindex="-1"></a>             <span class="at">end =</span> u_t[<span class="fu">length</span>(u_t)], <span class="at">size =</span><span class="dv">100000</span> ,</span>
<span id="cb132-127"><a href="#cb132-127" aria-hidden="true" tabindex="-1"></a>             <span class="at">color =</span> <span class="st">'black'</span>),</span>
<span id="cb132-128"><a href="#cb132-128" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">list</span>(<span class="at">show =</span> <span class="cn">TRUE</span>, <span class="at">start =</span> c_t[<span class="dv">1</span>], </span>
<span id="cb132-129"><a href="#cb132-129" aria-hidden="true" tabindex="-1"></a>             <span class="at">end =</span> c_t[<span class="fu">length</span>(c_t)], </span>
<span id="cb132-130"><a href="#cb132-130" aria-hidden="true" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">0.01</span><span class="sc">*</span><span class="dv">100000</span> , <span class="at">color =</span> <span class="st">'red'</span>)),</span>
<span id="cb132-131"><a href="#cb132-131" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> <span class="sc">~</span>u_t,</span>
<span id="cb132-132"><a href="#cb132-132" aria-hidden="true" tabindex="-1"></a>  <span class="at">y =</span> <span class="sc">~</span>c_t,</span>
<span id="cb132-133"><a href="#cb132-133" aria-hidden="true" tabindex="-1"></a>  <span class="at">z =</span> <span class="sc">~</span>z1)</span>
<span id="cb132-134"><a href="#cb132-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-135"><a href="#cb132-135" aria-hidden="true" tabindex="-1"></a>fig3 <span class="ot">&lt;-</span> fig3 <span class="sc">%&gt;%</span> <span class="fu">layout</span>(</span>
<span id="cb132-136"><a href="#cb132-136" aria-hidden="true" tabindex="-1"></a>  <span class="at">scene =</span> <span class="fu">list</span>(</span>
<span id="cb132-137"><a href="#cb132-137" aria-hidden="true" tabindex="-1"></a>    <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">nticks =</span> <span class="dv">20</span>),</span>
<span id="cb132-138"><a href="#cb132-138" aria-hidden="true" tabindex="-1"></a>    <span class="at">zaxis =</span> <span class="fu">list</span>(<span class="at">nticks =</span> <span class="dv">4</span>),</span>
<span id="cb132-139"><a href="#cb132-139" aria-hidden="true" tabindex="-1"></a>    <span class="at">camera =</span> <span class="fu">list</span>(<span class="at">eye =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">z =</span> <span class="dv">1</span>)),</span>
<span id="cb132-140"><a href="#cb132-140" aria-hidden="true" tabindex="-1"></a>    <span class="at">aspectratio =</span> <span class="fu">list</span>(<span class="at">x =</span> .<span class="dv">9</span>, <span class="at">y =</span> .<span class="dv">8</span>, <span class="at">z =</span> <span class="fl">0.2</span>)))</span>
<span id="cb132-141"><a href="#cb132-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-142"><a href="#cb132-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-143"><a href="#cb132-143" aria-hidden="true" tabindex="-1"></a>fig3</span></code><button title="Copiar al portapapeles" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-b7c9389d0f1be9dbaeac" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b7c9389d0f1be9dbaeac">{"x":{"visdat":{"503075b970b4":["function () ","plotlyVisDat"]},"cur_data":"503075b970b4","attrs":{"503075b970b4":{"contours":{"x":{"show":true,"start":1359629,"end":2159629,"size":100000,"color":"black"},"z":{"show":true,"start":-14085.706734803563,"end":-8586.7946384849783,"size":1000,"color":"white"}},"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface"},"503075b970b4.1":{"contours":{"x":{"show":true,"start":1359629,"end":2159629,"size":100000,"color":"black"},"z":{"show":true,"start":-14085.706734803563,"end":-8586.7946384849783,"size":1000,"color":"white"},"y":{"show":true,"start":339907.24999999994,"end":712677.56999999995,"size":1000,"color":"red"}},"x":{},"y":{},"z":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"surface","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"nticks":20,"title":"u_t"},"zaxis":{"nticks":4,"title":"G_t"},"camera":{"eye":{"x":0,"y":-1,"z":1}},"aspectratio":{"x":0.90000000000000002,"y":0.80000000000000004,"z":0.20000000000000001},"yaxis":{"title":"c_t"}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.33333333333333337}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"G_t<br />z1","ticklen":2,"len":0.33333333333333331,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666666","rgba(70,19,97,1)"],["0.0833333333333334","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"contours":{"x":{"show":true,"start":1359629,"end":2159629,"size":100000,"color":"black"},"z":{"show":true,"start":-14085.706734803563,"end":-8586.7946384849783,"size":1000,"color":"white"}},"x":[1359629,1459629,1559629,1659629,1759629,1859629,1959629,2059629,2159629],"y":[339907.24999999994,379503.53999999992,421099.82999999996,464696.11999999994,510292.40999999997,557888.69999999995,607484.98999999987,659081.27999999991,712677.56999999995],"z":[[-14085.706734803563,-21363.170060570352,-28166.924862055515,-22360.099980225117,-6567.8339382220292,-16790.83268662318,-20467.850298111618,-20169.405705167039,-15567.516016700509],[-16794.054955111147,-12927.61991113695,-11022.686265267927,-21630.782606293564,-19774.72383171742,-9203.5224330205529,-22834.209017251676,-12264.038975268399,-20948.964170040941],[-28645.754381375271,-6460.2408459304716,-7772.603019028058,-15600.252677594457,-16669.543607491651,-17726.344761767832,-32212.46872622185,-22369.307405302097,-12119.089309943636],[-9964.3809757729468,-10882.38596507904,6.6255738277395722,-26615.156348656252,-12957.040910510463,-2730.8161194240092,-38775.765139253519,-28566.878381892253,-3827.4875328982598],[-12990.258710764436,-13345.570726953767,-21127.940410823445,-12219.605886777514,-13292.566423018143,4464.4266941866663,-25270.804885340389,-26196.117017969664,-23633.478118785599],[-12131.49261875861,9485.2439860840386,-10443.079495107115,-24586.179012693086,-9877.1427353875479,-22527.185900754732,4753.2782959080942,-23951.259409509832,-37964.049105072976],[-21941.88279425315,-15662.146366039087,-22960.743528637133,-4364.9071056363464,-15833.075901166565,-10862.446314272267,-25575.35250693094,-9658.6137467292137,-6446.480286680744],[-6026.8334215776122,-18850.015943733131,-19474.057297851541,-32334.484761881147,-14376.443173081061,-22242.691126939695,-8592.9012616957189,-401.04256676550722,-35250.104598933016],[-21029.954229612864,-27274.935608395637,-22800.317185924709,-25388.495187411347,-9768.0650722800347,-20940.314843671978,-28739.025082769658,-48238.476376989478,-8586.7946384849783]],"type":"surface","frame":null},{"colorbar":{"title":"G_t<br />z1","ticklen":2,"len":0.33333333333333331,"lenmode":"fraction","y":0.66666666666666674,"yanchor":"top"},"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666666","rgba(70,19,97,1)"],["0.0833333333333334","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"contours":{"x":{"show":true,"start":1359629,"end":2159629,"size":100000,"color":"black"},"z":{"show":true,"start":-14085.706734803563,"end":-8586.7946384849783,"size":1000,"color":"white"},"y":{"show":true,"start":339907.24999999994,"end":712677.56999999995,"size":1000,"color":"red"}},"x":[1359629,1459629,1559629,1659629,1759629,1859629,1959629,2059629,2159629],"y":[339907.24999999994,379503.53999999992,421099.82999999996,464696.11999999994,510292.40999999997,557888.69999999995,607484.98999999987,659081.27999999991,712677.56999999995],"z":[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]],"type":"surface","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
</section>
<section id="análisis-de-resultados-y-recomendaciones." class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="análisis-de-resultados-y-recomendaciones."><span class="header-section-number">6.5</span> Análisis de resultados y recomendaciones.</h2>
<div style="text-align:justify">
<p>Con los datos registrados de <span class="math inline">\(90\)</span> semanas antes de pandemia en el modelo modificado (<a href="#eq-4.1" class="quarto-xref">Ecuación&nbsp;<span>6.1</span></a>) se obtiene un crecimiento positivo de las ganancias simuladas, en particular mayor que el capital inicial, es decir la probabilidad del evento donde <span class="math inline">\(G(t)\geq u\)</span> es positiva, con <span class="math inline">\(t=90\)</span>, como se puede observar en la imagen (<a href="#fig-trayectoria" class="quarto-xref">Figura&nbsp;<span>6.5</span></a>), por lo que en el intervalo de tiempo en el que se estudia la empresa generaría siempre ganancias positivas y se lograría suplir la deuda e incluso pensar en implementar más equipos inmobiliarios.</p>
<p>Mientras que después de la pandemia, se puede argumentar con base en las observaciones de las <span class="math inline">\(14\)</span> semanas de las ventas registradas, usando los mismos parámetros obtenidos para los datos antes de la pandemia implementados, las ganancias son bajas como se muestra en la imagen (<a href="#fig-trayectoria2" class="quarto-xref">Figura&nbsp;<span>6.6</span></a>). Aquí se observa que la simulación de las ganancias son menores que el capital inicial y al dar seguimiento en el intervalo de tiempo con los datos registrados después de pandemiahasta la semana <span class="math inline">\(17\)</span> se observa que las ganancias son menores que cero, por lo que se puede concluir que se llega a una ruina total, como se muestra el caso en la imagen (<a href="#fig-trayectoria3" class="quarto-xref">Figura&nbsp;<span>6.7</span></a>).</p>
<p>Analizando el caso en el que se modificara los parámetros de los costos del modelo (<a href="#eq-4.1" class="quarto-xref">Ecuación&nbsp;<span>6.1</span></a>), se concluye que al calibrar el parámetro <span class="math inline">\(c\)</span>, este se puede reducir a un <span class="math inline">\(17 \%\)</span> para cuando <span class="math inline">\(t=14\)</span>, es decir, al final de la semana <span class="math inline">\(14\)</span> puede evitarse la perdida total de las ganancias que son mayores que el capital inicial, como se observa en la figura (<a href="#fig-trayectoria4" class="quarto-xref">Figura&nbsp;<span>6.8</span></a>).</p>
<p>Como <span class="math inline">\(c\)</span>, es el parámetro de los pagos que incluye el pago por la adquisición de la franquicia, compras de equipos inmobiliarios, pagos de empleados y prestamos, el anterior análisis quiere decir que se necesita un recorte de personal del <span class="math inline">\(17 \%\)</span> como mínimo y una reestructuración financiera del capital pendiente por pagar, haciendo los pagos más pequeños a un tiempo extendido, con el fin de la funcionalidad del negocio durante este proceso pandemico y evitar el cierre de quiebra.</p>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = true;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copiado");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copiado");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Modelo_de_Cramer_Lundberg.html" class="pagination-link" aria-label="Modelo Clásico de Cramér-Lundberg">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Modelo Clásico de Cramér-Lundberg</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./references.html" class="pagination-link" aria-label="Referencias">
        <span class="nav-page-text">Referencias</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/Mara-DL/Tesis.git/edit/main/Estudio_caso.qmd" class="toc-action"><i class="bi bi-github"></i>Editar esta página</a></li><li><a href="https://github.com/Mara-DL/Tesis.git/issues/new" class="toc-action"><i class="bi empty"></i>Informar de un problema</a></li><li><a href="https://github.com/Mara-DL/Tesis.git/blob/main/Estudio_caso.qmd" class="toc-action"><i class="bi empty"></i>Ver el código</a></li></ul></div></div></div></footer></body></html>